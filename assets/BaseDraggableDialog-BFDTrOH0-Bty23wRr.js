
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{e as u,ad as A,J as F,E as R,af as U,z as Z,o as S,c as $,A as G,f as a,Z as d,u as Q,r as L,g as ee,O,n as te,bq as ne,aa as oe}from"./index-CJB5jCfL.js";import{s as ae,J as re,d as ie,O as se}from"./vue-data-ui-8Gmf-dDN.js";import"./alert-I_0TAljB.js";const de=["xmlns"],le={class:"draggable-dialog-actions"},ue={__name:"BaseDraggableDialog",props:{backgroundColor:{type:String},color:{type:String},headerBg:{type:String},headerColor:{type:String},fullscreenParent:{type:HTMLElement},isFullscreen:{type:Boolean,default:!1},withPadding:{type:Boolean,default:!1},forcedWidth:{type:Number,default:400}},emits:["close"],setup(i,{expose:P,emit:_}){const y=i,N=_,w=u(!1),z=u(!1),k=u(0),f=u(null),M=u(null),h=u(null),C="vue-ui-draggable-dialog-".concat(re()),B="".concat(C,"-title"),D="".concat(C,"-body");function E(){k.value+=1}const e=A({left:window.innerWidth/2-200,top:window.innerHeight/2-120,width:y.forcedWidth,height:400,dragging:!1,resizing:!1,dragOffsetX:0,dragOffsetY:0,pointerStartX:0,pointerStartY:0,resizeStartW:0,resizeStartH:0});function J(){h.value=document.activeElement instanceof HTMLElement?document.activeElement:null,w.value=!0,oe(()=>{z.value||(e.left=Math.max(0,window.innerWidth/2-e.width/2),e.top=Math.max(0,window.innerHeight/2-e.height/2),z.value=!0);const t=M.value||f.value;t&&typeof t.focus=="function"&&t.focus()})}function x(){w.value=!1,N("close"),h.value&&typeof h.value.focus=="function"&&h.value.focus()}P({open:J,close:x});const V=F(()=>({position:"fixed",left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px"),padding:0,border:"none",background:y.backgroundColor,boxShadow:"0 4px 24px rgba(0,0,0,0.15)",zIndex:9999,overflow:"visible",borderRadius:"2px","--dlg-color":y.color}));function l(t){return t.touches&&t.touches.length?{x:t.touches[0].clientX,y:t.touches[0].clientY}:{x:t.clientX,y:t.clientY}}function W(t){var o;(o=t.preventDefault)==null||o.call(t),E(),e.dragging=!0;const n=l(t);e.dragOffsetX=n.x-e.left,e.dragOffsetY=n.y-e.top,document.addEventListener("mousemove",p),document.addEventListener("mouseup",c),document.addEventListener("touchmove",p,{passive:!1}),document.addEventListener("touchend",c)}function p(t){var s;if(!e.dragging)return;(s=t.preventDefault)==null||s.call(t);const n=l(t);let o=n.x-e.dragOffsetX,r=n.y-e.dragOffsetY;o=Math.max(0,Math.min(o,window.innerWidth-e.width)),r=Math.max(0,Math.min(r,window.innerHeight-e.height)),e.left=o,e.top=r}function c(){e.dragging=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",c),document.removeEventListener("touchmove",p),document.removeEventListener("touchend",c)}function H(t){var o;(o=t.preventDefault)==null||o.call(t),E(),e.resizing=!0;const n=l(t);e.pointerStartX=n.x,e.pointerStartY=n.y,e.resizeStartW=e.width,e.resizeStartH=e.height,document.addEventListener("mousemove",g),document.addEventListener("mouseup",m),document.addEventListener("touchmove",g,{passive:!1}),document.addEventListener("touchend",m)}function g(t){var s;if(!e.resizing)return;(s=t.preventDefault)==null||s.call(t);const n=l(t);let o=n.x-e.pointerStartX,r=n.y-e.pointerStartY;e.width=Math.max(240,e.resizeStartW+o),e.height=Math.max(400,e.resizeStartH+r)}function m(){e.resizing=!1,document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",m),document.removeEventListener("touchmove",g),document.removeEventListener("touchend",m)}function X(t){var o;(o=t.preventDefault)==null||o.call(t),E(),e.resizing=!0;const n=l(t);e.pointerStartX=n.x,e.pointerStartY=n.y,e.resizeStartW=e.width,e.resizeStartH=e.height,e.resizeStartLeft=e.left,e.resizeStartTop=e.top,document.addEventListener("mousemove",b),document.addEventListener("mouseup",v),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("touchend",v)}function b(t){var Y;if(!e.resizing)return;(Y=t.preventDefault)==null||Y.call(t);const n=l(t);let o=n.x-e.pointerStartX,r=Math.min(Math.max(0,e.resizeStartLeft+o),e.resizeStartLeft+e.resizeStartW-240),s=e.resizeStartW-(r-e.resizeStartLeft),K=n.y-e.pointerStartY,q=Math.max(400,e.resizeStartH+K);e.left=r,e.width=s,e.height=q}function v(){e.resizing=!1,document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",v)}R(()=>{document.addEventListener("keydown",T)});function T(t){t.key&&t.key==="Escape"&&x()}U(()=>{c(),m(),v(),document.removeEventListener("keydown",T)});function j(t){t.key==="Tab"&&I(t)}function I(t){if(!f.value)return;const n=f.value.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex]:not([tabindex="-1"]), [contenteditable="true"]');if(!n.length)return;const o=n[0],r=n[n.length-1];t.shiftKey?document.activeElement===o&&(t.preventDefault(),r.focus()):document.activeElement===r&&(t.preventDefault(),o.focus())}return(t,n)=>(S(),Z(ne,{to:i.isFullscreen?i.fullscreenParent:"body",key:k.value},[w.value?(S(),$("div",{key:0,ref_key:"draggableDialog",ref:f,class:"vue-ui-draggable-dialog",style:O(V.value),role:"dialog","aria-modal":!0,"aria-labelledby":B,"aria-describedby":D,tabindex:"-1",onClick:n[0]||(n[0]=d(()=>{},["stop"])),onKeydown:j},[a("div",{class:"vue-ui-draggable-dialog-header",style:O({backgroundColor:i.headerBg,color:i.headerColor})},[a("span",{class:"drag-handle","aria-hidden":"true",onMousedown:d(W,["stop","prevent"]),onTouchstart:d(W,["stop","prevent"])},[(S(),$("svg",{xmlns:Q(ie),width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1","stroke-linecap":"round","stroke-linejoin":"round"},[...n[1]||(n[1]=[a("path",{d:"M5 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M5 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M12 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M12 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M19 9m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1),a("path",{d:"M19 15m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0"},null,-1)])],8,de))],32),a("span",{class:"vue-ui-draggable-dialog-title",id:B},[L(t.$slots,"title",{},void 0,!0)]),a("div",le,[L(t.$slots,"actions",{},void 0,!0),a("button",{ref_key:"closeButtonElement",ref:M,class:"close",type:"button","aria-label":"Close dialog",onClick:x},[ee(se,{name:"close",stroke:i.headerColor},null,8,["stroke"])],512)])],4),a("div",{id:D,role:"document",class:te({"vue-ui-draggable-dialog-body":!i.withPadding,"vue-ui-draggable-dialog-body-pad":i.withPadding})},[L(t.$slots,"content",{},void 0,!0)],2),a("div",{class:"resize-handle","aria-hidden":"true",onMousedown:d(H,["stop","prevent"]),onTouchstart:d(H,["stop","prevent"])},null,32),a("div",{class:"resize-handle resize-handle-left","aria-hidden":"true",onMousedown:d(X,["stop","prevent"]),onTouchstart:d(X,["stop","prevent"])},null,32)],36)):G("",!0)],8,["to"]))}},fe=ae(ue,[["__scopeId","data-v-38c3387c"]]);export{fe as default};
