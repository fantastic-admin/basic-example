
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const S={mercator([e,h],M,s,c){h=Math.max(Math.min(h,85.05113),-85.05113);const[a,P]=c,o=(e-a)*Math.PI/180,t=M/(2*Math.PI)*(o+Math.PI),i=l=>Math.log(Math.tan(Math.PI/4+l*Math.PI/180/2)),n=i(85.05113),r=i(-72),m=(i(h)-n)/(r-n)*s;return[t,m]},equirectangular([e,h],M,s,c){const[a,P]=c;h=Math.max(Math.min(h,90),-80);const o=(e-a+180)/360*M,t=(90-(h-P))/170*s;return[o,t]},robinson([e,h],M,s,c){const a=[[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]],[P,o]=c;e=e-P,h=Math.max(-89.9999,Math.min(89.9999,h));const t=Math.abs(h),i=Math.floor(t/5),n=t%5/5,[r,m]=a[i],[l,u]=a[Math.min(i+1,a.length-1)],I=r+(l-r)*n,f=m+(u-m)*n,y=e*Math.PI/180,g=M/2+M/2*I*y/Math.PI,p=s/2-Math.sign(h)*(s/2)*f/1;return!Number.isFinite(g)||!Number.isFinite(p)?[-9999,-9999]:[g,p]},mollweide([e,h],M,s,c){h=Math.max(Math.min(h,89.9999),-89.9999);const[a]=c,P=(e-a)*Math.PI/180,o=h*Math.PI/180;let t=o;const i=1e-10;let n=1,r=0;for(;Math.abs(n)>i&&r<10;)n=-(2*t+Math.sin(2*t)-Math.PI*Math.sin(o))/(2+2*Math.cos(2*t)),t+=n,r++;isFinite(t)||(t=o>0?Math.PI/2:-Math.PI/2);const m=M/(2*Math.SQRT2),l=(m*(2*Math.SQRT2/Math.PI)*P*Math.cos(t)+2*m)/(4.6*m)*M,u=-m*Math.SQRT2*Math.sin(t),I=-m*Math.SQRT2,f=m*Math.SQRT2,y=(u-I)/(f-I)*s;return[isFinite(l)?l:0,isFinite(y)?y:0]},winkelTripel([e,h],M,s,c){const[a,P]=c,o=(e-a)*Math.PI/180,t=h*Math.PI/180,i=o*Math.cos(Math.PI/6),n=t,r=Math.acos(Math.cos(t)*Math.cos(o/2)),m=2*Math.cos(t)*Math.sin(o/2)/(Math.sin(r)/r||1),l=Math.sin(t)/(Math.sin(r)/r||1),u=M/2+M/(2*Math.PI)*(i+m)/2,I=s/2-s/(2*Math.PI)*(n+l)/2;return[u,I]},aitoff([e,h],M,s,c){Math.sinc||(Math.sinc=function(m){return m===0?1:Math.sin(Math.PI*m)/(Math.PI*m)});const[a,P]=c,o=(e-a)*Math.PI/180,t=h*Math.PI/180,i=Math.acos(Math.cos(t)*Math.cos(o/2));let n=0,r=0;return i!==0&&(n=2*Math.cos(t)*Math.sin(o/2)/Math.sinc(i/Math.PI),r=Math.sin(t)/Math.sinc(i/Math.PI)),n=M/2+n*(M/4),r=s/2-r*(s/2),[n,r]},hammer([e,h],M,s,c){const[a,P]=c,o=(e-a)*Math.PI/180,t=h*Math.PI/180,i=Math.sqrt(1+Math.cos(t)*Math.cos(o/2)),n=M/2+M/2*(2*Math.SQRT2*Math.cos(t)*Math.sin(o/2)/i)/2.8284271247461903,r=s/2-s/2*(Math.SQRT2*Math.sin(t)/i)/1.4142135623730951;return[n,r]},bonne([e,h],M,s,c=[0,0]){const a=45*Math.PI/180,[P,o]=c,t=(e-P)*Math.PI/180,i=Math.max(Math.min(h,89.9),-89.9)*Math.PI/180,n=1/Math.tan(a),r=n+a-i,m=r===0?0:t*Math.cos(i)/r,l=Math.min(M,s)/2.6,u=M/2+l*r*Math.sin(m),I=s/2-l*(n-r*Math.cos(m));return[u,I]},sinusoidal([e,h],M,s,c){const[a,P]=c,o=(e-a)*Math.PI/180,t=h*Math.PI/180,i=M/2+M/(2*Math.PI)*o*Math.cos(t),n=s/2-s/Math.PI*t;return[i,n]},gallPeters([e,h],M,s,c){const[a,P]=c;h=Math.max(Math.min(h,89.9999),-89.9999);const o=(e-a+180)/360*M,t=s/2-s/Math.PI*Math.sin(h*Math.PI/180);return[o,t]},vanDerGrinten([e,h],M,s,c=[0,0]){const a=Math.PI,P=Math.PI/2,o=1e-6;let t=(e-(c[0]||0))*a/180,i=(h-(c[1]||0))*a/180,n=Math.abs(t),r=Math.abs(i),m,l;if(r<o)m=t,l=0;else if(n<o||Math.abs(r-P)<o)m=0,l=Math.sign(i)*a*Math.tan(Math.asin(r/P)/2);else{let y=r/P,g=Math.asin(y),p=Math.cos(g),x=.5*Math.abs(a/t-t/a),b=x*x,d=p/(y+p-1),F=d*(2/y-1),N=F*F,T=N+b,Q=d-N,R=b+d;m=Math.sign(t)*a*(x*Q+Math.sqrt(Math.max(0,b*Q*Q-T*(d*d-N))))/T,l=Math.sign(i)*a*(F*R-x*Math.sqrt(Math.max(0,(b+1)*T-R*R)))/T}const u=M/2/a*.98,I=M/2,f=s/2;return[I+m*u,f-l*u]},globe([e,h],M,s,c){const[a,P]=c,o=(e-a)*Math.PI/180,t=h*Math.PI/180,i=P*Math.PI/180,n=Math.min(M,s)/2*.95,r=M/2,m=s/2,l=n*Math.cos(t)*Math.sin(o)+r,u=-n*(Math.cos(i)*Math.sin(t)-Math.sin(i)*Math.cos(t)*Math.cos(o))+m;return Math.sin(i)*Math.sin(t)+Math.cos(i)*Math.cos(t)*Math.cos(o)<0?[NaN,NaN]:[l,u]},azimuthalEquidistant([e,h],M,s,c=[0,0]){const a=p=>p*Math.PI/180,[P,o]=c,t=a(e-P),i=a(h),n=a(o),r=Math.sin(n)*Math.sin(i)+Math.cos(n)*Math.cos(i)*Math.cos(t),m=Math.acos(Math.max(-1,Math.min(1,r)));let l=m===0?1:m/Math.sin(m);const u=l*Math.cos(i)*Math.sin(t),I=l*(Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(t)),f=Math.min(M,s)/2/Math.PI,y=M/2,g=s/2;return[y+u*f,g-I*f]}};function w(e,h,M,s,c=[0,0]){let a=1/0,P=1/0,o=-1/0,t=-1/0;for(const i of h){const n=i.geometry,r=n.type==="Polygon"?[n.coordinates]:n.type==="MultiPolygon"?n.coordinates:[];for(const m of r)for(const l of m)for(const[u,I]of l){const[f,y]=e([u,I],M,s,c);!Number.isFinite(f)||!Number.isFinite(y)||(a=Math.min(a,f),o=Math.max(o,f),P=Math.min(P,y),t=Math.max(t,y))}}return{minX:Math.floor(a)-10,minY:Math.floor(P)-10,width:Math.ceil(o-a)+20,height:Math.ceil(t-P)+20}}function q(e,h,M){const s=e.find(a=>a.properties.admin===h||a.properties.name===h),c=e.find(a=>a.properties.admin===M||a.properties.name===M);return s&&c&&(s.geometry.type==="Polygon"&&(s.geometry={type:"MultiPolygon",coordinates:[s.geometry.coordinates]}),c.geometry.type==="Polygon"?s.geometry.coordinates.push(c.geometry.coordinates):c.geometry.type==="MultiPolygon"&&s.geometry.coordinates.push(...c.geometry.coordinates),e=e.filter(a=>!(a.properties.admin===M||a.properties.name===M))),e}function A(e,h){let M=Array.isArray(h)?h.map(s=>({...s})):h.features?h.features.map(s=>({...s})):[];return e.style.chart.territory.showTaiwanAsPartOfChina&&(M=q(M,"China","Taiwan")),h.type==="FeatureCollection"?{...h,features:M}:M}const C={projections:S,getProjectedBounds:w,setupTerritories:A};export{C as S};
