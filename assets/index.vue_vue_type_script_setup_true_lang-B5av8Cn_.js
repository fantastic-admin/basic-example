
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{_ as R}from"./index.vue_vue_type_script_setup_true_lang-CVzIja2y.js";import{d as V,b as A,e as v,an as D,c as _,o as u,f as a,u as e,g as s,h as t,m as x,T as b,p as B,l as I,F as C,R as U,n as S,t as g,A as F,z as j,x as q,y as G,al as L,a as z,G as M,i as H}from"./index-CJB5jCfL.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-DMl0j_o7.js";import{e as K}from"./eventBus-CGRXT3Tn.js";import{_ as O}from"./index-nxIJQMZp.js";import{a as Q,t as W,o as X,s as y,F as w,_ as k,c as $,d as P}from"./FormMessage.vue_vue_type_script_setup_true_lang-Cw6SYoqu.js";const Y={class:"w-full flex-col-stretch-center"},Z=V({name:"EditPasswordForm",__name:"EditPasswordForm",setup(i){const d=A(),m=v(!1),c=Q({validationSchema:W(X({password:y().min(1,"请输入原密码"),newPassword:y().min(1,"请输入新密码").min(6,"密码长度为6到18位").max(18,"密码长度为6到18位"),checkPassword:y().min(1,"请确认新密码")}).refine(o=>o.newPassword===o.checkPassword,{message:"两次输入的密码不一致",path:["checkPassword"]})),initialValues:{password:"",newPassword:"",checkPassword:""}}).handleSubmit(o=>{m.value=!0,d.editPassword(o).then(async()=>{D.success("模拟修改成功，请重新登录"),d.logout()}).finally(()=>{m.value=!1})});return(o,l)=>{const n=O,h=B;return u(),_("div",Y,[l[2]||(l[2]=a("div",{class:"mb-6 space-y-2"},[a("h3",{class:"text-4xl color-[var(--el-text-color-primary)] font-bold"}," 修改密码 "),a("p",{class:"text-sm text-muted-foreground lg:text-base"}," 请输入原密码、新密码和确认密码 ")],-1)),a("form",{onSubmit:l[0]||(l[0]=(...r)=>e(c)&&e(c)(...r))},[s(e(w),{name:"password"},{default:t(({componentField:r,errors:p})=>[s(e(k),{class:"relative pb-6 space-y-0"},{default:t(()=>[s(e($),null,{default:t(()=>[s(n,x({type:"password",placeholder:"请输入原密码",class:["w-full",p.length&&"border-destructive"]},r),null,16,["class"])]),_:2},1024),s(b,{"enter-active-class":"transition-opacity","enter-from-class":"opacity-0","leave-active-class":"transition-opacity","leave-to-class":"opacity-0"},{default:t(()=>[s(e(P),{class:"absolute bottom-1 text-xs"})]),_:1})]),_:2},1024)]),_:1}),s(e(w),{name:"newPassword"},{default:t(({componentField:r,errors:p})=>[s(e(k),{class:"relative pb-6 space-y-0"},{default:t(()=>[s(e($),null,{default:t(()=>[s(n,x({type:"password",placeholder:"请输入新密码",class:["w-full",p.length&&"border-destructive"]},r),null,16,["class"])]),_:2},1024),s(b,{"enter-active-class":"transition-opacity","enter-from-class":"opacity-0","leave-active-class":"transition-opacity","leave-to-class":"opacity-0"},{default:t(()=>[s(e(P),{class:"absolute bottom-1 text-xs"})]),_:1})]),_:2},1024)]),_:1}),s(e(w),{name:"checkPassword"},{default:t(({componentField:r,errors:p})=>[s(e(k),{class:"relative pb-6 space-y-0"},{default:t(()=>[s(e($),null,{default:t(()=>[s(n,x({type:"password",placeholder:"请确认新密码",class:["w-full",p.length&&"border-destructive"]},r),null,16,["class"])]),_:2},1024),s(b,{"enter-active-class":"transition-opacity","enter-from-class":"opacity-0","leave-active-class":"transition-opacity","leave-to-class":"opacity-0"},{default:t(()=>[s(e(P),{class:"absolute bottom-1 text-xs"})]),_:1})]),_:2},1024)]),_:1}),s(h,{loading:e(m),size:"lg",class:"mt-8 w-full",type:"submit"},{default:t(()=>[...l[1]||(l[1]=[I(" 保存 ",-1)])]),_:1},8,["loading"])],32)])}}}),ee={class:"min-h-full w-full"},se={class:"fixed right-0 top-0 z-1 flex flex-row overflow-auto border-b border-e bg-background md:inset-s-0 md:bottom-0 md:h-full md:w-40 md:flex-col"},te=["onClick"],ae={class:"text-base text-accent-foreground leading-tight"},oe={class:"text-xs text-accent-foreground/50"},le={class:"min-h-full flex-col-center p-10 pt-20 md:ms-40 md:pt-10"},ne={key:0},ce=V({__name:"profile",setup(i){const d=v(0),m=v([{title:"基本设置",description:"账号的基本信息，头像、昵称等"},{title:"安全设置",description:"定期修改密码可以提高帐号安全性"}]);return(f,c)=>(u(),_("div",ee,[a("div",se,[(u(!0),_(C,null,U(e(m),(o,l)=>(u(),_("div",{key:l,class:S(["flex-shrink-0 cursor-pointer px-4 py-3 transition-background-color space-y-2 hover-bg-accent/50",{"bg-accent hover-bg-accent!":e(d)===l}]),onClick:n=>d.value=l},[a("div",ae,g(o.title),1),a("div",oe,g(o.description),1)],10,te))),128))]),a("div",le,[e(d)===0?(u(),_("div",ne," 请开发者自行扩展 ")):F("",!0),e(d)===1?(u(),j(Z,{key:1})):F("",!0)])]))}}),re={class:"space-y-2"},ie={class:"flex-center-start gap-2"},de={class:"space-y-1"},ue={class:"text-base lh-none"},me={key:0,class:"min-w-0 flex-center-between flex-1 gap-2"},fe={class:"flex-1 truncate text-start"},be=V({__name:"index",props:{onlyAvatar:{type:Boolean},dropdownAlign:{default:"end"},dropdownSide:{default:"right"},buttonVariant:{default:"ghost"},class:{}},setup(i){const d=i,m=q(),f=G(),c=A(),o=v(!1);return(l,n)=>{const h=J,r=M,p=B,N=L,T=R;return u(),_(C,null,[s(N,{align:i.dropdownAlign,side:i.dropdownSide,items:[[{label:e(f).settings.home.title,icon:"i-mdi:home",handle:()=>e(m).push({path:e(f).settings.home.fullPath}),hide:!e(f).settings.home.enable},{label:"个人设置",icon:"i-mdi:account",handle:()=>o.value=!0}],[{label:"快捷键介绍",icon:"i-mdi:keyboard",handle:()=>e(K).emit("global-hotkeys-intro-toggle"),hide:e(f).mode!=="pc"}],[{label:"退出登录",icon:"i-mdi:logout",handle:()=>e(c).logout(e(f).settings.home.fullPath)}]],class:"flex-center"},{header:t(()=>[a("div",re,[n[2]||(n[2]=a("div",{class:"text-xs text-secondary-foreground/50 font-light"}," 当前登录账号 ",-1)),a("div",ie,[s(h,{src:e(c).avatar,fallback:e(c).account.slice(0,5),shape:"square"},null,8,["src","fallback"]),a("div",de,[a("div",ue,g(e(c).account),1),n[1]||(n[1]=a("div",{class:"text-xs text-secondary-foreground/50 font-normal"}," [ 这里可以显示邮箱 ] ",-1))])])])]),default:t(()=>[s(p,{variant:i.buttonVariant,class:S(e(z)("flex-center gap-1 p-2",{"size-8 p-1":i.onlyAvatar},d.class))},{default:t(()=>[s(h,{src:e(c).avatar,class:S(e(z)("size-6",{"size-full":i.onlyAvatar}))},{default:t(()=>[s(r,{name:"i-carbon:user-avatar-filled",class:"size-6 text-secondary-foreground/50"})]),_:1},8,["src","class"]),i.onlyAvatar?F("",!0):(u(),_("div",me,[a("div",fe,g(e(c).account),1),s(r,{name:"i-material-symbols:expand-all-rounded"})]))]),_:1},8,["variant","class"])]),_:1},8,["align","side","items"]),s(T,{modelValue:e(o),"onUpdate:modelValue":n[0]||(n[0]=E=>H(o)?o.value=E:null),"align-center":"",header:!1,footer:!1,"close-on-click-overlay":!1,"close-on-press-escape":!1,class:"h-500px max-w-xl overflow-hidden","content-class":"min-h-full p-0 flex"},{default:t(()=>[s(ce)]),_:1},8,["modelValue"])],64)}}});export{be as _};
