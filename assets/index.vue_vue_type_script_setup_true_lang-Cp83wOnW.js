
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as b,e as h,J as F,K as C,ax as K,ad as N,c as k,o as f,n as O,u as E,a as S,F as I,R as J,A as L,z as q,a7 as R,aa as T}from"./index-CJB5jCfL.js";import{r as U,_ as W}from"./item.vue_vue_type_script_setup_true_lang-BkEpGKnc.js";import{_ as D}from"./sub.vue_vue_type_script_setup_true_lang-DZlHgfjt.js";const Y=b({name:"MainMenu",__name:"index",props:{menu:{},value:{},accordion:{type:Boolean,default:!0},defaultOpeneds:{default:()=>[]},mode:{default:"vertical"},collapse:{type:Boolean,default:!1},showCollapseName:{type:Boolean,default:!1}},setup(w){const l=w,y=new WeakMap;function r(e){return y.has(e)||y.set(e,R()),y.get(e)}const o=h(l.value),s=h({}),c=h({}),t=h(l.defaultOpeneds.slice(0)),A=h([]),M=F(()=>l.mode==="horizontal"||l.mode==="vertical"&&l.collapse);function B(e,n=[]){e.forEach(a=>{var v,d;const u=(v=a.path)!=null?v:r(a);if((d=a.children)!=null&&d.some(i=>{var p;return((p=i.meta)==null?void 0:p.menu)!==!1})){const i=[...n,u];c.value[u]={index:u,indexPath:i,active:!1},B(a.children,i)}else s.value[u]={index:u,indexPath:n}})}const _=(e,n)=>{t.value.includes(e)||(l.accordion&&(t.value=t.value.filter(a=>n.includes(a))),t.value.push(e))},m=e=>{if(Array.isArray(e)){T(()=>{m(e.at(-1)),e.length>1&&m(e.slice(0,-1))});return}t.value=t.value.filter(n=>n!==e)};function P(e){var n,a;for(const u in c.value)c.value[u].active=!1;(n=c.value[e])==null||n.indexPath.forEach(u=>{c.value[u].active=!0}),(a=s.value[e])==null||a.indexPath.forEach(u=>{c.value[u].active=!0})}const g=e=>{(l.mode==="horizontal"||l.collapse)&&(t.value=[]),P(e)},$=(e,n)=>{t.value.includes(e)?m(e):_(e,n)};function x(){const e=o.value&&s.value[o.value];P(o.value),!(!e||M.value||l.collapse)&&e.indexPath.forEach(n=>{const a=c.value[n];a&&_(n,a.indexPath)})}return C(()=>l.menu,e=>{B(e),x()},{deep:!0,immediate:!0}),C(()=>l.value,e=>{s.value[e]||(o.value="");const n=s.value[e]||o.value&&s.value[o.value]||s.value[l.value];n?o.value=n.index:o.value=e,x()}),C(()=>l.collapse,e=>{e&&(t.value=[]),x()}),K(U,N({props:l,getUseId:r,items:s,subMenus:c,activeIndex:o,openedMenus:t,mouseInMenu:A,isMenuPopup:M,openMenu:_,closeMenu:m,handleMenuItemClick:g,handleSubMenuClick:$})),(e,n)=>(f(),k("div",{class:O(E(S)("h-full w-full flex flex-col of-hidden",{"flex-row w-auto":E(M)&&l.mode==="horizontal","py-1":l.mode==="vertical"}))},[(f(!0),k(I,null,J(w.menu,a=>{var u,v,d,i,p;return f(),k(I,{key:(u=a.path)!=null?u:r(a)},[((v=a.meta)==null?void 0:v.menu)!==!1?(f(),k(I,{key:0},[(d=a.children)!=null&&d.length?(f(),q(D,{key:0,menu:a,"unique-key":[(i=a.path)!=null?i:r(a)]},null,8,["menu","unique-key"])):(f(),q(W,{key:1,item:a,"unique-key":[(p=a.path)!=null?p:r(a)],onClick:G=>{var z;return g((z=a.path)!=null?z:r(a))}},null,8,["item","unique-key","onClick"]))],64)):L("",!0)],64)}),128))],2))}});export{Y as _};
