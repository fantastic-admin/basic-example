
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{e as h,J as z,E as G,ae as H,at as J,K}from"./index-DXZKKOp8.js";function R(s,S={x:0,y:0,width:100,height:100},T=1,E){const v=h({...S}),u=h({...v.value}),r=h(1),g=h(!1),L=h(!1),w=h(0),b=h(null),f=h({x:0,y:0}),F=z(()=>u.value.x!==v.value.x||u.value.y!==v.value.y||u.value.width!==v.value.width||u.value.height!==v.value.height);let m=null;function q(e){if(e.length<2)return 0;const t=e[0].clientX-e[1].clientX,n=e[0].clientY-e[1].clientY;return Math.hypot(t,n)}function p(e){var l;const t=s.value;if(!t)return{x:0,y:0};const n=t.createSVGPoint();n.x=e.clientX,n.y=e.clientY;const a=(l=t.getScreenCTM())==null?void 0:l.inverse();return a?n.matrixTransform(a):{x:0,y:0}}function V(e,t){const n=s.value;if(!n)return{dx:0,dy:0};const a=Math.max(1,n.clientWidth),l=Math.max(1,n.clientHeight),o=u.value.width/a,c=u.value.height/l;return{dx:e*o,dy:t*c}}function Y(e){var n;g.value=!0;const t=((n=e.touches)==null?void 0:n[0])||e;f.value={x:t.clientX,y:t.clientY},s.value&&(s.value.style.cursor="grabbing")}function X(e){var c;if(!g.value)return;const t=((c=e.touches)==null?void 0:c[0])||e,n=t.clientX-f.value.x,a=t.clientY-f.value.y;if(n===0&&a===0)return;const{dx:l,dy:o}=V(n,a);u.value.x-=l,u.value.y-=o,f.value={x:t.clientX,y:t.clientY}}function d(){g.value=!1,s.value&&(s.value.style.cursor="")}function A(e){e.preventDefault();const t=e.deltaY>0?.9:1.1;M(t,p(e))}function B(e){e.preventDefault();const t=p(e),n=1.02*(1+T/100);I(n,t)}function I(e,t){m&&cancelAnimationFrame(m);const n=r.value,a=n*e;let l=0;const o=i=>i<.5?2*i*i:-1+(4-2*i)*i,c=()=>{l+=.02;const i=n+(a-n)*o(l);M(i/n,t),l<1?m=requestAnimationFrame(c):m=null};c()}function M(e,t){const n=r.value*e,a=n/r.value,l=u.value.width/a,o=u.value.height/a,c=(t.x-u.value.x)*(1-1/a),i=(t.y-u.value.y)*(1-1/a);u.value.x+=c,u.value.y+=i,u.value.width=l,u.value.height=o,r.value=n}function Z(e){e.touches.length===2?(L.value=!0,w.value=q(e.touches),b.value={...u.value}):(e.preventDefault(),Y(e))}function C(e){if(L.value&&e.touches.length===2){e.preventDefault();const t=q(e.touches);if(w.value){const n=t/w.value;s.value.getBoundingClientRect();const a=(e.touches[0].clientX+e.touches[1].clientX)/2,l=(e.touches[0].clientY+e.touches[1].clientY)/2,o=p({clientX:a,clientY:l});u.value={...b.value},M(n,o)}}else e.preventDefault(),X(e)}function x(e){e.touches.length<2&&(L.value=!1),d()}function P(e=!1){if(!e){u.value={...v.value},r.value=1;return}const t={...u.value},n=r.value,a=300;let l=null;const o=c=>{l==null&&(l=c);const i=Math.min((c-l)/a,1);u.value={x:t.x+(v.value.x-t.x)*i,y:t.y+(v.value.y-t.y)*i,width:t.width+(v.value.width-t.width)*i,height:t.height+(v.value.height-t.height)*i},r.value=n+(1-n)*i,i<1&&requestAnimationFrame(o)};requestAnimationFrame(o)}function U(e,t={}){const{overwriteCurrentIfNotZoomed:n=!0}=t;v.value={...e},!F.value&&n&&(u.value={...v.value},r.value=1)}function D(){const e=s.value;e&&(e.addEventListener("mousedown",Y),e.addEventListener("mousemove",X),e.addEventListener("mouseup",d),e.addEventListener("mouseleave",d),e.addEventListener("wheel",A,{passive:!1}),e.addEventListener("dblclick",B),e.addEventListener("touchstart",Z,{passive:!1}),e.addEventListener("touchmove",C,{passive:!1}),e.addEventListener("touchend",x),e.addEventListener("touchcancel",x))}function y(){const e=s.value;e&&(e.removeEventListener("mousedown",Y),e.removeEventListener("mousemove",X),e.removeEventListener("mouseup",d),e.removeEventListener("mouseleave",d),e.removeEventListener("wheel",A),e.removeEventListener("dblclick",B),e.removeEventListener("touchstart",Z),e.removeEventListener("touchmove",C),e.removeEventListener("touchend",x),e.removeEventListener("touchcancel",x))}return G(D),H(y),J(()=>(E!=null&&E.value?D():y(),()=>y())),K(s,(e,t)=>{y(),D()}),{viewBox:u,resetZoom:P,isZoom:F,setInitialViewBox:U}}export{R as U};
