
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Tooltip-D0pGX8qz-BS2YwyOE.js","./vue-data-ui-8Gmf-dDN.js","./index-CJB5jCfL.js","./index-D6D_bXIl.css","./alert-I_0TAljB.js","./vue-data-ui-C46fMXq5.css","./UserOptions-Cy-iNhZU-CnpDVImt.js","./vClickOutside-C6WiFswA-B2BXHGcD.js","./img-CqYIrJ8I-E54QgU9o.js","./dom-to-png-WXGPkYro-BQsfl1t5.js","./PenAndPaper--ADXtx65-ugytqLuo.js","./ColorPicker-BYn8PF2Z-DkxHqz9_.js","./PackageVersion-By5ZZJ0U-Cc8IPeAX.js"])))=>i.map(i=>d[i]);
import{e as p,a8 as ko,J as f,K as re,aa as le,aw as xt,c as $,E as Co,o as g,A as B,z as U,g as $t,h as x,r as k,j as P,k as I,u as b,c1 as de,c3 as wo,O as ve,f as ie,F as fe,R as me,n as _t,m as Fo,t as No,c4 as pe}from"./index-CJB5jCfL.js";import{s as xo,J as $o,x as _o,u as Oe,d as Eo,g as Et}from"./vue-data-ui-8Gmf-dDN.js";import{R as Po}from"./usePanZoom-CDF7rb3o-B2p6nSm_.js";import{E as Io,M as Oo}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{s as Mo,i as Me}from"./useNestedProp-DaR1dBmj-yWXLkJlG.js";import{T as Ro,j as To}from"./BaseScanner-BMpwQAfz-mc47WWxo.js";import{m as So}from"./usePrinter-ChVMpU2f-B27PF0nl.js";import{O as Bo}from"./useSvgExport-ByUukOZt-XO0OK7cR.js";import{i as jo}from"./useThemeCheck-DGJ31Vi5-GRZcYzX8.js";import{a as Do}from"./useUserOptionState-BIvW1Kz7-D70wY835.js";import{o as zo}from"./useChartAccessibility-9icAAmYg-CuAxjhEs.js";import Zo from"./img-CqYIrJ8I-E54QgU9o.js";import{S as Lo}from"./geoProjections-D0Vxsz_O-DZws-lDg.js";import Go from"./Title-D0nD-PMs-DAiwElB_.js";import{R as Pt}from"./BaseZoomControls-BQ2emGam-4GK2QSnM.js";import"./alert-I_0TAljB.js";import"./dom-to-png-WXGPkYro-BQsfl1t5.js";const Ot={style:{chart:{backgroundColor:"#1A1A1A",color:"#CCCCCC",controls:{backgroundColor:"#2A2A2A",buttonColor:"#2A2A2A",color:"#CCCCCC",border:"1px solid #4A4A4A"},territory:{fill:"#2A2A2A",stroke:"#5A5A5A",hover:{fill:"#3A3A3A",stroke:"#6A6A6A"}},points:{stroke:"#1A1A1A",fill:"#CCCCCC",labels:{color:"#CCCCCC"}},title:{color:"#CCCCCC",subtitle:{color:"#757575"}},tooltip:{backgroundColor:"#1A1A1A",backgroundOpacity:70,color:"#CCCCCC",borderColor:"#5A5A5A"}}}},Mt={style:{chart:{backgroundColor:"#FFF8E1",color:"#424242",controls:{backgroundColor:"#FFF8E1",buttonColor:"#FFF8E1",color:"#424242",border:"1px solid #d9bbb2"},title:{color:"#424242",subtitle:{color:"#757575"}},tooltip:{backgroundColor:"#FFECB3",backgroundOpacity:30,color:"#424242",borderColor:"#FF8A65"},territory:{fill:"#e3dcc8",stroke:"#f7c0b0",hover:{fill:"#FFECB3",stroke:"#FF8A65"}},points:{stroke:"#FFF8E1",fill:"#424242",labels:{color:"#424242"}}}}},Rt={style:{chart:{backgroundColor:"#1E1E1E",color:"#BDBDBD",controls:{backgroundColor:"#1E1E1E",buttonColor:"#1E1E1E",color:"#BDBDBD",border:"1px solid #3A3A3A"},title:{color:"#FFF8E1",subtitle:{color:"#BDBDBD"}},tooltip:{backgroundColor:"#1E1E1E",backgroundOpacity:30,color:"#FFF8E1",borderColor:"#FF8A65"},territory:{fill:"#2A1E1E",stroke:"#6e483c",hover:{fill:"#403e39",stroke:"#805244"}},points:{stroke:"#1E1E1E",fill:"#BDBDBD",labels:{color:"#BDBDBD"}}}}},Tt={style:{chart:{backgroundColor:"#fbfafa",color:"#8A9892",controls:{backgroundColor:"#fbfafa",buttonColor:"#fbfafa",color:"#99AA99",border:"1px solid #ebded3"},title:{color:"#8A9892",subtitle:{color:"#99AA99"}},tooltip:{backgroundColor:"#fbfafa",color:"#8A9892"},territory:{fill:"#e6e2df",stroke:"#fbfafa",hover:{fill:"#dbd5d0",stroke:"#fbfafa"}},points:{stroke:"#fbfafa",fill:"#8A9892",labels:{color:"#8A9892"}}}}},St={style:{chart:{backgroundColor:"#1A1A1A",color:"#99AA99",controls:{backgroundColor:"#1A1A1A",buttonColor:"#1A1A1A",color:"#99AA99",border:"1px solid #1e361e"},title:{color:"#66CC66",subtitle:{color:"#99AA99"}},tooltip:{backgroundColor:"#2A2F2A",color:"#AACCAA",borderColor:"#66CC66"},territory:{fill:"#1A1F1A",stroke:"#2c5c2c",hover:{fill:"#3A3A3A",stroke:"#66CC66"}},points:{stroke:"#2c5c2c",fill:"#66CC66",labels:{color:"#99AA99"}}}}},Bt={style:{chart:{backgroundColor:"#f6f6fb",color:"#50606C",controls:{backgroundColor:"#f6f6fb",buttonColor:"#f6f6fb",color:"#50606C",border:"1px solid #98aab8",borderRadius:"0"},title:{color:"#50606C",subtitle:{color:"#718890"}},tooltip:{backgroundColor:"#f6f6fb",color:"#50606C"},territory:{fill:"#cfdae3",stroke:"#98aab8",hover:{fill:"#bcc8d1",stroke:"#50606C"}},points:{stroke:"#f6f6fb",fill:"#50606C",labels:{color:"#50606C"}}}}},jt={default:{},dark:Ot,celebration:Mt,celebrationNight:Rt,zen:Tt,hack:St,concrete:Bt},gr=Object.freeze(Object.defineProperty({__proto__:null,celebration:Mt,celebrationNight:Rt,concrete:Bt,dark:Ot,default:jt,hack:St,zen:Tt},Symbol.toStringTag,{value:"Module"})),Wo=["id"],Yo=["xmlns","viewBox","id"],qo=["transform"],Vo=["d","fill","stroke","stroke-width","onMouseenter","onMouseleave","onClick"],Xo=["d","stroke","stroke-width","onMouseenter","onMouseleave","onClick"],Jo=["cx","cy","r","fill","stroke","stroke-width","onMouseenter"],Uo=["cx","cy","r","fill","stroke","stroke-width","onMouseenter","onMouseleave","onClick"],Ho=["x","y","fill","font-size"],Ko={key:5,class:"vue-data-ui-watermark"},It=1.5,Qo={__name:"vue-ui-geo",props:{config:{type:Object,default(){return{}}},dataset:{type:[Array,Object],default(){return[]}}},setup(Dt,{expose:zt}){const Zt=de(()=>pe(()=>import("./Tooltip-D0pGX8qz-BS2YwyOE.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),Lt=de(()=>pe(()=>import("./UserOptions-Cy-iNhZU-CnpDVImt.js"),__vite__mapDeps([6,2,3,7,1,4,5,8,9]),import.meta.url)),Gt=de(()=>pe(()=>import("./PenAndPaper--ADXtx65-ugytqLuo.js"),__vite__mapDeps([10,2,3,1,4,5,11,7]),import.meta.url)),Wt=de(()=>pe(()=>import("./PackageVersion-By5ZZJ0U-Cc8IPeAX.js"),__vite__mapDeps([12,2,3]),import.meta.url)),H=Dt,{vue_ui_geo:Yt}=Mo(),{isThemeValid:qt,warnInvalidTheme:Vt}=jo(),j=p($o()),he=p(0),Re=p(0),R=p(null),D=p(!1),ne=p(null),Te=p(null),Se=p(null),Be=p(null),W=p(null),Y=p(null),je=p(null),De=p(null),z=p(!1);function ze(e){z.value=e,he.value+=1}function ye(){const e=Me({userConfig:H.config,defaultConfig:Yt}),o=e.theme;if(!o)return e;if(!qt.value(e))return Vt(e),e;const t=Me({userConfig:jt[o]||H.config,defaultConfig:e});return Me({userConfig:H.config,defaultConfig:t})}const l=p(ye()),{userOptionsVisible:Ze,keepUserOptionState:Le}=Do({config:l.value}),{svgRef:ae}=zo({config:l.value.style.chart.title}),{loading:ge,FINAL_DATASET:Xt}=Ro({...ko(H),FINAL_CONFIG:l,prepareConfig:ye,allowEmptyDataset:!0,skeletonDataset:[],skeletonConfig:_o({defaultConfig:l.value,userConfig:{map:{geoJson:{type:"FeatureCollection",features:[{type:"Feature",properties:{name:"Island A"},geometry:{type:"Polygon",coordinates:[[[-6,2],[-4,2],[-4,4],[-6,4],[-6,2]]]}},{type:"Feature",properties:{name:"Island B"},geometry:{type:"Polygon",coordinates:[[[-2,-1],[1,-1],[1,2],[-2,2],[-2,-1]]]}},{type:"Feature",properties:{name:"Island C"},geometry:{type:"Polygon",coordinates:[[[3,-3],[5,-3],[5,-1],[3,-1],[3,-3]]]}},{type:"Feature",properties:{name:"Island D"},geometry:{type:"Polygon",coordinates:[[[4,3],[7,3],[7,5],[4,5],[4,3]]]}}]}},userOptions:{show:!1},style:{chart:{backgroundColor:"#99999930",territory:{fill:"#99999950",stroke:"#8A8A8A",strokeWidth:.5}}}}})}),{isPrinting:Ge,isImaging:We,generatePdf:Ye,generateImage:qe}=So({elementId:"vue-ui-geo_".concat(j.value),fileName:l.value.style.chart.title.text||"vue-ui-geo",options:l.value.userOptions.print}),Jt=f(()=>{var e,o,t,r;return l.value.style.chart.controls.show?l.value.style.chart.controls.position==="top"?(o=(e=je.value)==null?void 0:e.$el)!=null?o:null:l.value.style.chart.controls.position==="bottom"&&(r=(t=De.value)==null?void 0:t.$el)!=null?r:null:null});function be(){W.value&&(Y.value&&W.value.unobserve(Y.value),W.value.disconnect(),W.value=null,Y.value=null)}const q=f(()=>!!l.value.responsive&&!z.value);re(()=>z.value,async e=>{if(e){be(),V.value=Number(l.value.style.chart.dimensions.width)||V.value,Z.value=Number(l.value.style.chart.dimensions.height)||Z.value,await le(),D.value=!1,requestAnimationFrame(()=>{D.value||ce()});return}l.value.responsive&&(await le(),Ae())});function Ae(){if(be(),!q.value)return;const e=Io(()=>{if(!R.value)return;const{width:o,height:t}=Oo({chart:R.value,noTitle:Ve.value?Se.value:null,title:l.value.style.chart.title.text?Te.value:null,legend:Jt.value,source:Be.value});requestAnimationFrame(()=>{V.value=Math.max(.1,Number(o)||.1),Z.value=Math.max(.1,Number(t)||.1)-24})});W.value=new ResizeObserver(e),Y.value=R.value?R.value.parentNode:null,Y.value&&W.value.observe(Y.value),e()}const Ve=f(()=>l.value.userOptions.show&&!l.value.style.chart.title.text),K=p({showTooltip:l.value.style.chart.tooltip.show}),T=p(l.value.style.chart.zoom.active);re(()=>H.config,()=>{l.value=ye(),K.value.showTooltip=l.value.style.chart.tooltip.show,T.value=l.value.style.chart.zoom.active,V.value=l.value.style.chart.dimensions.width,Z.value=l.value.style.chart.dimensions.height,Ae(),Re.value+=1,he.value+=1},{deep:!0});const{projections:se}=Lo,Xe=f(()=>{var e;return((e=l.value)==null?void 0:e.projection)||"equirectangular"}),Ut=f(()=>{const e=se==null?void 0:se[Xe.value];return typeof e=="function"?e:se.equirectangular}),Je=f(()=>{var e;return(e=l.value.map.geoJson)!=null?e:null}),Ue={aitoff:{width:1e3,height:500},azimuthalEquidistant:{width:1e3,height:1e3},bonne:{width:1e3,height:1e3},equirectangular:{width:1e3,height:700},gallPeters:{width:1e3,height:800},globe:{width:1e3,height:1e3},hammer:{width:1e3,height:500},mercator:{width:1e3,height:750},mollweide:{width:1e3,height:600},robinson:{width:1e3,height:600},sinusoidal:{width:1e3,height:500},vanDerGrinten:{width:1e3,height:1e3},winkelTripel:{width:1e3,height:1e3}},V=p(l.value.style.chart.dimensions.width),Z=p(l.value.style.chart.dimensions.height),ke=f(()=>{const e=Ue[Xe.value]||Ue.equirectangular;return{width:e.width,height:e.height}}),E=f(()=>{const e=ke.value,o=V.value,t=Z.value,r=Number.isFinite(o)&&o>0,i=Number.isFinite(t)&&t>0;if(r&&i)return{width:o,height:t};if(r&&!i){const n=e.height/e.width;return{width:o,height:o*n}}if(!r&&i){const n=e.width/e.height;return{width:t*n,height:t}}return{width:e.width,height:e.height}}),Ht=f(()=>{var i,n;const e=(n=(i=l.value)==null?void 0:i.map)==null?void 0:n.center,o=[0,0];if(!Array.isArray(e)||e.length!==2)return o;const t=Number(e[0]),r=Number(e[1]);return!Number.isFinite(t)||!Number.isFinite(r)?o:[t,r]});function X([e,o]){return Ut.value([e,o],ke.value.width,ke.value.height,Ht.value)}function Kt(e,o={}){const{defaultName:t="",namePropertyCandidates:r=["name","nom","admin","NAME","label","title","description","DESCRIPTION","NAME_1","NAME_2","NAME_3","NAME_EN","name:en","name_en","localname","local_name"],includeNullGeometries:i=!1}=o,n={type:"FeatureCollection",features:[]};function a(u){return u!==null&&typeof u=="object"&&!Array.isArray(u)}function c(u){return!a(u)||typeof u.type!="string"?!1:u.type==="GeometryCollection"?Array.isArray(u.geometries):Object.hasOwn(u,"coordinates")}function d(u){if(!a(u))return"";for(const m of r){const y=u[m];if(typeof y=="string"&&y.trim())return y.trim()}return""}function s({geometry:u,properties:m,fallbackName:y,featureIndex:v}){const A=a(m)?{...m}:{},F=d(A),C=t?"".concat(t," ").concat(v+1):"",N=F||(typeof y=="string"?y.trim():"")||C;return!A.name&&N&&(A.name=N),{type:"Feature",geometry:u,properties:A}}function w(u,m,y,v,A){const F=Array.isArray(u==null?void 0:u.geometries)?u.geometries:[];let C=v;for(let N=0;N<F.length;N+=1){const M=F[N];if(M){if(a(M)&&M.type==="GeometryCollection"){C=w(M,m,y,C,A);continue}if(c(M)){if(M.coordinates==null&&M.type!=="GeometryCollection"){i&&(A.push(s({geometry:null,properties:m,fallbackName:y,featureIndex:C})),C+=1);continue}A.push(s({geometry:M,properties:m,fallbackName:y,featureIndex:C})),C+=1}}}return C}function h(u,m,y=0){var A;let v=y;if(u==null)return v;if(Array.isArray(u)){for(const F of u)v=h(F,m,v);return v}if(!a(u)||typeof u.type!="string")return v;if(u.type==="FeatureCollection"){const F=Array.isArray(u.features)?u.features:[];for(const C of F)v=h(C,m,v);return v}if(u.type==="Feature"){const F=a(u.properties)?u.properties:{},C=d(F),N=(A=u.geometry)!=null?A:null;return N==null?(i&&(m.push(s({geometry:null,properties:F,fallbackName:C,featureIndex:v})),v+=1),v):a(N)&&N.type==="GeometryCollection"?w(N,F,C,v,m):(c(N)&&(m.push(s({geometry:N,properties:F,fallbackName:C,featureIndex:v})),v+=1),v)}return u.type==="GeometryCollection"?w(u,{},"",v,m):(c(u)&&(m.push(s({geometry:u,properties:{},fallbackName:"",featureIndex:v})),v+=1),v)}const _=[];return h(e,_,0),{...n,features:_}}function Qt(e){const o=Array.isArray(e==null?void 0:e.features)?e.features:[];function t(r){if(!r||typeof r!="object")return"";const i=[r.name,r.nom,r.admin,r.NAME,r.label,r.title,r.description,r.DESCRIPTION,r.NAME_1,r.NAME_2,r.NAME_3,r.NAME_EN,r["name:en"],r.name_en,r.localname,r.local_name];for(const n of i)if(typeof n=="string"&&n.trim())return n.trim();for(const n of Object.values(r))if(typeof n=="string"&&n.trim())return n.trim();return""}return o.filter(r=>r&&r.type==="Feature"&&r.geometry).map((r,i)=>{const n=r.properties||{},a=t(n);return{feature:r,geometry:r.geometry,properties:n,name:a,uid:"map-feature-".concat(j.value,"-").concat(i),index:i}})}const eo=f(()=>Kt(Je.value,{defaultName:"",includeNullGeometries:!1})),ue=f(()=>Qt(eo.value));function Ce(e){if(!e||typeof e.type!="string")return"";if(e.type==="GeometryCollection")return(Array.isArray(e.geometries)?e.geometries:[]).map(i=>Ce(i)).filter(Boolean).join(" ");const o=i=>{if(!Array.isArray(i)||i.length<2)return null;const n=Number(i[0]),a=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(a))return null;const c=X([n,a]);if(!Array.isArray(c)||c.length<2)return null;const d=Number(c[0]),s=Number(c[1]);return!Number.isFinite(d)||!Number.isFinite(s)?null:[d,s]},t=i=>{const n=(i||[]).map(o).filter(Boolean);return n.length<2?"":"M"+n.map(([a,c])=>"".concat(a,",").concat(c)).join("L")},r=i=>(i||[]).map(n=>{const a=t(n);return a?a+"Z":""}).filter(Boolean).join(" ");return e.type==="Polygon"?r(e.coordinates):e.type==="MultiPolygon"?(e.coordinates||[]).map(r).filter(Boolean).join(" "):e.type==="LineString"?t(e.coordinates):e.type==="MultiLineString"?(e.coordinates||[]).map(t).filter(Boolean).join(" "):""}function He(e){return e?e.type==="GeometryCollection"?(Array.isArray(e.geometries)?e.geometries:[]).flatMap(o=>He(o)):e.type==="Point"?Array.isArray(e.coordinates)?[e.coordinates]:[]:e.type==="MultiPoint"?Array.isArray(e.coordinates)?e.coordinates:[]:[]:[]}function Ke(e){return!e||typeof e.type!="string"?!1:e.type==="GeometryCollection"?(Array.isArray(e.geometries)?e.geometries:[]).some(o=>Ke(o)):e.type==="Point"||e.type==="MultiPoint"}const to=f(()=>ue.value.filter(e=>{const o=e.geometry;return o?o.type==="GeometryCollection"?(Array.isArray(o.geometries)?o.geometries:[]).some(t=>(t==null?void 0:t.type)==="Polygon"||(t==null?void 0:t.type)==="MultiPolygon"):o.type==="Polygon"||o.type==="MultiPolygon":!1})),oo=f(()=>ue.value.filter(e=>{const o=e.geometry;return o?o.type==="GeometryCollection"?(Array.isArray(o.geometries)?o.geometries:[]).some(t=>(t==null?void 0:t.type)==="LineString"||(t==null?void 0:t.type)==="MultiLineString"):o.type==="LineString"||o.type==="MultiLineString":!1})),ro=f(()=>ue.value.filter(e=>{const o=e.geometry;return o?Ke(o):!1})),Qe=f(()=>to.value.map(e=>{const o=Ce(e.geometry);return o?{...e,path:o}:null}).filter(Boolean)),et=f(()=>oo.value.map(e=>{const o=Ce(e.geometry);return o?{...e,path:o}:null}).filter(Boolean)),tt=f(()=>{var t;const e=[];function o(r={}){var u,m,y,v,A,F,C,N,M,Nt;const i=r!=null&&r.style&&typeof r.style=="object"?r.style:{},n=(y=(m=(u=r.radius)!=null?u:r.r)!=null?m:i.radius)!=null?y:i.r,a=(F=(A=(v=r.color)!=null?v:r.fill)!=null?A:i.color)!=null?F:i.fill,c=(C=r.stroke)!=null?C:i.stroke,d=(Nt=(M=(N=r.strokeWidth)!=null?N:r.stroke_width)!=null?M:i.strokeWidth)!=null?Nt:i.stroke_width,s=Number.isFinite(Number(n))?Number(n):Number(l.value.style.chart.points.radius),w=a!=null&&String(a).trim()?Oe(String(a).trim()):l.value.style.chart.points.fill,h=c!=null&&String(c).trim()?Oe(String(c).trim()):l.value.style.chart.points.stroke,_=Number.isFinite(Number(d))?Number(d):Number(l.value.style.chart.points.strokeWidth);return{radius:s,fill:w,stroke:h,strokeWidth:_}}for(const r of ro.value){const i=He(r.geometry);for(let n=0;n<i.length;n+=1){const a=i[n];if(!Array.isArray(a)||a.length<2)continue;const c=Number(a[0]),d=Number(a[1]);if(!Number.isFinite(c)||!Number.isFinite(d))continue;const s=X([c,d]),w=s==null?void 0:s[0],h=s==null?void 0:s[1];if(!Number.isFinite(w)||!Number.isFinite(h))continue;const _=(t=r==null?void 0:r.feature)!=null&&t.properties&&typeof r.feature.properties=="object"?r.feature.properties:{},u=o(_);e.push({uid:"".concat(r.uid,"-geojson-point-").concat(n),name:r.name||"",x:w,y:h,...u,originalFeature:r.feature,featureIndex:r.index,pointIndex:n})}}return e});function ot(e){if(!e||typeof e.type!="string")return[];const o=[],t=i=>{if(!Array.isArray(i)||i.length<2)return;const n=Number(i[0]),a=Number(i[1]);if(!Number.isFinite(n)||!Number.isFinite(a))return;const c=X([n,a]),d=c==null?void 0:c[0],s=c==null?void 0:c[1];!Number.isFinite(d)||!Number.isFinite(s)||o.push([d,s])},r=i=>{if(Array.isArray(i)){if(i.length>=2&&typeof i[0]=="number"&&typeof i[1]=="number"){t(i);return}for(const n of i)r(n)}};if(e.type==="GeometryCollection"&&Array.isArray(e.geometries)){for(const i of e.geometries)o.push(...ot(i));return o}return e.type==="Point"?(t(e.coordinates),o):e.type==="MultiPoint"?((e.coordinates||[]).forEach(t),o):(r(e.coordinates),o)}function lo(e){const o=[];for(const d of e)o.push(...ot(d.geometry));if(!o.length)return null;let t=1/0,r=1/0,i=-1/0,n=-1/0;for(const[d,s]of o)d<t&&(t=d),s<r&&(r=s),d>i&&(i=d),s>n&&(n=s);const a=i-t,c=n-r;return!(a>0)||!(c>0)?null:{minX:t,minY:r,maxX:i,maxY:n,width:a,height:c}}const io=f(()=>lo(ue.value));function no({bounds:e,targetWidth:o,targetHeight:t,padding:r}){if(!e||!(e.width>0)||!(e.height>0))return{scale:1,translateX:0,translateY:0,transform:""};const i=Number.isFinite(Number(r))?Number(r):0,n=Math.max(1,o-i*2),a=Math.max(1,t-i*2),c=n/e.width,d=a/e.height,s=Math.min(c,d),w=e.width*s,h=e.height*s,_=i+(n-w)/2,u=i+(a-h)/2,m=_-e.minX*s,y=u-e.minY*s;return{scale:s,translateX:m,translateY:y,transform:"translate(".concat(m," ").concat(y,") scale(").concat(s,")")}}const rt=f(()=>{var r,i;const e=io.value;if(!e)return{scale:1,translateX:0,translateY:0,transform:""};const o=(i=(r=l.value)==null?void 0:r.map)==null?void 0:i.fitPadding,t=Number.isFinite(Number(o))?Number(o):0;return no({bounds:e,targetWidth:E.value.width,targetHeight:E.value.height,padding:t})}),ao=f(()=>{const e=E.value.width,o=E.value.height;return"0 0 ".concat(e," ").concat(o)}),{viewBox:Q,resetZoom:lt,setInitialViewBox:we,scale:it,zoomByFactor:nt}=Po(ae,{x:0,y:0,width:E.value.width,height:E.value.height},1,T);function so(){T.value=!T.value}function at(e){const o=rt.value,t=Number(o==null?void 0:o.scale)||1,r=Number(o==null?void 0:o.translateX)||0,i=Number(o==null?void 0:o.translateY)||0;return{x:e.x*t+r,y:e.y*t+i}}function st(){var w,h;const e=(h=(w=l.value)==null?void 0:w.map)==null?void 0:h.center,o=Number(e==null?void 0:e[0]),t=Number(e==null?void 0:e[1]),r=Array.isArray(e)&&e.length===2&&Number.isFinite(o)&&Number.isFinite(t)&&(o!==0||t!==0),i=E.value.width,n=E.value.height;if(!r)return{x:0,y:0,width:i,height:n};const a=X([o,t]),c=a==null?void 0:a[0],d=a==null?void 0:a[1];if(!Number.isFinite(c)||!Number.isFinite(d))return{x:0,y:0,width:i,height:n};const s=at({x:c,y:d});return{x:s.x-i/2,y:s.y-n/2,width:i,height:n}}function ce(){const e=st();we(e,{overwriteCurrentIfNotZoomed:!0}),D.value=!0}const ut=f(()=>{const e=Q.value;return e?"".concat(e.x," ").concat(e.y," ").concat(e.width," ").concat(e.height):ao.value});function Fe(){nt(It,!0)}function Ne(){nt(1/It,!0)}async function ct(){const e=st();we(e,{overwriteCurrentIfNotZoomed:!0}),lt(!0)}re(()=>{var e,o;return[l.value.projection,(e=l.value.map.center)==null?void 0:e[0],(o=l.value.map.center)==null?void 0:o[1],l.value.map.fitPadding,Je.value]},async()=>{D.value=!1,await le(),requestAnimationFrame(()=>{D.value||ce()})},{deep:!1}),re(()=>[V.value,Z.value,q.value],async()=>{q.value&&(await le(),we({x:0,y:0,width:E.value.width,height:E.value.height},{overwriteCurrentIfNotZoomed:!0}),D.value=!1,requestAnimationFrame(()=>{D.value||ce()}))},{flush:"post"});function uo(e){return e?e.type==="FeatureCollection"&&Array.isArray(e.features)?e.features.filter(o=>{var t;return(o==null?void 0:o.type)==="Feature"&&((t=o.geometry)==null?void 0:t.type)==="Point"}).map((o,t)=>{var a,c,d;const r=o.properties||{},i=r.name||r.label||r.title||"Point ".concat(t+1),n=o.geometry.coordinates;return{uid:"map-point-".concat(j.value,"-").concat(t),name:i,coordinates:n,color:(a=r.color)!=null?a:null,radius:(c=r.radius)!=null?c:null,hoverRadiusRatio:l.value.style.chart.points.hoverRadiusRatio,description:(d=r.description)!=null?d:null,original:o,index:t}}):Array.isArray(e)?e.map((o,t)=>{let r=null,i="Point ".concat(t+1),n=null,a=null,c=null;Array.isArray(o)&&o.length>=2?r=[Number(o[0]),Number(o[1])]:o&&typeof o=="object"&&(Array.isArray(o.coordinates)&&o.coordinates.length>=2?r=[Number(o.coordinates[0]),Number(o.coordinates[1])]:Number.isFinite(Number(o.lon))&&Number.isFinite(Number(o.lat))&&(r=[Number(o.lon),Number(o.lat)]),typeof o.name=="string"&&o.name.trim()&&(i=o.name),o.description!=null&&(n=o.description),o.color!=null&&(a=o.color),o.radius!=null&&(c=o.radius));const d=r?r[0]:NaN,s=r?r[1]:NaN;return!Number.isFinite(d)||!Number.isFinite(s)?null:{uid:"map-point-".concat(j.value,"-").concat(t),name:i,coordinates:[d,s],color:a,radius:c,hoverRadiusRatio:l.value.style.chart.points.hoverRadiusRatio,description:n,original:o,index:t}}).filter(Boolean):typeof e=="object"?Object.entries(e).map(([o,t],r)=>{var c,d,s;if(!t||typeof t!="object")return null;const i=Array.isArray(t.coordinates)?t.coordinates:null;if(!i||i.length<2)return null;const n=Number(i[0]),a=Number(i[1]);return!Number.isFinite(n)||!Number.isFinite(a)?null:{uid:"map-point-".concat(j.value,"-").concat(r,"-").concat(o),name:t.name||o,coordinates:[n,a],color:(c=t.color)!=null?c:null,radius:(d=t.radius)!=null?d:null,hoverRadiusRatio:l.value.style.chart.points.hoverRadiusRatio,description:(s=t.description)!=null?s:null,original:t,index:r}}).filter(Boolean):[]:[]}const dt=f(()=>uo(Xt.value)),vt=f(()=>dt.value.map(e=>{const o=X(e.coordinates),t=o==null?void 0:o[0],r=o==null?void 0:o[1];return!Number.isFinite(t)||!Number.isFinite(r)?null:{...e,x:t,y:r,fill:e.color?Oe(e.color):l.value.style.chart.points.fill,radius:Number.isFinite(Number(e.radius))?Number(e.radius):l.value.style.chart.points.radius}}).filter(Boolean)),xe=p(!1),$e=p(""),L=p(!1),ee=p(null),O=p(null);function _e(e){$e.value=e,xe.value=!0}function te(){xe.value=!1,$e.value=""}function Ee(e){return String(e!=null?e:"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function co(e){ne.value={datapoint:e,seriesIndex:e.index,series:dt.value,config:l.value},L.value=!1;const o=l.value.style.chart.tooltip.customFormat;if(Et(o))try{const i=o(ne.value);if(typeof i=="string")return L.value=!0,i}catch(i){console.warn("Custom format cannot be applied."),L.value=!1}const t=Ee(e.name),r=e.description!=null?'<div style="margin-top:6px">'.concat(Ee(e.description),"</div>"):"";return'<div><div style="font-weight:600">'.concat(t,"</div>").concat(r,"</div>")}function ft(e){L.value=!1;const o=l.value.style.chart.tooltip.customFormat;if(Et(o))try{const r=o({datapoint:e,config:l.value});if(typeof r=="string")return L.value=!0,r}catch(r){console.warn("Custom format cannot be applied."),L.value=!1}const t=typeof(e==null?void 0:e.name)=="string"?e.name.trim():"";return t?'<div><div style="font-weight:600">'.concat(Ee(t),"</div></div>"):(L.value=!1,"")}function mt(e){if(l.value.events.territoryEnter&&l.value.events.territoryEnter({datapoint:e,seriesIndex:e.index}),!(typeof(e==null?void 0:e.name)=="string"&&e.name.trim())&&!l.value.style.chart.territory.hover.enabledWhenEmpty){O.value=null,te();return}O.value=e.uid,_e(ft(e))}function pt(e){O.value=null,te(),l.value.events.territoryLeave&&l.value.events.territoryLeave({datapoint:e,seriesIndex:e.index})}function ht(e){l.value.events.territoryClick&&l.value.events.territoryClick({datapoint:e,seriesIndex:e.index})}function yt(e){ee.value=e.uid,_e(co(e)),l.value.events.datapointEnter&&l.value.events.datapointEnter({datapoint:e,seriesIndex:e.index})}function gt(e){ee.value=null,te(),l.value.events.datapointLeave&&l.value.events.datapointLeave({datapoint:e,seriesIndex:e.index})}const bt=f(()=>!!l.value.events.datapointClick&&typeof l.value.events.datapointClick=="function");function At(e){bt.value&&l.value.events.datapointClick({datapoint:e,seriesIndex:e.index})}const S=f(()=>l.value.style.chart.territory),kt=f(()=>l.value.style.chart.points);function vo(e){const o=typeof(e==null?void 0:e.name)=="string"?e.name.trim():"";if(!o){O.value=null,te();return}const t={name:o,uid:e.uid,index:e.featureIndex,properties:{}};O.value=e.uid,_e(ft(t))}function fo(){O.value=null,te()}const oe=p(!1);function Pe(){oe.value=!oe.value}re(()=>oe.value,e=>{T.value=!e});function Ct(){K.value.showTooltip=!K.value.showTooltip}const mo=f(()=>l.value.style.chart.backgroundColor),po=f(()=>l.value.style.chart.title),{exportSvg:ho,getSvg:yo}=Bo({svg:ae,title:po,legend:void 0,legendItems:void 0,backgroundColor:mo});async function wt({isCb:e}){if(e){const{blob:o,url:t,text:r,dataUrl:i}=await yo();l.value.userOptions.callbacks.svg({blob:o,url:t,text:r,dataUrl:i})}else ho()}async function go({scale:e=2}={}){if(!R.value)return;const{width:o,height:t}=R.value.getBoundingClientRect(),r=o/t,{imageUri:i,base64:n}=await Zo({domElement:R.value,base64:!0,img:!0,scale:e});return{imageUri:i,base64:n,title:l.value.style.chart.title.text,width:o,height:t,aspectRatio:r}}const G=p(!1);let J=null;function bo(){T.value&&(G.value=!0)}function Ie(){G.value=!1}function Ao(){T.value&&(G.value=!0,J&&clearTimeout(J),J=setTimeout(()=>{G.value=!1,J=null},140))}xt(()=>{J&&clearTimeout(J)});async function Ft([e,o],{animated:t=!0}={}){const r=Number(e),i=Number(o);if(!Number.isFinite(r)||!Number.isFinite(i))return;const n=X([r,i]),a=n==null?void 0:n[0],c=n==null?void 0:n[1];if(!Number.isFinite(a)||!Number.isFinite(c))return;const d=at({x:a,y:c}),s=Q.value?{...Q.value}:{x:0,y:0,width:E.value.width,height:E.value.height},w={x:d.x-s.width/2,y:d.y-s.height/2,width:s.width,height:s.height};if(!t){Q.value=w;return}const h={...s},_={...w},u=250;let m=null;const y=v=>{m==null&&(m=v);const A=Math.min((v-m)/u,1);Q.value={x:h.x+(_.x-h.x)*A,y:h.y+(_.y-h.y)*A,width:h.width+(_.width-h.width)*A,height:h.height+(_.height-h.height)*A},A<1&&requestAnimationFrame(y)};requestAnimationFrame(y)}return Co(async()=>{Ae(),await le(),requestAnimationFrame(()=>{var e,o;D.value||(ce(),((e=l.value.map.center)!=null&&e[0]||(o=l.value.map.center)!=null&&o[1])&&Ft(l.value.map.center,{animated:!1}))})}),xt(()=>{be()}),zt({getImage:go,generatePdf:Ye,generateImage:qe,generateSvg:wt,toggleTooltip:Ct,toggleAnnotator:Pe,toggleFullscreen:ze,zoomIn:Fe,zoomOut:Ne,resetZoom:lt,focusLocation:Ft}),(e,o)=>(g(),$("div",{class:_t("vue-data-ui-component vue-ui-geo ".concat(z.value?"vue-data-ui-wrapper-fullscreen":""," ").concat(q.value?"vue-ui-geo-responsive":""," ").concat(G.value?"vue-ui-geo-interacting":"")),ref_key:"geoChart",ref:R,id:"map_".concat(j.value),dir:"auto",style:ve({fontFamily:l.value.style.fontFamily,width:"100%",backgroundColor:l.value.style.chart.backgroundColor,height:q.value?"".concat(Z.value,"px"):void 0})},[Ve.value?(g(),$("div",{key:0,ref_key:"noTitle",ref:Se,class:"vue-data-ui-no-title-space",style:"height:36px; width: 100%;background:transparent"},null,512)):B("",!0),l.value.style.chart.title.text?(g(),$("div",{key:1,ref_key:"chartTitle",ref:Te,style:"width:100%;background:transparent;padding-bottom:12px"},[(g(),U(Go,{key:"title_".concat(Re.value),config:{title:{cy:"geo-title",...l.value.style.chart.title},subtitle:{cy:"geo-subtitle",...l.value.style.chart.title.subtitle}}},null,8,["config"]))],512)):B("",!0),l.value.userOptions.buttons.annotator?(g(),U(b(Gt),{key:2,svgRef:b(ae),backgroundColor:l.value.style.chart.backgroundColor,color:l.value.style.chart.color,active:oe.value,onClose:Pe},{"annotator-action-close":x(()=>[k(e.$slots,"annotator-action-close",{},void 0,!0)]),"annotator-action-color":x(({color:t})=>[k(e.$slots,"annotator-action-color",P(I({color:t})),void 0,!0)]),"annotator-action-draw":x(({mode:t})=>[k(e.$slots,"annotator-action-draw",P(I({mode:t})),void 0,!0)]),"annotator-action-undo":x(({disabled:t})=>[k(e.$slots,"annotator-action-undo",P(I({disabled:t})),void 0,!0)]),"annotator-action-redo":x(({disabled:t})=>[k(e.$slots,"annotator-action-redo",P(I({disabled:t})),void 0,!0)]),"annotator-action-delete":x(({disabled:t})=>[k(e.$slots,"annotator-action-delete",P(I({disabled:t})),void 0,!0)]),_:3},8,["svgRef","backgroundColor","color","active"])):B("",!0),l.value.userOptions.show&&(b(Le)||b(Ze))?(g(),U(b(Lt),{ref:"userOptionsRef",key:"user_options_".concat(he.value),backgroundColor:l.value.style.chart.backgroundColor,color:l.value.style.chart.color,isPrinting:b(Ge),isImaging:b(We),uid:j.value,hasXls:!1,hasTable:!1,hasTooltip:l.value.userOptions.buttons.tooltip&&l.value.style.chart.tooltip.show,hasPdf:l.value.userOptions.buttons.pdf,hasImg:l.value.userOptions.buttons.img,hasSvg:l.value.userOptions.buttons.svg,hasFullscreen:l.value.userOptions.buttons.fullscreen,hasAnnotator:l.value.userOptions.buttons.annotator,hasZoom:l.value.userOptions.buttons.zoom,isZoom:T.value,isFullscreen:z.value,isTooltip:K.value.showTooltip,titles:{...l.value.userOptions.buttonTitles},chartElement:R.value,position:l.value.userOptions.position,isAnnotation:oe.value,callbacks:l.value.userOptions.callbacks,printScale:l.value.userOptions.print.scale,onToggleFullscreen:ze,onGeneratePdf:b(Ye),onGenerateImage:b(qe),onGenerateSvg:wt,onToggleTooltip:Ct,onToggleAnnotator:Pe,onToggleZoom:so,style:ve({visibility:b(Le)?b(Ze)?"visible":"hidden":"visible"})},wo({_:2},[e.$slots.menuIcon?{name:"menuIcon",fn:x(({isOpen:t,color:r})=>[k(e.$slots,"menuIcon",P(I({isOpen:t,color:r})),void 0,!0)]),key:"0"}:void 0,e.$slots.optionTooltip?{name:"optionTooltip",fn:x(()=>[k(e.$slots,"optionTooltip",{},void 0,!0)]),key:"1"}:void 0,e.$slots.optionPdf?{name:"optionPdf",fn:x(()=>[k(e.$slots,"optionPdf",{},void 0,!0)]),key:"2"}:void 0,e.$slots.optionImg?{name:"optionImg",fn:x(()=>[k(e.$slots,"optionImg",{},void 0,!0)]),key:"3"}:void 0,e.$slots.optionSvg?{name:"optionSvg",fn:x(()=>[k(e.$slots,"optionSvg",{},void 0,!0)]),key:"4"}:void 0,e.$slots.optionFullscreen?{name:"optionFullscreen",fn:x(({toggleFullscreen:t,isFullscreen:r})=>[k(e.$slots,"optionFullscreen",P(I({toggleFullscreen:t,isFullscreen:r})),void 0,!0)]),key:"5"}:void 0,e.$slots.optionAnnotator?{name:"optionAnnotator",fn:x(({toggleAnnotator:t,isAnnotator:r})=>[k(e.$slots,"optionAnnotator",P(I({toggleAnnotator:t,isAnnotator:r})),void 0,!0)]),key:"6"}:void 0,e.$slots.optionZoom?{name:"optionZoom",fn:x(({toggleZoom:t,isZoomLocked:r})=>[k(e.$slots,"optionZoom",P(I({toggleZoom:t,isZoomLocked:r})),void 0,!0)]),key:"7"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasTooltip","hasPdf","hasImg","hasSvg","hasFullscreen","hasAnnotator","hasZoom","isZoom","isFullscreen","isTooltip","titles","chartElement","position","isAnnotation","callbacks","printScale","onGeneratePdf","onGenerateImage","style"])):B("",!0),l.value.style.chart.controls.position==="top"&&l.value.style.chart.controls.show&&!b(ge)?(g(),U(Pt,{key:4,ref_key:"zoomControlsTop",ref:je,config:l.value,scale:b(it),isFullscreen:z.value,onZoomIn:Fe,onZoomOut:Ne,onResetZoom:ct},null,8,["config","scale","isFullscreen"])):B("",!0),(g(),$("svg",{ref_key:"svgRef",ref:ae,xmlns:b(Eo),viewBox:ut.value,preserveAspectRatio:"xMidYMid meet",style:ve({display:"block",width:"100%",height:q.value?"".concat(Z.value,"px"):"auto",background:l.value.style.chart.backgroundColor,touchAction:T.value?"none":"auto",cursor:T.value?G.value?"grabbing":"grab":"default"}),id:"vue-ui-geo_".concat(j.value),onPointerdown:bo,onPointerup:Ie,onPointercancel:Ie,onPointerleave:Ie,onWheel:Ao},[$t(b(Wt)),ie("g",{transform:rt.value.transform,style:ve({pointerEvents:G.value?"none":"auto"})},[ie("g",null,[(g(!0),$(fe,null,me(Qe.value,t=>(g(),$("path",{class:"vue-ui-geo-territory",key:t.uid,d:t.path,fill:O.value===t.uid?S.value.hover.fill:S.value.fill,stroke:O.value===t.uid?S.value.hover.stroke:S.value.stroke,"stroke-width":O.value===t.uid?S.value.hover.strokeWidth:S.value.strokeWidth,"vector-effect":"non-scaling-stroke",onMouseenter:r=>mt(t),onMouseleave:r=>pt(t),onClick:r=>ht(t)},null,40,Vo))),128))]),ie("g",null,[(g(!0),$(fe,null,me(et.value,t=>(g(),$("path",{class:"vue-ui-geo-territory",key:t.uid,d:t.path,fill:"none",stroke:O.value===t.uid?S.value.hover.stroke:S.value.stroke,"stroke-width":O.value===t.uid?S.value.hover.strokeWidth:S.value.strokeWidth,"vector-effect":"non-scaling-stroke",onMouseenter:r=>mt(t),onMouseleave:r=>pt(t),onClick:r=>ht(t)},null,40,Xo))),128))]),ie("g",null,[(g(!0),$(fe,null,me(tt.value,t=>(g(),$("circle",{key:t.uid,cx:t.x,cy:t.y,r:t.radius,fill:t.fill,stroke:t.stroke,"stroke-width":t.strokeWidth,"vector-effect":"non-scaling-stroke",onMouseenter:r=>vo(t),onMouseleave:fo},null,40,Jo))),128))]),(g(!0),$(fe,null,me(vt.value,t=>(g(),$("g",{key:t.uid},[k(e.$slots,"datapoint",Fo({ref_for:!0},{point:t,onPointEnter:yt,onPointLeave:gt,onPointClick:At,highlighted:ee.value===t.uid}),()=>[ie("circle",{class:_t({"vue-ui-geo-point":!0,"vue-ui-geo-point-with-event":bt.value}),cx:t.x,cy:t.y,r:ee.value===t.uid?t.radius*t.hoverRadiusRatio:t.radius,fill:t.fill,stroke:kt.value.stroke,"stroke-width":kt.value.strokeWidth,"vector-effect":"non-scaling-stroke",onMouseenter:r=>yt(t),onMouseleave:r=>gt(t),onClick:r=>At(t)},null,42,Uo)],!0),l.value.style.chart.points.labels.show?(g(),$("text",{key:0,class:"vue-ui-geo-point-label",x:t.x,y:t.y+(ee.value===t.uid?t.radius*t.hoverRadiusRatio:t.radius)+l.value.style.chart.points.labels.offsetY+1*l.value.style.chart.points.labels.fontSizeRatio,"text-anchor":"middle",fill:l.value.style.chart.points.labels.color,"font-size":1*l.value.style.chart.points.labels.fontSizeRatio},No(t.name),9,Ho)):B("",!0)]))),128)),k(e.$slots,"svg",{svg:{drawingArea:ut.value,data:{areaPaths:Qe.value,linePaths:et.value,geoJsonPoints:tt.value,projectedPoints:vt.value}}},void 0,!0)],12,qo)],44,Yo)),e.$slots.watermark?(g(),$("div",Ko,[k(e.$slots,"watermark",P(I({isPrinting:b(Ge)||b(We)})),void 0,!0)])):B("",!0),l.value.style.chart.controls.position==="bottom"&&l.value.style.chart.controls.show&&!b(ge)?(g(),U(Pt,{key:6,ref_key:"zoomControlsBottom",ref:De,config:l.value,scale:b(it),isFullscreen:z.value,onZoomIn:Fe,onZoomOut:Ne,onResetZoom:ct},null,8,["config","scale","isFullscreen"])):B("",!0),$t(b(Zt),{show:K.value.showTooltip&&xe.value,backgroundColor:l.value.style.chart.tooltip.backgroundColor,color:l.value.style.chart.tooltip.color,fontSize:l.value.style.chart.tooltip.fontSize,borderRadius:l.value.style.chart.tooltip.borderRadius,borderColor:l.value.style.chart.tooltip.borderColor,borderWidth:l.value.style.chart.tooltip.borderWidth,backgroundOpacity:l.value.style.chart.tooltip.backgroundOpacity,position:l.value.style.chart.tooltip.position,offsetY:l.value.style.chart.tooltip.offsetY,parent:R.value,content:$e.value,isCustom:L.value,isFullscreen:z.value,smooth:l.value.style.chart.tooltip.smooth,backdropFilter:l.value.style.chart.tooltip.backdropFilter,smoothForce:l.value.style.chart.tooltip.smoothForce,smoothSnapThreshold:l.value.style.chart.tooltip.smoothSnapThreshold},{"tooltip-before":x(()=>[k(e.$slots,"tooltip-before",P(I({...ne.value})),void 0,!0)]),"tooltip-after":x(()=>[k(e.$slots,"tooltip-after",P(I({...ne.value})),void 0,!0)]),_:3},8,["show","backgroundColor","color","fontSize","borderRadius","borderColor","borderWidth","backgroundOpacity","position","offsetY","parent","content","isCustom","isFullscreen","smooth","backdropFilter","smoothForce","smoothSnapThreshold"]),e.$slots.source?(g(),$("div",{key:7,ref_key:"source",ref:Be,dir:"auto"},[k(e.$slots,"source",{},void 0,!0)],512)):B("",!0),b(ge)?(g(),U(To,{key:8})):B("",!0)],14,Wo))}},er=xo(Qo,[["__scopeId","data-v-fcd9019f"]]),br=Object.freeze(Object.defineProperty({__proto__:null,default:er},Symbol.toStringTag,{value:"Module"}));export{gr as a,br as b,er as v};
