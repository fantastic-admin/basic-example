
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{e as x,ac as T,E as N,J as $,K as Q,c as a,o,A as p,f as u,t as g,O as s,u as r,F as X,R as Z,r as Y,m as j,Y as ee}from"./index-CJB5jCfL.js";import{s as te,J as le,E as ae,A as oe,L as b,F as w,d as S,X as K,K as O}from"./vue-data-ui-8Gmf-dDN.js";import{s as ie,i as se}from"./useNestedProp-DaR1dBmj-yWXLkJlG.js";import"./alert-I_0TAljB.js";const re={key:0,class:"vue-ui-rating-title",style:{width:"100%"}},ue={key:0,style:{position:"relative"}},ne={key:0,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},ve={key:1,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"}},ye=["src","height","width"],de=["xmlns","height","width"],pe=["id"],ge=["stop-color"],fe=["stop-color"],ce=["points","fill","stroke","stroke-width"],me=["src","alt","height","width","id"],he=["xmlns","viewBox","height","id"],xe=["id"],$e=["stop-color"],be=["stop-color"],we=["points","fill","stroke"],ke=["xmlns","height"],ze=["onClick","onMouseenter","onFocus","onKeyup"],Se=["onMouseenter","onFocus"],_e={__name:"vue-ui-rating",props:{config:{type:Object,default(){return{}}},dataset:{type:Object,default(){return{}}}},emits:["rate"],setup(E,{expose:R,emit:G}){const{vue_ui_rating:J}=ie(),n=E,m=x(le()),_=x(!1),v=x(void 0),h=x(void 0),k=x([]),D=T();N(()=>{D["chart-background"]&&console.warn("VueUiRating does not support the #chart-background slot.")});const L=G,e=$({get:()=>C(),set:l=>l});function C(){return se({userConfig:n.config,defaultConfig:J})}Q(()=>n.config,l=>{e.value=C(),A()},{deep:!0});const U=$(()=>typeof n.dataset.rating=="object"&&!Array.isArray(n.dataset.rating)?P(n.dataset.rating):n.dataset.rating),I=$(()=>typeof n.dataset.rating=="object"&&!Array.isArray(n.dataset.rating)),d=x(U.value),V=$(()=>e.value.type==="image"),f=$(()=>e.value.readonly);function P(l){let i=0,t=0;for(const y in l){const H=parseInt(y),B=l[y];i+=H*B,t+=B}if(t===0)return 0;const c=i/t;return Math.min(e.value.to,Math.max(e.value.from,c))}N(()=>{A()});function A(){(!Object.hasOwn(n.dataset,"rating")||ae(n.dataset))&&oe({componentName:"VueUiRating",type:"datasetAttribute",property:"rating"}),k.value=[];for(let l=e.value.from;l<=e.value.to;l+=1)k.value.push(l)}function z(l,i=!1){return l>v.value||f.value?i?e.value.style.image.inactiveOpacity:e.value.style.star.inactiveColor:i?1:e.value.style.star.useGradient?"url(#star_gradient_under_".concat(m.value,")"):e.value.style.star.activeColor}function M(l,i=!1){const t=d.value-l,c=i?1:100;switch(!0){case t<=0:return .001;case t>1:return 1*c;default:return t*c}}function F(l){f.value||(d.value=l,L("rate",l))}function W(){return d.value}function q(l=!0){f.value=l}return R({getData:W,toggleReadonly:q}),(l,i)=>(o(),a("div",{style:s("background:".concat(e.value.style.backgroundColor,";font-family:").concat(e.value.style.fontFamily,";width:100%")),class:"vue-data-ui-component vue-ui-rating",onMouseover:i[4]||(i[4]=t=>_.value=!0),onMouseleave:i[5]||(i[5]=t=>{_.value=!1,v.value=void 0})},[e.value.style.title.text?(o(),a("div",re,[u("div",{style:s("color:".concat(e.value.style.title.color,";font-weight:").concat(e.value.style.title.bold?"bold":"normal",";text-align:").concat(e.value.style.title.textAlign,";margin-bottom:").concat(e.value.style.title.offsetY,"px;font-size:").concat(e.value.style.title.fontSize,"px"))},g(e.value.style.title.text),5),e.value.style.title.subtitle.text?(o(),a("div",{key:0,style:s("color:".concat(e.value.style.title.subtitle.color,";font-size:").concat(e.value.style.title.subtitle.fontSize,"px;text-align:").concat(e.value.style.title.textAlign,";margin-bottom:").concat(e.value.style.title.subtitle.offsetY,"px;font-weight:").concat(e.value.style.title.subtitle.bold?"bold":"normal"))},g(e.value.style.title.subtitle.text),5)):p("",!0)])):p("",!0),e.value.style.rating.show&&e.value.style.rating.position==="top"?(o(),a("div",{key:1,style:s("width:100%;text-align:center;margin-bottom:".concat(e.value.style.rating.offsetY,"px;font-size:").concat(e.value.style.rating.fontSize,"px;font-weight:").concat(e.value.style.rating.bold?"bold":"normal",";margin-left:").concat(e.value.style.rating.offsetX,"px"))},g(r(b)(e.value.style.rating.formatter,d.value,r(w)({v:d.value,r:e.value.style.rating.roundingValue}),e.value)),5)):p("",!0),u("div",{class:"vue-ui-rating-wrapper",style:s("height:".concat(e.value.style.itemSize,"px;width:100%;display:flex;align-items:center;justify-content:center"))},[e.value.style.rating.show&&e.value.style.rating.position==="left"?(o(),a("div",{key:0,style:s("width:fit-content;text-align:center;margin-bottom:".concat(e.value.style.rating.offsetY,"px;font-size:").concat(e.value.style.rating.fontSize,"px;font-weight:").concat(e.value.style.rating.bold?"bold":"normal",";padding-right:").concat(e.value.style.rating.offsetX,"px"))},g(r(b)(e.value.style.rating.formatter,d.value,r(w)({v:d.value,r:e.value.style.rating.roundingValue}),e.value)),5)):p("",!0),(o(!0),a(X,null,Z(k.value,(t,c)=>(o(),a("div",{class:"vue-ui-rating-unit-container",style:s("position:relative;height:".concat(e.value.style.itemSize,"px;width:").concat(e.value.style.itemSize,"px"))},[l.$slots["layer-under"]||l.$slots["layer-above"]?(o(),a("div",ue,[l.$slots["layer-under"]?(o(),a("div",ne,[Y(l.$slots,"layer-under",j({ref_for:!0},{value:t,size:e.value.style.itemSize,hoveredValue:v.value,focusedValue:h.value}),void 0,!0)])):p("",!0),l.$slots["layer-above"]?(o(),a("div",ve,[Y(l.$slots,"layer-above",j({ref_for:!0},{value:t,size:e.value.style.itemSize,hoveredValue:v.value,focusedValue:h.value}),void 0,!0)])):p("",!0)])):(o(),a(X,{key:1},[V.value?(o(),a("img",{key:0,src:e.value.style.image.src,height:e.value.style.itemSize,width:e.value.style.itemSize,class:"vue-ui-rating-unit",style:s("position:absolute;top:0;left:0;opacity:".concat(isNaN(v.value)?e.value.style.image.inactiveOpacity:z(t,!0)))},null,12,ye)):(o(),a("svg",{key:1,xmlns:r(S),viewBox:"0 0 100 100",height:e.value.style.itemSize,width:e.value.style.itemSize,class:"vue-ui-rating-unit"},[u("defs",null,[u("radialGradient",{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",id:"star_gradient_under_".concat(m.value)},[u("stop",{offset:"0%","stop-color":"".concat(r(K)(e.value.style.star.activeColor,.05))},null,8,ge),u("stop",{offset:"100%","stop-color":e.value.style.star.activeColor},null,8,fe)],8,pe)]),u("polygon",{points:r(O)({plot:{x:50,y:50},radius:30,apexes:e.value.style.star.apexes}),fill:isNaN(v.value)?e.value.style.star.inactiveColor:z(t),stroke:e.value.style.star.borderColor?e.value.style.star.borderColor:v.value?z(t):e.value.style.star.inactiveColor,"stroke-width":e.value.style.star.borderWidth,"stroke-linecap":"round","stroke-linejoin":"round"},null,8,ce)],8,de)),V.value?(o(),a("img",{key:2,src:e.value.style.image.src,alt:"".concat(e.value.style.image.alt," ").concat(t),height:e.value.style.itemSize,width:e.value.style.itemSize,id:"active_".concat(m.value,"_").concat(t),class:"vue-ui-rating-unit",style:s("position:absolute;top:0;left:0;clip:rect(0px,".concat(M(c,!0)*e.value.style.itemSize,"px,").concat(e.value.style.itemSize,"px,0px"))},null,12,me)):(o(),a("svg",{key:3,xmlns:r(S),viewBox:"0 0 ".concat(M(c)," 100"),height:e.value.style.itemSize,class:"vue-ui-rating-unit",id:"active_".concat(m.value,"_").concat(t),style:{position:"absolute",top:"0",left:"0"}},[u("defs",null,[u("radialGradient",{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",id:"star_gradient_over_".concat(m.value)},[u("stop",{offset:"0%","stop-color":"".concat(r(K)(e.value.style.star.activeColor,.05))},null,8,$e),u("stop",{offset:"100%","stop-color":e.value.style.star.activeColor},null,8,be)],8,xe)]),u("polygon",{points:r(O)({plot:{x:50,y:50},radius:30,apexes:e.value.style.star.apexes}),fill:e.value.style.star.useGradient?"url(#star_gradient_over_".concat(m.value,")"):e.value.style.star.activeColor,stroke:e.value.style.star.activeColor},null,8,we)],8,he))],64)),(o(),a("svg",{xmlns:r(S),viewBox:"0 0 100 100",height:e.value.style.itemSize,class:"vue-ui-rating-unit",style:s("position:absolute;top:0;left:0;".concat(f.value?"":"cursor:pointer"))},[f.value?p("",!0):(o(),a("rect",{key:0,class:"vue-ui-rating-mouse-trap",x:0,y:0,width:100,height:100,fill:"transparent",onClick:y=>F(t),onMouseenter:y=>v.value=t,onMouseleave:i[0]||(i[0]=y=>v.value=void 0),onFocus:y=>h.value=t,onBlur:i[1]||(i[1]=y=>h.value=void 0),tabindex:"0",onKeyup:ee(y=>F(t),["enter"])},null,40,ze)),f.value?(o(),a("rect",{key:1,class:"vue-ui-rating-mouse-trap",x:0,y:0,width:100,height:100,fill:"transparent",onMouseenter:y=>v.value=t,onMouseleave:i[2]||(i[2]=y=>v.value=void 0),onFocus:y=>h.value=t,onBlur:i[3]||(i[3]=y=>h.value=void 0)},null,40,Se)):p("",!0)],12,ke)),e.value.style.tooltip.show&&I.value&&f.value?(o(),a("div",{key:2,class:"vue-ui-rating-tooltip",style:s("border:1px solid ".concat(e.value.style.tooltip.borderColor,";position:absolute;top:").concat(-48+e.value.style.tooltip.offsetY,"px;left:50%;transform:translateX(-50%);width:fit-content;text-align:center;background:").concat(e.value.style.tooltip.backgroundColor,";display:").concat(v.value===t?"block":"none",";padding:2px 12px;border-radius:").concat(e.value.style.tooltip.borderRadius,"px;box-shadow:").concat(e.value.style.tooltip.boxShadow))},[u("div",{style:s("width:100%;display:flex;flex-direction:row;gap:6px;position:relative;text-align:center;color:".concat(e.value.style.tooltip.color))},[u("span",{style:s("font-size:".concat(e.value.style.tooltip.fontSize,"px"))},g(t)+":",5),u("span",{style:s("font-weight:".concat(e.value.style.tooltip.bold?"bold":"normal",";font-size:").concat(e.value.style.tooltip.fontSize,"px"))},g(r(b)(e.value.style.tooltip.formatter,n.dataset.rating[t],r(w)({v:n.dataset.rating[t],r:e.value.style.tooltip.roundingValue}),e.value)),5),u("div",{style:s("font-family:Arial !important;position:absolute;top:calc(100% - 4px);left:50%;transform:translateX(-50%);color:".concat(e.value.style.tooltip.borderColor))}," ▼ ",4)],4)],4)):p("",!0)],4))),256)),e.value.style.rating.show&&e.value.style.rating.position==="right"?(o(),a("div",{key:1,style:s("width:fit-content;text-align:center;margin-bottom:".concat(e.value.style.rating.offsetY,"px;font-size:").concat(e.value.style.rating.fontSize,"px;font-weight:").concat(e.value.style.rating.bold?"bold":"normal",";padding-left:").concat(e.value.style.rating.offsetX,"px"))},g(r(b)(e.value.style.rating.formatter,d.value,r(w)({v:d.value,r:e.value.style.rating.roundingValue}),e.value)),5)):p("",!0)],4),e.value.style.rating.show&&e.value.style.rating.position==="bottom"?(o(),a("div",{key:2,style:s("width:100%;text-align:center;margin-top:".concat(e.value.style.rating.offsetY,"px;font-size:").concat(e.value.style.rating.fontSize,"px;font-weight:").concat(e.value.style.rating.bold?"bold":"normal",";margin-left:").concat(e.value.style.rating.offsetX,"px"))},g(r(b)(e.value.style.rating.formatter,d.value,r(w)({v:d.value,r:e.value.style.rating.roundingValue}),e.value)),5)):p("",!0)],36))}},Fe=te(_e,[["__scopeId","data-v-cca0c364"]]);export{Fe as default};
