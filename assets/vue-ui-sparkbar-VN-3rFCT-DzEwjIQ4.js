
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-q2MkeeNq.js","./index-DXZKKOp8.js","./index-B7kifsnL.css"])))=>i.map(i=>d[i]);
import{ab as Z,E as O,e as h,a7 as ee,J as w,K as E,a9 as te,c as u,o as s,r as $,A as c,z as ae,j as le,m as L,O as p,f as v,t as f,F as T,R as oe,u as o,g as re,b_ as se,c1 as ie}from"./index-DXZKKOp8.js";import{Q as ue,A as ne,v as ve,m as A,C as de,g as pe,p as V,b as ce,a as ye,I as C,f as _,y as fe,O as I,G as ge}from"./vue-data-ui-BN9YfUec.js";import{t as me,o as R}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{J as be}from"./themes-AUNCOb2G-RAhReTPj.js";import{S as he,T as xe}from"./BaseScanner-BgWxam9d-B19ueoDW.js";import"./alert-l5XlVwCh.js";const ke=["onClick","onMouseenter","onMouseleave"],we={key:1},Ae=["xmlns","viewBox"],Ce=["id"],_e=["stop-color"],Se=["stop-color"],$e=["height","width","fill","rx"],Ie=["height","width","fill","rx"],ze=["height","width","fill","rx"],De={key:2,ref:"source",dir:"auto"},Te={__name:"vue-ui-sparkbar",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}},backgroundOpacity:{type:Number,default:null}},emits:["selectDatapoint"],setup(M,{emit:P}){const j=se(()=>ie(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_sparkbar:G}=me(),y=M,W=Z();O(()=>{W["chart-background"]&&console.warn("VueUiSparkbar does not support the #chart-background slot.")});const z=h(ue()),e=h(S()),{loading:x,FINAL_DATASET:d}=he({...ee(y),FINAL_CONFIG:e,prepareConfig:S,skeletonDataset:[{name:"_",value:21,target:25,color:"#808080"},{name:"_",value:13,target:25,color:"#ADADAD"},{name:"_",value:8,target:25,color:"#DBDBDB"}],skeletonConfig:ne({defaultConfig:e.value,userConfig:{style:{backgroundColor:"#99999930",animation:{show:!1},layout:{independant:!0},gutter:{backgroundColor:"#6A6A6A",opacity:50},bar:{gradient:{underlayerColor:"#6A6A6A"}}}}})}),D=w(()=>!!e.value.debug);function S(){const t=R({userConfig:y.config,defaultConfig:G});return t.theme?{...R({userConfig:be.vue_ui_sparkbar[t.theme]||y.config,defaultConfig:t}),customPalette:ve[t.theme]||A}:t}E(()=>y.config,t=>{e.value=S()},{deep:!0});const U=w(()=>de(e.value.customPalette)),g=h(d.value.map(t=>({...t,value:e.value.style.animation.show?0:t.value||0,formatter:t.formatter||null}))),B=h(null);O(async()=>{pe(y.dataset)&&V({componentName:"VueUiSparkbar",type:"dataset",debug:D.value}),F()});function F(){if(e.value.style.animation.show){let t=function(){b+=r/l,b<r?(g.value=g.value.map((i,k)=>({...i,value:i.value+=a[k]})),B.value=requestAnimationFrame(t)):g.value=d.value.map(i=>({...i,value:i.value||0,formatter:i.formatter||null}))};const l=e.value.style.animation.animationFrames,a=d.value.map((i,k)=>i.value/l),r=d.value.map(i=>i.value||0).reduce((i,k)=>i+k,0);let b=0;t()}}E(()=>d.value,async t=>{cancelAnimationFrame(B.value),g.value=d.value.map(l=>({...l,value:e.value.style.animation.show?0:l.value||0,formatter:l.formatter||null})),te(F)},{deep:!0});const n=h({width:500,height:16}),q=w(()=>Math.max(...d.value.map(t=>t.value))),J=w(()=>(d.value.forEach((t,l)=>{ce({datasetObject:t,requiredAttributes:["name","value"]}).forEach(a=>{V({componentName:"VueUiSparkbar",type:"datasetSerieAttribute",property:a,index:l,debug:D.value})})}),g.value.map((t,l)=>({...t,value:t.value||0,color:ye(t.color)||U.value[l]||A[l]||A[l%A.length]}))));function Q(t){return t/q.value}function N(t){return e.value.style.layout.independant?t.target?t.value/t.target:e.value.style.layout.percentage?t.value>100?1:t.value/100:e.value.style.layout.target===0?1:t.value/e.value.style.layout.target:Q(t.value)}function m(t){return e.value.style.layout.independant&&t.target||e.value.style.layout.target}const K=P;function H(t,l){K("selectDatapoint",{datapoint:t,index:l}),e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:t,seriesIndex:l})}function X(t,l){e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:t,seriesIndex:l})}function Y(t,l){e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:t,seriesIndex:l})}return(t,l)=>(s(),u("div",{class:"vue-data-ui-component vue-ui-sparkbar",style:p({width:"100%",position:"relative",fontFamily:e.value.style.fontFamily,background:y.backgroundOpacity!==null?o(I)(e.value.style.backgroundColor,y.backgroundOpacity):e.value.style.backgroundColor})},[t.$slots.title?$(t.$slots,"title",le(L({key:0},{title:{...t.title,title:e.value.style.title.text,subtitle:e.value.style.title.subtitle.text}}))):c("",!0),!t.$slots.title&&e.value.style.title.text?(s(),u("div",{key:1,class:"vue-ui-sparkbar-title-container",style:p({background:e.value.style.title.backgroundColor,margin:e.value.style.title.margin,textAlign:e.value.style.title.textAlign})},[v("div",{class:"vue-ui-sparkbar-title",style:p({fontSize:e.value.style.title.fontSize+"px",color:e.value.style.title.color,fontWeight:e.value.style.title.bold?"bold":"normal"})},f(e.value.style.title.text),5),e.value.style.title.subtitle.text?(s(),u("div",{key:0,class:"vue-ui-sparkbar-subtitle",style:p({fontSize:e.value.style.title.subtitle.fontSize+"px",color:e.value.style.title.subtitle.color,fontWeight:e.value.style.title.subtitle.bold?"bold":"normal"})},f(e.value.style.title.subtitle.text),5)):c("",!0)],4)):c("",!0),(s(!0),u(T,null,oe(J.value,(a,r)=>(s(),u("div",{style:p("display:flex !important;".concat(["left","right"].includes(e.value.style.labels.name.position)?"flex-direction: ".concat(e.value.style.labels.name.position==="right"?"row-reverse":"row"," !important"):"flex-direction:column !important",";gap:").concat(e.value.style.gap,"px !important;align-items:center;").concat(o(d).length>0&&r!==o(d).length-1?"margin-bottom:6px":"")),onClick:b=>H(a,r),onMouseenter:b=>X(a,r),onMouseleave:b=>Y(a,r)},[o(x)?c("",!0):$(t.$slots,"data-label",L({key:0,ref_for:!0},{bar:{...a,target:m(a),valueLabel:o(C)(a.formatter,a.value,o(_)({p:a.prefix||"",v:a.value,s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r}),targetLabel:o(C)(a.formatter,m(a),o(_)({p:a.prefix||"",v:m(a),s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})}})),!t.$slots["data-label"]||o(x)?(s(),u("div",{key:1,style:p({display:"flex",justifyContent:["right","top-right"].includes(e.value.style.labels.name.position)?"flex-end":["top-center"].includes(e.value.style.labels.name.position)?"center":"flex-start",alignItems:"center",width:e.value.style.labels.name.width,color:e.value.style.labels.name.color,fontSize:e.value.style.labels.fontSize+"px",fontWeight:e.value.style.labels.name.bold?"bold":"normal",flexWrap:"wrap"})},[o(x)?(s(),u("div",{key:0,class:"vue-ui-sparkbar-skeleton-name",style:p({width:"60px",height:e.value.style.labels.fontSize+"px",borderRadius:e.value.style.labels.fontSize/4+"px",display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:"5px"})},[v("div",{style:p({height:"100%",width:"40px",borderRadius:e.value.style.labels.fontSize/4+"px",backgroundColor:"#6A6A6A80"})},null,4),v("div",{style:p({height:"100%",width:"15px",borderRadius:e.value.style.labels.fontSize/4+"px",backgroundColor:"#6A6A6A80"})},null,4)],4)):(s(),u(T,{key:1},[v("span",null,f(a.name),1),e.value.style.labels.value.show?(s(),u("span",{key:0,style:p("font-weight:".concat(e.value.style.labels.value.bold?"bold":"normal"))},": "+f(o(C)(a.formatter,a.value,o(_)({p:a.prefix||"",v:a.value,s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})),5)):c("",!0),e.value.style.layout.showTargetValue?(s(),u("span",we,f(" "+e.value.style.layout.targetValueText)+" "+f(o(C)(a.formatter,m(a),o(_)({p:a.prefix||"",v:m(a),s:a.suffix||"",r:a.rounding||0}),{datapoint:a,seriesIndex:r})),1)):c("",!0)],64))],4)):c("",!0),(s(),u("svg",{xmlns:o(fe),viewBox:"0 0 ".concat(n.value.width," ").concat(n.value.height),width:"100%"},[re(o(j)),v("defs",null,[v("linearGradient",{x1:"0%",y1:"0%",x2:"100%",y2:"0%",id:"sparkbar_gradient_".concat(r,"_").concat(z.value)},[v("stop",{offset:"0%","stop-color":o(I)(o(ge)(a.color,.03),100-e.value.style.bar.gradient.intensity)},null,8,_e),v("stop",{offset:"100%","stop-color":a.color},null,8,Se)],8,Ce)]),v("rect",{height:n.value.height,width:n.value.width,x:0,y:0,fill:o(I)(e.value.style.gutter.backgroundColor,e.value.style.gutter.opacity),rx:n.value.height/2},null,8,$e),v("rect",{height:n.value.height,width:n.value.width*N(a),x:0,y:0,fill:e.value.style.bar.gradient.underlayerColor,rx:n.value.height/2},null,8,Ie),v("rect",{height:n.value.height,width:n.value.width*N(a),x:0,y:0,fill:e.value.style.bar.gradient.show?"url(#sparkbar_gradient_".concat(r,"_").concat(z.value,")"):a.color,rx:n.value.height/2},null,8,ze)],8,Ae))],44,ke))),256)),t.$slots.source?(s(),u("div",De,[$(t.$slots,"source")],512)):c("",!0),o(x)?(s(),ae(xe,{key:3})):c("",!0)],4))}};export{Te as default};
