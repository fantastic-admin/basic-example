
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-q2MkeeNq.js","./index-DXZKKOp8.js","./index-B7kifsnL.css"])))=>i.map(i=>d[i]);
import{c4 as ge,e as c,a7 as be,E as H,J as C,K as j,c as s,a9 as q,o as a,A as d,z as X,O as S,f,l as me,t as g,u as r,g as xe,b_ as ke,r as Y,F as y,R as p,n as J,c1 as Ce}from"./index-DXZKKOp8.js";import{s as Ae,Q as we,A as _e,g as $e,p as P,b as ze,O as b,I as Q,f as U,y as Le,G as R}from"./vue-data-ui-BN9YfUec.js";import{E as Se,M as Me}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{t as Fe,o as K}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{S as Ee,T as Ie}from"./BaseScanner-BgWxam9d-B19ueoDW.js";import{k as Ne}from"./useFitSvgText-2crs6Fv5-CJteLozF.js";import{o as Oe}from"./useChartAccessibility-9icAAmYg-BcUQIUvr.js";import{w as Re}from"./Shape-CNXKB8O0-BJGuTKHC.js";import{J as We}from"./themes-AUNCOb2G-RAhReTPj.js";import"./alert-l5XlVwCh.js";const Ve={key:0},Te={key:1},Be=["xmlns","viewBox"],De=["width","height"],Ge=["id"],He=["stop-color"],je=["stop-color"],qe=["id"],Xe=["stop-color"],Ye=["stop-color"],Je=["id"],Pe=["stop-color"],Qe=["stop-color"],Ue=["height","width","fill","x","stroke","stroke-width","rx","stroke-dasharray"],Ke={key:1},Ze=["x","y","height","width","fill","stroke","stroke-width","rx"],et={key:2},tt=["x","y","font-size","font-weight","fill"],lt=["x","y","font-size","fill"],at=["x","y","font-size","fill"],st=["height","width","x","onMouseover","onMouseleave","onClick"],ot={__name:"vue-ui-sparkhistogram",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectDatapoint"],setup(Z,{emit:ee}){ge(l=>({v693dff61:ve.value}));const te=ke(()=>Ce(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_sparkhistogram:le}=Fe(),m=Z,x=c(we()),W=c(null),V=c(null),M=c(null),A=c(null),_=c(null),e=c(I()),{loading:T,FINAL_DATASET:w}=Ee({...be(m),FINAL_CONFIG:e,prepareConfig:I,skeletonDataset:[{value:1,intensity:.2,color:"#CACACA"},{value:2,intensity:.3,color:"#CACACA"},{value:3,intensity:.5,color:"#CACACA"},{value:5,intensity:.7,color:"#CACACA"},{value:8,intensity:.9,color:"#CACACA"},{value:13,intensity:.95,color:"#CACACA"},{value:21,intensity:1,color:"#CACACA"},{value:13,intensity:.95,color:"#CACACA"},{value:8,intensity:.9,color:"#CACACA"},{value:5,intensity:.7,color:"#CACACA"},{value:3,intensity:.5,color:"#CACACA"},{value:2,intensity:.3,color:"#CACACA"},{value:1,intensity:.2,color:"#CACACA"}],skeletonConfig:_e({defaultConfig:e.value,userConfig:{style:{animation:{show:!1},backgroundColor:"#99999930"}}})}),F=c(e.value.style.layout.width),E=c(e.value.style.layout.height),{svgRef:B}=Oe({config:e.value.style.title});function I(){const l=K({userConfig:m.config,defaultConfig:le});return l.theme?{...K({userConfig:We.vue_ui_sparkhistogram[l.theme]||m.config,defaultConfig:l})}:l}H(()=>{G()});const D=C(()=>!!e.value.debug);function G(){if($e(m.dataset)?P({componentName:"VueUiSparkHistogram",type:"dataset",debug:D.value}):m.dataset.forEach((l,o)=>{ze({datasetObject:l,requiredAttributes:["value"]}).forEach(t=>{P({componentName:"VueUiSparkHistogram",type:"datasetSerieAttribute",property:t,index:o,debug:D.value})})}),e.value.responsive){const l=Se(()=>{const{width:o,height:t}=Me({chart:M.value,title:e.value.style.title.text?V.value:null,source:W.value});requestAnimationFrame(()=>{F.value=Math.max(10,o),E.value=Math.max(10,t-12)})});A.value&&(_.value&&A.value.unobserve(_.value),A.value.disconnect()),A.value=new ResizeObserver(l),_.value=M.value.parentNode,A.value.observe(_.value)}}j(()=>m.config,l=>{e.value=I(),G()},{deep:!0});const v=C(()=>{const l=E.value,o=F.value,t=e.value.style.layout.padding.top,i=l-e.value.style.layout.padding.bottom,h=e.value.style.layout.padding.left,$=o-e.value.style.layout.padding.right,z=t+(l-t-e.value.style.layout.padding.bottom)/2,N=l-e.value.style.layout.padding.top-e.value.style.layout.padding.bottom,L=o-e.value.style.layout.padding.left-e.value.style.layout.padding.right;return{bottom:i,centerY:z,drawingHeight:N,drawingWidth:L,height:l,left:h,right:$,top:t,width:o}}),ae=C(()=>Math.max(...w.value.map(l=>Math.abs(l.value||0))));function se(l){return Math.abs(l)/ae.value}const u=C(()=>w.value.map((l,o)=>{const t=se(l.value||0),i=v.value.drawingHeight*t,h=v.value.drawingWidth/w.value.length,$=h*(e.value.style.bars.gap/100),z=h-$,N=v.value.centerY-i/2,L=v.value.left+($/2+o*h),ye=v.value.left+o*h,O=typeof l.intensity>"u"?100:Math.round(l.intensity*100),ce=l.color?l.color:l.value>=0?b(e.value.style.bars.colors.positive,O):b(e.value.style.bars.colors.negative,O),pe=l.color?l.color:l.value>=0?e.value.style.bars.colors.positive:e.value.style.bars.colors.negative,he=l.color?"url(#gradient_datapoint_".concat(o,"_").concat(x.value,")"):l.value>=0?"url(#gradient_positive_".concat(o,"_").concat(x.value,")"):"url(#gradient_negative_".concat(o,"_").concat(x.value,")"),fe=L+z/2;return{...l,color:ce,gradient:he,height:i,intensity:O,proportion:t,stroke:pe,textAnchor:fe,trapX:ye,unitWidth:h,width:z,x:L,y:N}}));function oe(l,o){return Q(e.value.style.labels.value.formatter,l.value,U({p:e.value.style.labels.value.prefix,v:l.value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:l,seriesIndex:o})}const n=c(null),ie=ee;function ue(l,o){ie("selectDatapoint",{datapoint:l,index:o}),e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:l,seriesIndex:o})}function re(l,o){n.value=o,e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:l,seriesIndex:o})}function ne(l,o){n.value=null,e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:l,seriesIndex:o})}const ve=C(()=>"".concat(e.value.style.animation.speedMs,"ms")),de=C(()=>v.value.drawingWidth/w.value.length*.9),{fitText:k}=Ne({svgRef:B,unitWidth:de});return H(async()=>{await q(),k(".vue-ui-sparkhistogram-top-label",e.value.style.labels.value.minFontSize),k(".vue-ui-sparkhistogram-bottom-label",e.value.style.labels.valueLabel.minFontSize),k(".vue-ui-sparkhistogram-time-label",e.value.style.labels.timeLabel.minFontSize)}),j([F,E,()=>w.value],async()=>{await q(),k(".vue-ui-sparkhistogram-top-label",e.value.style.labels.value.minFontSize),k(".vue-ui-sparkhistogram-bottom-label",e.value.style.labels.valueLabel.minFontSize),k(".vue-ui-sparkhistogram-time-label",e.value.style.labels.timeLabel.minFontSize)}),(l,o)=>(a(),s("div",{class:"vue-data-ui-component vue-ui-spark-histogram",ref_key:"histogramChart",ref:M,style:S("width:100%;background:".concat(e.value.style.backgroundColor,";font-family:").concat(e.value.style.fontFamily)),onMouseleave:o[0]||(o[0]=t=>n.value=null)},[e.value.style.title.text?(a(),s("div",{key:0,ref_key:"chartTitle",ref:V,style:S("width:calc(100% - 12px);background:transparent;margin:0 auto;margin:".concat(e.value.style.title.margin,";padding: 0 6px;text-align:").concat(e.value.style.title.textAlign))},[f("div",{style:S("font-size:".concat(e.value.style.title.fontSize,"px;color:").concat(e.value.style.title.color,";font-weight:").concat(e.value.style.title.bold?"bold":"normal"))},[me(g(e.value.style.title.text)+" ",1),n.value!==null?(a(),s("span",Ve,"- "+g(u.value[n.value].timeLabel||"")+" "+g(r(Q)(e.value.style.labels.value.formatter,u.value[n.value].value,r(U)({p:e.value.style.labels.value.prefix,v:u.value[n.value].value,s:e.value.style.labels.value.suffix,r:e.value.style.labels.value.rounding}),{datapoint:u.value[n.value],seriesIndex:n.value})),1)):d("",!0),![void 0,null].includes(n.value)&&![null,void 0].includes(u.value[n.value].valueLabel)?(a(),s("span",Te,"("+g(u.value[n.value].valueLabel||0)+")",1)):d("",!0)],4),e.value.style.title.subtitle.text?(a(),s("div",{key:0,style:S("font-size:".concat(e.value.style.title.subtitle.fontSize,"px;color:").concat(e.value.style.title.subtitle.color,";font-weight:").concat(e.value.style.title.subtitle.bold?"bold":"normal"))},g(e.value.style.title.subtitle.text),5)):d("",!0)],4)):d("",!0),(a(),s("svg",{ref_key:"svgRef",ref:B,xmlns:r(Le),viewBox:"0 0 ".concat(v.value.width," ").concat(v.value.height),style:{overflow:"visible"}},[xe(r(te)),l.$slots["chart-background"]?(a(),s("foreignObject",{key:0,x:0,y:0,width:v.value.width,height:v.value.height,style:{pointerEvents:"none"}},[Y(l.$slots,"chart-background",{},void 0,!0)],8,De)):d("",!0),f("defs",null,[(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("radialGradient",{id:"gradient_positive_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(b)(r(R)(e.value.style.bars.colors.positive,.05),t.intensity)},null,8,He),f("stop",{offset:"100%","stop-color":r(b)(e.value.style.bars.colors.positive,t.intensity)},null,8,je)],8,Ge))),256)),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("radialGradient",{id:"gradient_negative_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(b)(r(R)(e.value.style.bars.colors.negative,.05),t.intensity)},null,8,Xe),f("stop",{offset:"100%","stop-color":r(b)(e.value.style.bars.colors.negative,t.intensity)},null,8,Ye)],8,qe))),256)),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("radialGradient",{id:"gradient_datapoint_".concat(i,"_").concat(x.value),cy:"50%",cx:"50%",r:"50%",fx:"50%",fy:"50%"},[f("stop",{offset:"0%","stop-color":r(b)(r(R)(t.color,.05),t.intensity)},null,8,Pe),f("stop",{offset:"100%","stop-color":r(b)(t.color,t.intensity)},null,8,Qe)],8,Je))),256))]),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("g",null,[n.value!==null&&n.value===i?(a(),s("rect",{key:0,height:v.value.height,width:t.unitWidth,fill:e.value.style.selector.fill,x:t.trapX,y:0,stroke:e.value.style.selector.stroke,"stroke-width":e.value.style.selector.strokeWidth,rx:e.value.style.selector.borderRadius,"stroke-dasharray":e.value.style.selector.strokeDasharray},null,8,Ue)):d("",!0)]))),256)),!e.value.style.bars.shape||e.value.style.bars.shape==="square"?(a(),s("g",Ke,[(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("rect",{x:t.x,y:t.y,height:t.height,width:t.width,fill:e.value.style.bars.colors.gradient.show?t.gradient:t.color,stroke:t.stroke,"stroke-width":e.value.style.bars.strokeWidth,rx:"".concat(e.value.style.bars.borderRadius*t.proportion/12,"%"),class:J({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,10,Ze))),256))])):(a(),s("g",et,[(a(!0),s(y,null,p(u.value,(t,i)=>(a(),X(Re,{plot:{x:t.x+t.width/2,y:t.y+t.height/2},color:e.value.style.bars.colors.gradient.show?t.gradient:t.color,shape:e.value.style.bars.shape,radius:Math.min(t.height*.4,t.width*.4),class:J({"vue-ui-sparkhistogram-shape":e.value.style.animation.show})},null,8,["plot","color","shape","radius","class"]))),256))])),r(T)?d("",!0):(a(),s(y,{key:3},[(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("text",{class:"vue-ui-sparkhistogram-top-label","text-anchor":"middle",x:t.textAnchor,y:t.y-e.value.style.labels.value.fontSize/3+e.value.style.labels.value.offsetY,"font-size":e.value.style.labels.value.fontSize,"font-weight":e.value.style.labels.value.bold?"bold":"normal",fill:e.value.style.labels.value.color},g(oe(t,i)),9,tt))),256)),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("g",null,[t.valueLabel?(a(),s("text",{key:0,class:"vue-ui-sparkhistogram-bottom-label",x:t.textAnchor,y:t.y+t.height+e.value.style.labels.valueLabel.fontSize,"font-size":e.value.style.labels.valueLabel.fontSize,"text-anchor":"middle",fill:e.value.style.labels.valueLabel.color},g(t.valueLabel),9,lt)):d("",!0)]))),256)),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("g",null,[t.timeLabel?(a(),s("text",{key:0,class:"vue-ui-sparkhistogram-time-label",x:t.textAnchor,y:v.value.height-e.value.style.labels.timeLabel.fontSize/2,"font-size":e.value.style.labels.timeLabel.fontSize,fill:e.value.style.labels.timeLabel.color,"text-anchor":"middle"},g(t.timeLabel),9,at)):d("",!0)]))),256))],64)),(a(!0),s(y,null,p(u.value,(t,i)=>(a(),s("g",null,[f("rect",{height:v.value.height,width:t.unitWidth,fill:"transparent",x:t.trapX,y:0,onMouseover:h=>re(t,i),onMouseleave:h=>ne(t,i),onClick:()=>ue(t,i)},null,40,st)]))),256))],8,Be)),l.$slots.source?(a(),s("div",{key:1,ref_key:"source",ref:W,dir:"auto"},[Y(l.$slots,"source",{},void 0,!0)],512)):d("",!0),r(T)?(a(),X(Ie,{key:2})):d("",!0)],36))}},ft=Ae(ot,[["__scopeId","data-v-df871618"]]);export{ft as default};
