
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-q2MkeeNq.js","./index-DXZKKOp8.js","./index-B7kifsnL.css","./SparkTooltip-BEewz-_Q-nUoGjo4C.js","./vue-data-ui-BN9YfUec.js","./alert-l5XlVwCh.js","./vue-data-ui-D1HaM8UR.css"])))=>i.map(i=>d[i]);
import{J as y,e as p,a7 as De,K,au as pe,E as Ge,av as fe,c,o as r,r as z,A as h,z as ge,j as me,k as be,O as R,f,t as S,u as s,g as Be,b_ as xe,F as Q,R as ee,h as Pe,l as je,a9 as Ye,c1 as ke}from"./index-DXZKKOp8.js";import{s as qe,Q as Xe,A as Ue,L as we,a8 as ae,g as _e,p as Ae,b as Ze,G as E,a9 as He,aa as Je,y as Ke,O,z as Le,_ as Qe,ab as $e,I as le,f as te,ac as ea}from"./vue-data-ui-BN9YfUec.js";import{t as aa,o as Ne}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{E as la,M as ta}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{o as ua}from"./useChartAccessibility-9icAAmYg-BcUQIUvr.js";import{S as oa,T as sa}from"./BaseScanner-BgWxam9d-B19ueoDW.js";import{J as ra}from"./themes-AUNCOb2G-RAhReTPj.js";import{F as ia}from"./useTimeLabels-BGFjWgrv-C_AB8TRS.js";import"./alert-l5XlVwCh.js";const va=["id"],na=["xmlns","viewBox"],da=["width","height"],ca=["id"],ya=["stop-color"],ha=["stop-color"],pa=["id"],fa=["stop-color"],ga=["stop-color"],ma=["id"],ba=["stop-color"],xa=["stop-color"],ka={key:1},wa=["d","fill"],_a=["d","fill"],Aa=["d","stroke","stroke-width"],La=["d","stroke","stroke-width"],$a=["x","y","width","height","fill","rx"],Na=["x1","x2","y1","y2","stroke","stroke-width","stroke-dasharray"],Ma=["x1","x2","y1","y2","stroke","stroke-dasharray","stroke-width"],Ca=["cx","cy","r","fill","stroke","stroke-width"],Ia=["x","y","font-size","font-weight","fill"],Va=["x","y","height","width","onMouseenter","onMouseleave","onClick"],za={__name:"vue-ui-sparkline",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}},showInfo:{type:Boolean,default:!0},selectedIndex:{type:Number,default:void 0},heightRatio:{type:Number,default:1},forcedPadding:{type:Number,default:30}},emits:["hoverIndex","selectDatapoint"],setup(N,{emit:Me}){const Ce=xe(()=>ke(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([0,1,2]),import.meta.url)),Ie=xe(()=>ke(()=>import("./SparkTooltip-BEewz-_Q-nUoGjo4C.js"),__vite__mapDeps([3,4,1,2,5,6]),import.meta.url)),{vue_ui_sparkline:Ve}=aa(),i=N,ue=y(()=>Array.isArray(i.dataset)&&i.dataset.length>0),g=p(Xe()),T=p(null),oe=p(null),se=p(null),e=p(B());function ze(a){return ea(a).map(l=>({period:"-",value:l}))}const{loading:D,FINAL_DATASET:M,manualLoading:G}=oa({...De(i),FINAL_CONFIG:e,prepareConfig:B,callback:()=>{Promise.resolve().then(async()=>{await Ye(),X()})},skeletonDataset:ze(12),skeletonConfig:Ue({defaultConfig:e.value,userConfig:{style:{backgroundColor:"#99999930",scaleMin:0,scaleMax:null,animation:{show:!1},line:{color:"#AAAAAA"},bar:{color:"#AAAAAA"},area:{color:"#CACACA"},zeroLine:{color:"#6A6A6A"},dataLabel:{show:!1},tooltip:{show:!1}}}})}),{svgRef:re}=ua({config:e.value.style.title});function B(){const a=Ne({userConfig:i.config,defaultConfig:Ve});let l={};return a.theme?l={...Ne({userConfig:ra.vue_ui_sparkline[a.theme]||i.config,defaultConfig:a})}:l=a,i.config&&we(i.config,"style.scaleMin")?l.style.scaleMin=i.config.style.scaleMin:l.style.scaleMin=null,i.config&&we(i.config,"style.scaleMax")?l.style.scaleMax=i.config.style.scaleMax:l.style.scaleMax=null,l}const w=y(()=>ae({data:M.value,threshold:e.value.downsample.threshold}));K(()=>i.config,a=>{D.value||(e.value=B()),ve(),u.value.chartWidth=e.value.style.chartWidth},{deep:!0}),K(()=>i.dataset,a=>{Array.isArray(a)&&a.length>0&&(G.value=!1),m.value=ae({data:M.value.map(l=>({...l,value:[void 0].includes(l.value)?null:l.value})),threshold:e.value.downsample.threshold})},{deep:!0});const m=p(We());function We(){return ae({data:M.value.map(a=>e.value.style.animation.show&&M.value.length>1?{...a,value:null}:{...a,value:[void 0].includes(a.value)?null:a.value}),threshold:e.value.downsample.threshold})}const b=pe(null),_=pe(null),P=p(!1),C=p(0),j=p([]),Y=p(""),q=y(()=>{var t,o;const a=(w.value||[]).map(k=>"".concat(k.period,"::").concat(Number.isFinite(k.value)?k.value:0)).join("|"),l=((o=(t=e.value)==null?void 0:t.style)==null?void 0:o.animation)||{};return"".concat(a,"#").concat(!!l.show,"#").concat(l.animationFrames||0)});function W(){C.value&&(cancelAnimationFrame(C.value),C.value=0),j.value.forEach(a=>clearTimeout(a)),j.value=[],P.value=!1}function X(){var ye,he;const a=((he=(ye=e.value)==null?void 0:ye.style)==null?void 0:he.animation)||{},l=w.value||[],t=q.value;if(t&&t===Y.value&&(P.value||m.value.length===l.length))return;if(W(),!a.show||D.value||l.length<=1){m.value=l,Y.value=t;return}P.value=!0,Y.value=t,m.value=[];const o=Math.max(1,Number(a.animationFrames)||1),k=Math.max(1,Math.floor(o/l.length));let J=0;const ce=()=>{if(t!==q.value){W();return}if(J<l.length){m.value.push(l[J]);const Te=setTimeout(()=>{C.value=requestAnimationFrame(ce)},k);j.value.push(Te),J+=1}else m.value=l,W()};C.value=requestAnimationFrame(ce)}K(q,()=>{X()}),Ge(()=>{ve(),X()}),fe(()=>{W()});const ie=y(()=>!!e.value.debug);function ve(){if(_e(i.dataset)?(Ae({componentName:"VueUiSparkline",type:"dataset",debug:ie.value}),G.value=!0):i.dataset.forEach((a,l)=>{Ze({datasetObject:a,requiredAttributes:["period","value"]}).forEach(t=>{Ae({componentName:"VueUiSparkline",type:"datasetSerieAttribute",property:t,index:l,debug:ie.value})})}),_e(i.dataset)||(G.value=e.value.loading),e.value.responsive){const a=la(()=>{const{width:l,height:t}=ta({chart:T.value,title:e.value.style.title.show&&i.showInfo?oe.value:null,source:se.value});requestAnimationFrame(()=>{u.value.width=l,u.value.height=t,u.value.chartWidth=e.value.style.chartWidth/500*l,u.value.padding=i.forcedPadding/500*l})});b.value&&(_.value&&b.value.unobserve(_.value),b.value.disconnect()),b.value=new ResizeObserver(a),_.value=T.value.parentNode,b.value.observe(_.value)}}fe(()=>{b.value&&(_.value&&b.value.unobserve(_.value),b.value.disconnect())});const u=p({height:80*i.heightRatio,width:500,chartWidth:e.value.style.chartWidth,padding:i.forcedPadding}),U=Me,v=y(()=>{const{top:a,right:l,bottom:t,left:o}=e.value.style.padding;return{top:a,left:o,right:u.value.width-l,bottom:u.value.height-t,start:i.showInfo&&e.value.style.dataLabel.show&&e.value.style.dataLabel.position==="left"?u.value.width-u.value.chartWidth+o:u.value.padding+o,width:i.showInfo&&e.value.style.dataLabel.show?u.value.chartWidth-o-l:u.value.width-u.value.padding-o-l,height:u.value.height-a-t}}),Z=y(()=>[null,void 0].includes(e.value.style.scaleMin)?Math.min(...m.value.map(a=>isNaN(a.value)||[void 0,null,"NaN",NaN,1/0,-1/0].includes(a.value)?0:a.value||0)):e.value.style.scaleMin),Fe=y(()=>[null,void 0].includes(e.value.style.scaleMax)?Math.max(...m.value.map(a=>isNaN(a.value)||[void 0,null,"NaN",NaN,1/0,-1/0].includes(a.value)?0:a.value||0)):e.value.style.scaleMax),I=y(()=>{const a=Z.value>=0?0:Z.value;return Math.abs(a)}),ne=y(()=>Fe.value+I.value),A=y(()=>v.value.bottom-v.value.height*H(I.value));function H(a){return isNaN(a/ne.value)?0:a/ne.value}const L=y(()=>w.value.length-1||1),F=y(()=>ia({values:w.value.map(a=>a.period),maxDatapoints:w.value.length,formatter:e.value.style.dataLabel.datetimeFormatter,start:0,end:w.value.length})),d=y(()=>m.value.map((a,l)=>{const t=isNaN(a.value)||[void 0,null,"NaN",NaN,1/0,-1/0].includes(a.value)?0:a.value||0,o=v.value.width/L.value;return{absoluteValue:t,period:F.value&&F.value[l]&&F.value[l].text?F.value[l].text:a.period,plotValue:t+I.value,toMax:H(t+I.value),x:v.value.start+l*o,y:v.value.bottom-v.value.height*H(t+I.value),id:"plot_".concat(g.value,"_").concat(l),color:V.value?e.value.style.bar.color:e.value.style.area.useGradient?E(e.value.style.line.color,.05*(1-l/L.value)):e.value.style.line.color,width:o}})),Re=y(()=>{const a={x:d.value[0].x||0,y:(u.value.height||0)-6},l={x:d.value[d.value.length-1].x||0,y:(u.value.height||0)-6},t=[];return d.value.forEach(o=>{t.push("".concat(o.x||0,",").concat(o.y||0," "))}),[a.x,a.y,...t,l.x,l.y].toString()}),n=p(void 0),$=p(void 0);function Se(a,l){e.value.events.datapointEnter&&e.value.events.datapointEnter({datapoint:a,seriesIndex:l}),n.value=a,$.value||($.value=a),U("hoverIndex",{index:l})}function Ee(a,l){e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:a,seriesIndex:l}),$.value=n.value,n.value=void 0,U("hoverIndex",{index:void 0})}const x=y(()=>{if(ue.value){const a=d.value.map(t=>t.absoluteValue),l=a.reduce((t,o)=>t+o,0);return{latest:d.value[d.value.length-1]?d.value[d.value.length-1].absoluteValue:0,sum:l,average:l/d.value.length,median:Je(a),trend:He(d.value.map(({x:t,y:o,absoluteValue:k})=>({x:t,y:o,value:k}))).trend}}else return{latest:null,sum:null,average:null,median:null,trend:null}}),de=y(()=>ue.value?e.value.style.dataLabel.valueType==="latest"?x.value.latest:e.value.style.dataLabel.valueType==="sum"?x.value.sum:e.value.style.dataLabel.valueType==="average"?x.value.average:0:0),V=y(()=>e.value.type&&e.value.type==="bar");function Oe(a,l){e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:a,seriesIndex:l}),U("selectDatapoint",{datapoint:a,index:l})}return(a,l)=>(r(),c("div",{ref_key:"sparklineChart",ref:T,class:"vue-data-ui-component vue-ui-sparkline",id:g.value,style:R("width:100%;font-family:".concat(e.value.style.fontFamily,";"))},[z(a.$slots,"before",me(be({selected:n.value,latest:x.value.latest,sum:x.value.sum,average:x.value.average,median:x.value.median,trend:x.value.trend})),void 0,!0),e.value.style.title.show&&N.showInfo?(r(),c("div",{key:0,ref_key:"chartTitle",ref:oe,class:"vue-ui-sparkline-title",style:R("display:flex;align-items:center;width:100%;color:".concat(e.value.style.title.color,";background:").concat(e.value.style.backgroundColor,";justify-content:").concat(e.value.style.title.textAlign==="left"?"flex-start":e.value.style.title.textAlign==="right"?"flex-end":"center",";height:").concat(e.value.style.title.fontSize*2,"px;font-size:").concat(e.value.style.title.fontSize,"px;font-weight:").concat(e.value.style.title.bold?"bold":"normal",";"))},[f("span",{style:R("padding:".concat(e.value.style.title.textAlign==="left"?"0 0 0 12px":e.value.style.title.textAlign==="right"?"0 12px 0 0":"0"))},S(n.value?n.value.period:e.value.style.title.text),5)],4)):h("",!0),(r(),c("svg",{ref_key:"svgRef",ref:re,xmlns:s(Ke),viewBox:"0 0 ".concat(u.value.width," ").concat(u.value.height),style:R("background:".concat(e.value.style.backgroundColor,";overflow:visible")),onMouseleave:l[0]||(l[0]=t=>$.value=void 0)},[Be(s(Ce)),a.$slots["chart-background"]?(r(),c("foreignObject",{key:0,x:0,y:0,width:u.value.width<=0?10:u.value.width,height:u.value.height<=0?10:u.value.height,style:{pointerEvents:"none"}},[z(a.$slots,"chart-background",{},void 0,!0)],8,da)):h("",!0),f("defs",null,[f("linearGradient",{x1:"0%",y1:"0%",x2:"100%",y2:"0%",id:"sparkline_gradient_".concat(g.value)},[f("stop",{offset:"0%","stop-color":s(O)(s(E)(e.value.style.area.color,.05),e.value.style.area.opacity)},null,8,ya),f("stop",{offset:"100%","stop-color":s(O)(e.value.style.area.color,e.value.style.area.opacity)},null,8,ha)],8,ca),f("linearGradient",{x2:"0%",y2:"100%",id:"sparkline_bar_gradient_pos_".concat(g.value)},[f("stop",{offset:"0%","stop-color":e.value.style.bar.color},null,8,fa),f("stop",{offset:"100%","stop-color":s(E)(e.value.style.bar.color,.05)},null,8,ga)],8,pa),f("linearGradient",{x2:"0%",y2:"100%",id:"sparkline_bar_gradient_neg_".concat(g.value)},[f("stop",{offset:"0%","stop-color":s(E)(e.value.style.bar.color,.05)},null,8,ba),f("stop",{offset:"100%","stop-color":e.value.style.bar.color},null,8,xa)],8,ma)]),e.value.style.area.show&&!V.value&&d.value[0]&&d.value.length>1?(r(),c("g",ka,[e.value.style.line.smooth?(r(),c("path",{key:0,d:"M ".concat(d.value[0].x,",").concat(v.value.bottom," ").concat(s(Le)(d.value)," L ").concat(d.value.at(-1).x,",").concat(v.value.bottom," Z"),fill:e.value.style.area.useGradient?"url(#sparkline_gradient_".concat(g.value,")"):s(O)(e.value.style.area.color,e.value.style.area.opacity)},null,8,wa)):(r(),c("path",{key:1,d:"M".concat(Re.value,"Z"),fill:e.value.style.area.useGradient?"url(#sparkline_gradient_".concat(g.value,")"):s(O)(e.value.style.area.color,e.value.style.area.opacity)},null,8,_a))])):h("",!0),e.value.style.line.smooth&&!V.value?(r(),c("path",{key:2,d:"M ".concat(s(Le)(d.value)||"0,0"),stroke:e.value.style.line.color,fill:"none","stroke-width":e.value.style.line.strokeWidth,"stroke-linecap":"round"},null,8,Aa)):h("",!0),!e.value.style.line.smooth&&!V.value?(r(),c("path",{key:3,d:"M ".concat(s(Qe)(d.value)||"0,0"),stroke:e.value.style.line.color,fill:"none","stroke-width":e.value.style.line.strokeWidth,"stroke-linecap":"round"},null,8,La)):h("",!0),(r(!0),c(Q,null,ee(d.value,(t,o)=>(r(),c("g",null,[V.value?(r(),c("rect",{key:0,x:t.x-t.width/2,y:isNaN(t.absoluteValue>0?t.y:A.value)?0:t.absoluteValue>0?t.y:A.value,width:t.width,height:isNaN(Math.abs(t.y-A.value))?0:Math.abs(t.y-A.value),fill:t.absoluteValue>0?"url(#sparkline_bar_gradient_pos_".concat(g.value,")"):"url(#sparkline_bar_gradient_neg_".concat(g.value,")"),rx:e.value.style.bar.borderRadius},null,8,$a)):h("",!0),e.value.style.verticalIndicator.show&&(n.value&&t.id===n.value.id||N.selectedIndex===o)?(r(),c("line",{key:1,x1:t.x,x2:t.x,y1:v.value.top-6,y2:v.value.bottom,stroke:e.value.style.verticalIndicator.color||t.color,"stroke-width":e.value.style.verticalIndicator.strokeWidth,"stroke-linecap":"round","stroke-dasharray":e.value.style.verticalIndicator.strokeDasharray||0},null,8,Na)):h("",!0)]))),256)),Z.value<0?(r(),c("line",{key:4,x1:v.value.start,x2:v.value.start+v.value.width,y1:s($e)(A.value,v.value.bottom),y2:s($e)(A.value,v.value.bottom),stroke:e.value.style.zeroLine.color,"stroke-dasharray":e.value.style.zeroLine.strokeWidth*2,"stroke-width":e.value.style.zeroLine.strokeWidth,"stroke-linecap":"round"},null,8,Ma)):h("",!0),e.value.style.plot.show?(r(!0),c(Q,{key:5},ee(d.value,(t,o)=>(r(),c("g",null,[n.value&&t.id===n.value.id||N.selectedIndex===o||s(M).length===1?(r(),c("circle",{key:0,cx:t.x,cy:t.y,r:e.value.style.plot.radius,fill:t.color,stroke:e.value.style.plot.stroke,"stroke-width":e.value.style.plot.strokeWidth},null,8,Ca)):h("",!0)]))),256)):h("",!0),N.showInfo&&e.value.style.dataLabel.show?(r(),c("text",{key:6,x:e.value.style.dataLabel.position==="left"?12+e.value.style.dataLabel.offsetX:v.value.width+12+e.value.style.dataLabel.offsetX,y:u.value.height/2+e.value.style.dataLabel.fontSize/2.5+e.value.style.dataLabel.offsetY,"font-size":e.value.style.dataLabel.fontSize,"font-weight":e.value.style.dataLabel.bold?"bold":"normal",fill:e.value.style.dataLabel.color},S(n.value?s(le)(e.value.style.dataLabel.formatter,n.value.absoluteValue,s(te)({p:e.value.style.dataLabel.prefix,v:n.value.absoluteValue,s:e.value.style.dataLabel.suffix,r:e.value.style.dataLabel.roundingValue}),{datapoint:n.value}):s(le)(e.value.style.dataLabel.formatter,de.value,s(te)({p:e.value.style.dataLabel.prefix,v:de.value,s:e.value.style.dataLabel.suffix,r:e.value.style.dataLabel.roundingValue}))),9,Ia)):h("",!0),(r(!0),c(Q,null,ee(d.value,(t,o)=>(r(),c("rect",{x:t.x-(v.value.width/(L.value+1)>u.value.padding?u.value.padding:v.value.width/(L.value+1))/2,y:v.value.top-6,height:v.value.height+6,width:v.value.width/(L.value+1)>u.value.padding?u.value.padding:v.value.width/(L.value+1),fill:"transparent",onMouseenter:()=>Se(t,o),onMouseleave:()=>Ee(t,o),onClick:()=>Oe(t,o)},null,40,Va))),256)),z(a.$slots,"svg",{svg:u.value},void 0,!0)],44,na)),n.value&&e.value.style.tooltip.show?(r(),ge(s(Ie),{key:1,x:n.value.x,y:n.value.y,prevX:$.value.x,prevY:$.value.y,offsetY:e.value.style.plot.radius*3+e.value.style.tooltip.offsetY,svgRef:s(re),background:e.value.style.tooltip.backgroundColor,color:e.value.style.tooltip.color,fontSize:e.value.style.tooltip.fontSize,borderWidth:e.value.style.tooltip.borderWidth,borderColor:e.value.style.tooltip.borderColor,borderRadius:e.value.style.tooltip.borderRadius,backgroundOpacity:e.value.style.tooltip.backgroundOpacity},{default:Pe(()=>[z(a.$slots,"tooltip",me(be({...n.value})),()=>[je(S(n.value.period)+": "+S(s(le)(e.value.style.dataLabel.formatter,n.value.absoluteValue,s(te)({p:e.value.style.dataLabel.prefix,v:n.value.absoluteValue,s:e.value.style.dataLabel.suffix,r:e.value.style.dataLabel.roundingValue}),{datapoint:n.value})),1)],!0)]),_:3},8,["x","y","prevX","prevY","offsetY","svgRef","background","color","fontSize","borderWidth","borderColor","borderRadius","backgroundOpacity"])):h("",!0),a.$slots.source?(r(),c("div",{key:2,ref_key:"source",ref:se,dir:"auto"},[z(a.$slots,"source",{},void 0,!0)],512)):h("",!0),s(D)?(r(),ge(sa,{key:3})):h("",!0)],12,va))}},Ba=qe(za,[["__scopeId","data-v-cc569021"]]);export{Ba as default};
