
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./PackageVersion-TgflyMpU-q2MkeeNq.js","./index-DXZKKOp8.js","./index-B7kifsnL.css"])))=>i.map(i=>d[i]);
import{e as v,au as q,E as ae,J as H,av as le,K as se,c as o,o as s,A as h,f as M,O as f,z as re,u as K,g as _,b_ as oe,r as j,m as Z,j as V,k as G,t as ue,c1 as ie}from"./index-DXZKKOp8.js";import{t as ne,o as ce}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{s as ve,Q as he,y as pe,u as S,R as J}from"./vue-data-ui-BN9YfUec.js";import{E as de,M as we}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{o as fe}from"./useChartAccessibility-9icAAmYg-BcUQIUvr.js";import ke from"./Title-BWp-37K_-BMUMQpSO.js";import"./alert-l5XlVwCh.js";class me{constructor(A,B,I,E=!0,T=!0){this.interval=B,this.elapsed=0,this.isPaused=!1;const m="\n            let interval;\n            let elapsed = 0;\n            let paused = false;\n            let startTime;\n            let tickInterval;\n\n            onmessage = function(e) {\n                const { action, data } = e.data;\n\n                switch(action) {\n                    case 'start':\n                        startTime = Date.now();\n                        tickInterval = data.interval;\n                        elapsed = 0;\n                        paused = false;\n                        interval = setInterval(() => {\n                            elapsed += tickInterval;\n                            postMessage({ elapsed, timestamp: Date.now() });\n                        }, tickInterval);\n                        break;\n                    \n                    case 'pause':\n                        paused = true;\n                        clearInterval(interval);\n                        elapsed = Date.now() - startTime;\n                        break;\n\n                    case 'resume':\n                        if (paused) {\n                            startTime = Date.now() - elapsed;\n                            interval = setInterval(() => {\n                                elapsed += tickInterval;\n                                postMessage({ elapsed, timestamp: Date.now() });\n                            }, tickInterval);\n                        }\n                        paused = false;\n                        break;\n\n                    case 'stop':\n                        clearInterval(interval);\n                        elapsed = 0;\n                        postMessage({ elapsed });\n                        break;\n\n                    case 'reset':\n                        elapsed = 0;\n                        clearInterval(interval);\n                        postMessage({ elapsed });\n                        break;\n\n                    case 'lap':\n                        postMessage({\n                            elapsed,\n                            timestamp: Date.now(),\n                            action: 'lap'\n                        });\n                        break;\n\n                    default:\n                        break;\n                }\n            };\n        ",C=new Blob([m],{type:"application/javascript"}),z=URL.createObjectURL(C),i=new Worker(z);function c(r){let p=Math.floor(r/1e3),k=Math.floor(r%1e3/10),g=Math.floor(p/3600),e=Math.floor(p%3600/60),R=p%60,d="";return T&&(d+=String(g).padStart(2,"0")+":"),d+=String(e).padStart(2,"0")+":",d+=String(R).padStart(2,"0"),E&&(d+="."+String(k).padStart(2,"0")),d}this.start=()=>{this.isPaused=!1,i.postMessage({action:"start",data:{interval:this.interval}})},this.pause=()=>{this.isPaused?this.resume():(this.isPaused=!0,i.postMessage({action:"pause"}))},this.resume=()=>{this.isPaused&&(i.postMessage({action:"resume"}),this.isPaused=!1)},this.stop=()=>{i.postMessage({action:"stop"}),this.isPaused=!1},this.reset=()=>{i.postMessage({action:"reset"}),this.elapsed=0,this.isPaused=!1},this.restart=()=>{this.stop(),this.start()},this.lap=()=>new Promise(r=>{i.postMessage({action:"lap"});const p=k=>{const{elapsed:g,timestamp:e,action:R}=k.data;if(R==="lap"){const d=c(g);r({timestamp:e||0,elapsed:g,formatted:d})}};i.addEventListener("message",p,{once:!0})}),i.onmessage=r=>{const{elapsed:p,timestamp:k}=r.data;this.elapsed=p,A({timestamp:k||0,elapsed:this.elapsed,formatted:c(this.elapsed)})},i.onerror=r=>{I&&I(r)}}}const ge=["xmlns","viewBox"],ye=["width","height"],be={key:1},xe=["id"],$e=["stop-color"],Me=["stop-color"],_e=["cx","cy","r","fill","stroke","stroke-width"],Ce=["d","stroke","stroke-width"],Re=["r","fill","stroke","stroke-width"],Pe=["r","fill","stroke","stroke-width"],Se=["x","y"],Ie=["x","y","font-size","fill","font-weight"],Te={key:0,class:"vue-ui-timer-controls"},ze=["title"],De=["title"],He=["title"],je=["title"],Ae=["title"],Be={__name:"vue-ui-timer",props:{config:{type:Object,default(){return{}}}},emits:["start","pause","reset","restart","lap"],setup(Q,{expose:A,emit:B}){const I=oe(()=>ie(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([0,1,2]),import.meta.url)),{vue_ui_timer:E}=ne(),T=Q,m=B,C=v(null),z=v(null),i=v(null),c=q(null),r=q(null),p=v(he()),k=v(0);ae(()=>{g()});function g(){if(e.value.responsive){const a=de(()=>{const{width:u,height:n}=we({chart:C.value,title:e.value.style.title.text?z.value:null,legend:i.value});requestAnimationFrame(()=>{t.value.width=u,t.value.height=n,e.value.responsiveProportionalSizing?(t.value.tracker.core=J({relator:Math.min(u,n),adjuster:e.value.style.width,source:6*e.value.stopwatch.tracker.radiusRatio,threshold:1,fallback:1}),t.value.tracker.aura=J({relator:Math.min(u,n),adjuster:e.value.style.width,source:12*e.value.stopwatch.tracker.aura.radiusRatio,threshold:1,fallback:1}),t.value.label=J({relator:Math.min(u,n),adjuster:e.value.style.width,source:e.value.stopwatch.label.fontSize,threshold:10,fallback:10})):t.value.label=e.value.stopwatch.label.fontSize})});c.value&&(r.value&&c.value.unobserve(r.value),c.value.disconnect()),c.value=new ResizeObserver(a),r.value=C.value.parentNode,c.value.observe(r.value)}}le(()=>{c.value&&(r.value&&c.value.unobserve(r.value),c.value.disconnect())});const e=H({get:()=>d(),set:a=>a}),{svgRef:R}=fe({config:e.value.style.title});function d(){return ce({userConfig:T.config,defaultConfig:E})}se(()=>T.config,a=>{e.value=d(),g(),k.value+=1},{deep:!0});const X=H(()=>{if(e.value.stopwatch.showHours&&e.value.stopwatch.showHundredth)return"00:00:00.00";if(e.value.stopwatch.showHours&&!e.value.stopwatch.showHundredth)return"00:00:00";if(!e.value.stopwatch.showHours&&e.value.stopwatch.showHundredth)return"00:00.00";if(!e.value.stopwatch.showHours&&!e.value.stopwatch.showHundredth)return"00:00"}),t=v({height:e.value.style.height,width:e.value.style.width,tracker:{core:6*e.value.stopwatch.tracker.radiusRatio,aura:12*e.value.stopwatch.tracker.aura.radiusRatio},label:e.value.stopwatch.label.fontSize}),y=v(0),P=new me(a=>Y(a),10,"",e.value.stopwatch.showHundredth,e.value.stopwatch.showHours),F=v(!0),l=v(!1),w=v(!1);function O(){m("start"),F.value&&P.start(),F.value=!1,l.value=!0}function W(){l.value&&(m("reset"),P.stop(),x.value=[],F.value=!0,l.value=!1)}function L(){w.value=!w.value,m("pause",y.value),P.pause()}function N(){l.value&&(w.value=!1,m("restart"),x.value=[],P.restart())}const x=v([]);async function D(){if(!l.value||w.value)return;const a=await P.lap();a&&(x.value.push(a),m("lap",x.value))}function Y({timestamp:a,elapsed:u,formatted:n}){y.value={timestamp:a,elapsed:u,formatted:n}}const b=H(()=>Math.min(t.value.width,t.value.height)/2.5*e.value.stopwatch.track.radiusRatio);function ee(a,u){const n=360/(u*1e3);return a*n%360}function te(a){let u=a*(Math.PI/180),n=t.value.width/2+b.value*Math.cos(u),U=t.value.height/2+b.value*Math.sin(u);return{cx:n,cy:U}}const $=H(()=>{const a=ee(y.value.elapsed,e.value.stopwatch.cycleSeconds),{cx:u,cy:n}=te(a-90),U=a>180?1:0;return{cx:u||t.value.width/2,cy:n||t.value.height/2-b.value,largeArcFlag:U,sweepFlag:1}});return A({start:O,pause:L,reset:W,restart:N,lap:D}),(a,u)=>(s(),o("div",{ref_key:"timerChart",ref:C,class:"vue-data-ui-component vue-ui-timer",style:f({fontFamily:e.value.style.fontFamily,width:"100%",height:e.value.responsive?"100%":"auto",textAlign:"center"})},[e.value.style.title.text?(s(),o("div",{key:0,ref_key:"chartTitle",ref:z,style:f({width:"100%",background:e.value.style.backgroundColor})},[(s(),re(ke,{key:"title_".concat(k.value),config:{title:{cy:"title",...e.value.style.title},subtitle:{cy:"subtitle",...e.value.style.title.subtitle}}},null,8,["config"]))],4)):h("",!0),(s(),o("svg",{ref_key:"svgRef",ref:R,xmlns:K(pe),viewBox:"0 0 ".concat(t.value.width<=0?10:t.value.width," ").concat(t.value.height<=0?10:t.value.height),style:f({maxWidth:"100%",overflow:"visible",background:e.value.style.backgroundColor})},[_(K(I)),a.$slots["chart-background"]?(s(),o("foreignObject",{key:0,x:0,y:0,width:t.value.width<=0?10:t.value.width,height:t.value.height<=0?10:t.value.height,style:{pointerEvents:"none"}},[j(a.$slots,"chart-background",{},void 0,!0)],8,ye)):h("",!0),e.value.stopwatch.tracker.gradient.show?(s(),o("defs",be,[M("radialGradient",{id:"tracker_gradient_".concat(p.value),cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"},[M("stop",{offset:"0%","stop-color":e.value.stopwatch.tracker.gradient.color},null,8,$e),M("stop",{offset:"100%","stop-color":e.value.stopwatch.tracker.fill},null,8,Me)],8,xe)])):h("",!0),M("circle",{cx:t.value.width/2,cy:t.value.height/2,r:b.value,fill:e.value.stopwatch.track.fill,stroke:e.value.stopwatch.track.stroke,"stroke-width":e.value.stopwatch.track.strokeWidth},null,8,_e),e.value.stopwatch.cycleTrack.show?(s(),o("path",{key:2,d:"M ".concat(t.value.width/2,",").concat(t.value.height/2-b.value," A ").concat(b.value,",").concat(b.value," 0 ").concat($.value.largeArcFlag,",").concat($.value.sweepFlag," ").concat($.value.cx,",").concat($.value.cy),stroke:e.value.stopwatch.cycleTrack.stroke,"stroke-width":e.value.stopwatch.cycleTrack.strokeWidth,"stroke-linecap":"round",fill:"none"},null,8,Ce)):h("",!0),M("circle",Z($.value,{r:t.value.tracker.core,fill:e.value.stopwatch.tracker.gradient.show?"url(#tracker_gradient_".concat(p.value,")"):e.value.stopwatch.tracker.fill,stroke:e.value.stopwatch.tracker.stroke,"stroke-width":e.value.stopwatch.tracker.strokeWidth}),null,16,Re),e.value.stopwatch.tracker.aura.show?(s(),o("circle",Z({key:3},$.value,{r:t.value.tracker.aura,fill:"".concat(e.value.stopwatch.tracker.aura.fill,"20"),stroke:e.value.stopwatch.tracker.aura.stroke,"stroke-width":e.value.stopwatch.tracker.aura.strokeWidth}),null,16,Pe)):h("",!0),a.$slots.time?(s(),o("foreignObject",{key:4,x:t.value.width/2,y:t.value.height/2,height:"0.1",width:"0.1",style:{overflow:"visible"}},[j(a.$slots,"time",V(G({...y.value})),void 0,!0)],8,Se)):(s(),o("text",{key:5,x:t.value.width/2,y:t.value.height/2+t.value.label/4,"font-size":t.value.label,"text-anchor":"middle",fill:e.value.stopwatch.label.color,"font-weight":e.value.stopwatch.label.bold?"bold":"normal",style:{"font-variant-numeric":"tabular-nums !important"}},ue(y.value.formatted||X.value),9,Ie))],12,ge)),M("div",{ref_key:"chartLegend",ref:i,style:f({width:"100%",backgroundColor:e.value.stopwatch.legend.backgroundColor})},[a.$slots.controls?h("",!0):(s(),o("div",Te,[e.value.stopwatch.legend.buttons.start?(s(),o("button",{key:0,title:e.value.stopwatch.legend.buttonTitles.start,onClick:O,class:"vue-ui-timer-button",style:f({opacity:l.value?.2:1,cursor:l.value?"default":"pointer"})},[_(S,{name:"play",stroke:e.value.stopwatch.legend.buttons.iconColor},null,8,["stroke"])],12,ze)):h("",!0),e.value.stopwatch.legend.buttons.pause?(s(),o("button",{key:1,title:w.value?e.value.stopwatch.legend.buttonTitles.resume:e.value.stopwatch.legend.buttonTitles.pause,onClick:L,class:"vue-ui-timer-button",style:f({opacity:l.value?1:.2,cursor:l.value?"pointer":"default"})},[_(S,{name:"pause",stroke:e.value.stopwatch.legend.buttons.iconColor},null,8,["stroke"])],12,De)):h("",!0),e.value.stopwatch.legend.buttons.reset?(s(),o("button",{key:2,title:e.value.stopwatch.legend.buttonTitles.reset,onClick:W,class:"vue-ui-timer-button",style:f({opacity:l.value?1:.2,cursor:l.value?"pointer":"default"})},[_(S,{name:"stop",stroke:e.value.stopwatch.legend.buttons.iconColor},null,8,["stroke"])],12,He)):h("",!0),e.value.stopwatch.legend.buttons.restart?(s(),o("button",{key:3,title:e.value.stopwatch.legend.buttonTitles.restart,onClick:N,class:"vue-ui-timer-button",style:f({opacity:l.value?1:.2,cursor:l.value?"pointer":"default"})},[_(S,{name:"restart",stroke:e.value.stopwatch.legend.buttons.iconColor},null,8,["stroke"])],12,je)):h("",!0),e.value.stopwatch.legend.buttons.lap?(s(),o("button",{key:4,title:e.value.stopwatch.legend.buttonTitles.lap,onClick:D,class:"vue-ui-timer-button",style:f({opacity:l.value&&!w.value?1:.2,cursor:l.value&&!w.value?"pointer":"default"})},[_(S,{name:"lap",stroke:e.value.stopwatch.legend.buttons.iconColor},null,8,["stroke"])],12,Ae)):h("",!0)])),j(a.$slots,"controls",V(G({start:O,pause:L,reset:W,restart:N,lap:D,laps:x.value,isRunning:l.value,isPaused:w.value,...y.value})),void 0,!0),j(a.$slots,"laps",V(G({laps:x.value,lap:D,isRunning:l.value,isPaused:w.value,...y.value})),void 0,!0)],4)],4))}},Ve=ve(Be,[["__scopeId","data-v-51afad64"]]);export{Ve as default};
