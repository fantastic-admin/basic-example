
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DataTable-BT7VF2ua-Cw2NNXsE.js","./index-DXZKKOp8.js","./index-B7kifsnL.css","./Shape-CNXKB8O0-BJGuTKHC.js","./vue-data-ui-BN9YfUec.js","./alert-l5XlVwCh.js","./vue-data-ui-D1HaM8UR.css","./PenAndPaper-DSvu9dwa-B6YjX2xm.js","./ColorPicker-J5wOPCeB-sgb_Bfch.js","./vClickOutside-C6WiFswA-B2BXHGcD.js","./vue-ui-accordion-UpZ765hd-DndPzmcD.js","./useNestedProp-dJX_8vvZ-BzBW50KN.js","./Tooltip-68Yi_FFl-CRPaJsgv.js","./UserOptions-1OZ3jcm6-BbpzMig3.js","./img-BecE5qXd-CsL1o-EN.js","./dom-to-png--BNgrTZV-DTUrW_sQ.js","./PackageVersion-TgflyMpU-q2MkeeNq.js","./BaseDraggableDialog-ymf2sfB8-Deu3K0kd.js"])))=>i.map(i=>d[i]);
import{ab as Ul,E as tl,J as m,e as y,au as Z,a7 as Wl,K as je,av as jl,b_ as fe,c as b,o as p,z as re,A as M,f as V,g as Ge,u as g,O as se,c0 as ll,h as A,r as _,j as me,k as ye,F as Ke,R as bt,X as al,Y as kt,l as Ye,t as qe,m as xt,n as wt,bn as Gl,N as Kl,c1 as be,a9 as Yl}from"./index-DXZKKOp8.js";import{s as ql,Q as Qe,A as Ql,v as Jl,m as P,C as Xl,g as ol,p as Zl,a as Ee,I as Je,f as De,u as nl,y as $t,o as ul,K as rl,F as sl,e as ea,r as ta,h as la,an as Ct,ao as Xe}from"./vue-data-ui-BN9YfUec.js";import{E as aa,M as oa}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{t as na,o as il}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{S as ua,T as ra}from"./BaseScanner-BgWxam9d-B19ueoDW.js";import{m as sa}from"./usePrinter-DTzqpYKF-D5mkxXp9.js";import{a as ia}from"./useUserOptionState-BIvW1Kz7-D6llU1BK.js";import{o as ca}from"./useChartAccessibility-9icAAmYg-BcUQIUvr.js";import va from"./img-BecE5qXd-CsL1o-EN.js";import da from"./Title-BWp-37K_-BMUMQpSO.js";import{J as ha}from"./themes-AUNCOb2G-RAhReTPj.js";import pa from"./Legend-G6GMcdAc-7HaGLNN7.js";import{O as ga}from"./useSvgExport-DrjCWun4-CbW14PXm.js";import"./alert-l5XlVwCh.js";import"./dom-to-png--BNgrTZV-DTUrW_sQ.js";import"./Shape-CNXKB8O0-BJGuTKHC.js";function cl(u,s){const r=u.length;if(r===0)throw new Error("Max aspect ratio cannot be computed: ".concat(u," is an empty array"));{let i=1/0,c=-1/0,v=0;for(let h=0;h<r;h+=1){const f=u[h].normalizedValue;f<i&&(i=f),f>c&&(c=f),v+=f}return Math.max(s**2*c/v**2,v**2/(s**2*i))}}function vl(u){const{xOffset:s,yOffset:r,width:i,height:c}=u;return{x0:s,y0:r,x1:s+i,y1:r+c}}function fa(u,s,r){if(u.length===0)return!0;{const i=u.concat(s),c=cl(u,r),v=cl(i,r);return c>=v}}function ma(u){const s=[],r=u.length;for(let i=0;i<r;i+=1){const c=u[i],v=c.length;for(let h=0;h<v;h+=1)s.push(c[h])}return s}function ya(u,s){const r={...s,children:u};return hl(r)}function ba(u){return(u.x1-u.x0)*(u.y1-u.y0)}function dl(u,s){const{width:r,height:i,xOffset:c,yOffset:v}=_t(s),h=u.length,f=u.map(T=>T.normalizedValue||0).reduce((T,E)=>T+E,0),k=f/i,z=f/r;let H=c,w=v;const O=[];if(r>=i){for(let T=0;T<h;T+=1){const E=u[T],Y=w+E.normalizedValue/k,S={x0:H,y0:w,x1:H+k,y1:Y},R=Object.assign({},E,S);w=Y,O.push(R)}return O}else{for(let T=0;T<h;T+=1){const E=u[T],Y=H+E.normalizedValue/z,S={x0:H,y0:w,x1:Y,y1:w+z},R=Object.assign({},E,S);H=Y,O.push(R)}return O}}function ka(u){const s=_t(u),r=s.width,i=s.height;return Math.min(r,i)}function xa(u,s){const r=u.length,i=u.map(k=>{var z;return(z=k.value)!=null?z:0}).reduce((k,z)=>k+z,0),c=s/i,v=[];let h,f;for(let k=0;k<r;k+=1)f=u[k],h=Object.assign({},f,{normalizedValue:f.value*(c||0)}),v.push(h);return v}function _t(u){const{x0:s,y0:r,x1:i,y1:c}=u;return{xOffset:s,yOffset:r,width:i-s,height:c-r}}function wa(u,s,r,i){let c=u,v=s,h=r,f=i;for(;;){const k=c.length;if(k===0){const O=dl(v,h);return f.concat(O)}const z=ka(h),H=c[0],w=c.slice(1,k);if(fa(v,H,z)){const O=v.concat(H);c=w,v=O,h=h,f=f}else{const O=v.length;let T=0;for(let R=0;R<O;R+=1)T+=v[R].normalizedValue;const E=$a(h,T),Y=dl(v,h),S=f.concat(Y);c=c,v=[],h=E,f=S}}}function hl(u){if(typeof u.children>"u"||!u.children.length)return[u];{const s=xa(u.children,ba(u)),r=wa(s,[],u,[]),i=r.length,c=[];for(let v=0;v<i;v+=1)c.push(hl(r[v]));return ma(c)}}function $a(u,s){const{width:r,height:i,xOffset:c,yOffset:v}=_t(u);if(r>=i){const h=s/i,f=r-h,k={xOffset:c+h,yOffset:v,width:f,height:i};return vl(k)}else{const h=s/r,f=i-h,k={xOffset:c,yOffset:v+h,width:r,height:f};return vl(k)}}const Ca=["id"],_a=["id"],Oa=["tabindex","onClick","onKeydown","data-last-crumb","onMouseenter","onFocus"],Ta={class:"vue-ui-treemap-crumb-unit"},Ia={class:"vue-ui-treemap-crumb-unit-label"},Aa={key:0,style:{width:"24px",display:"flex","align-items":"center"}},Fa={key:0,class:"vue-ui-treemap-crumb-unit-arrow"},Ma=["xmlns","viewBox"],Sa={key:0},Na=["id"],Pa=["stop-color"],Ea=["stop-color"],Da=["x","y","height","width","fill","rx","stroke","stroke-width","onClick","onMouseenter","onMouseleave"],Va=["innerHTML"],za=["x","y","height","width"],Ra={key:5,class:"vue-data-ui-watermark"},La=["id"],Ba=["onClick"],Ha=["innerHTML"],Ua={__name:"vue-ui-treemap",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectLegend","selectDatapoint"],setup(u,{expose:s,emit:r}){const i=fe(()=>be(()=>import("./DataTable-BT7VF2ua-Cw2NNXsE.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url)),c=fe(()=>be(()=>import("./PenAndPaper-DSvu9dwa-B6YjX2xm.js"),__vite__mapDeps([7,1,2,4,5,6,8,9]),import.meta.url)),v=fe(()=>be(()=>import("./vue-ui-accordion-UpZ765hd-DndPzmcD.js"),__vite__mapDeps([10,1,2,4,5,6,11]),import.meta.url)),h=fe(()=>be(()=>import("./Tooltip-68Yi_FFl-CRPaJsgv.js"),__vite__mapDeps([12,4,1,2,5,6]),import.meta.url)),f=fe(()=>be(()=>import("./UserOptions-1OZ3jcm6-BbpzMig3.js"),__vite__mapDeps([13,1,2,9,4,5,6,14,15]),import.meta.url)),k=fe(()=>be(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([16,1,2]),import.meta.url)),z=fe(()=>be(()=>import("./BaseDraggableDialog-ymf2sfB8-Deu3K0kd.js"),__vite__mapDeps([17,1,2,4,5,6]),import.meta.url)),{vue_ui_treemap:H}=na(),w=u,O=r,T=Ul();tl(()=>{T["chart-background"]&&console.warn("VueUiTreemap does not support the #chart-background slot.")});const E=m(()=>!!w.dataset&&w.dataset.length),Y=m(()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),S=y(Qe()),R=y(!1),Ze=y(""),ie=y(!1),Ot=y(0),U=y([]),W=Z(null),Tt=Z(null),It=Z(null),At=Z(null),Ft=Z(null),Mt=y(0),et=y(0),tt=y(0),F=y([]),lt=y(null),St=y(!1),Fe=y(null),at=y(null),t=y(rt()),{loading:ke,FINAL_DATASET:ot,manualLoading:pl}=ua({...Wl(w),FINAL_CONFIG:t,prepareConfig:rt,skeletonDataset:[{name:"_",value:53,color:"#CACACA90",children:[{name:"_",value:21},{name:"_",value:13},{name:"_",value:8},{name:"_",value:5},{name:"_",value:3},{name:"_",value:2},{name:"_",value:1}]}],skeletonConfig:Ql({defaultConfig:t.value,userConfig:{userOptions:{show:!1},style:{chart:{backgroundColor:"#999999",layout:{labels:{showDefaultLabels:!1},rects:{stroke:"#6A6A6A"}},legend:{backgroundColor:"transparent"}}}}})}),{userOptionsVisible:nt,setUserOptionsVisibility:Nt,keepUserOptionState:Pt}=ia({config:t.value}),{svgRef:ut}=ca({config:t.value.style.chart.title});function rt(){const e=il({userConfig:w.config,defaultConfig:H});return e.theme?{...il({userConfig:ha.vue_ui_treemap[e.theme]||w.config,defaultConfig:e}),customPalette:Jl[e.theme]||P}:e}je(()=>w.config,e=>{ke.value||(t.value=rt()),nt.value=!t.value.userOptions.showOnChartHover,Mt.value+=1,et.value+=1,tt.value+=1,D.value.showTable=t.value.table.show,D.value.showTooltip=t.value.style.chart.tooltip.show},{deep:!0});const{isPrinting:Et,isImaging:Dt,generatePdf:Vt,generateImage:zt}=sa({elementId:"treemap_".concat(S.value),fileName:t.value.style.chart.title.text||"vue-ui-treemap",options:t.value.userOptions.print}),gl=m(()=>t.value.userOptions.show&&!t.value.style.chart.title.text),Ve=m(()=>Xl(t.value.customPalette)),D=y({showTable:t.value.table.show,showTooltip:t.value.style.chart.tooltip.show});je(t,()=>{D.value={showTable:t.value.table.show,showTooltip:t.value.style.chart.tooltip.show}},{immediate:!0});const Me=y({height:t.value.style.chart.height,width:t.value.style.chart.width});function fl(e){const a=W.value,l=Me.value.height;if(!a||!l)return e;const o=a.getBoundingClientRect();return e*(l/o.height)}function ml(){if(!lt.value||q.value.length<=1)return 0;const e=lt.value,a=getComputedStyle(e),l=e.offsetHeight+parseFloat(a.marginTop||"0")+parseFloat(a.marginBottom||"0")+parseFloat(a.paddingTop||"0")+parseFloat(a.paddingBottom||"0");return fl(l)}const L=m(()=>{const e=t.value.style.chart.padding,a=Me.value.width,l=Me.value.height,o=ml(),n=e.left,d=a-e.right,$=e.top,N=l-e.bottom-o;return{left:n,top:$,right:d,bottom:N,width:d-n,height:Math.max(0,N-$),vbWidth:a,vbHeight:l-o,offsetY:o}}),B=y(ot.value),ee=y(B.value),Rt=Z(new Map);function Lt(e){Array.isArray(e)&&e.forEach((a,l)=>{a.id||(a.id=Qe());let o=Ee(a.color)||Rt.value.get(a.id)||Ve.value[l]||P[l]||P[l%P.length];o=Ee(o),Rt.value.set(a.id,o),a.color=o,Bt(a,o)})}function Bt(e,a){Array.isArray(e.children)&&e.children.forEach(l=>{l.id||(l.id=Qe()),l.parentId=e.id,l.color=a,Bt(l,a)})}function yl(){var e;if(!F.value.length)ee.value=B.value.slice();else{const a=F.value[F.value.length-1],l=le(a);ee.value=((e=l==null?void 0:l.children)==null?void 0:e.slice())||[]}}je(()=>ot.value,()=>{B.value=ot.value,Lt(B.value),yl(),tt.value+=1,et.value+=1},{deep:!0,immediate:!0,flush:"post"});const te=Z(null),xe=Z(null);tl(()=>{St.value=!0,kl()});const bl=m(()=>t.value.debug);function kl(){if(ol(w.dataset)&&Zl({componentName:"VueUiTreemap",type:"dataset",debug:bl.value}),Lt(B.value),ol(w.dataset)||(pl.value=t.value.loading),t.value.responsive){const e=aa(()=>{const{width:a,height:l}=oa({chart:W.value,title:t.value.style.chart.title.text?Tt.value:null,legend:t.value.style.chart.legend.show?It.value:null,source:At.value,noTitle:Ft.value});requestAnimationFrame(()=>{Me.value.width=a,Me.value.height=l-12})});te.value&&(xe.value&&te.value.unobserve(xe.value),te.value.disconnect()),te.value=new ResizeObserver(e),xe.value=W.value.parentNode,te.value.observe(xe.value)}}jl(()=>{te.value&&(xe.value&&te.value.unobserve(xe.value),te.value.disconnect())});const Se=m(()=>ee.value.map((e,a)=>({...e,color:Ee(e.color)||Ve.value[a]||P[a]||P[a%P.length]})).filter(e=>!U.value.includes(e.id))),we=m(()=>B.value.filter(e=>!U.value.includes(e.id)).map(e=>e.value||0).reduce((e,a)=>e+a,0)),st=m({get(){let e=[...Se.value];return t.value.style.chart.layout.sorted&&(e=[...Se.value].sort((a,l)=>l.value-a.value)),e.map(a=>({...a}))},set(e){return e}});function Ht(e,a){return e.value/a}function xl(e,a,l){const o=t.value.style.chart.layout.rects.colorRatio-Ht(a,l);return ul(e,o<0?0:o)}function Ut(e,a,l,o){return e.map((n,d)=>{const $=xl(Ee(a)||Ve.value[d]||P[d]||P[d%P.length],n,o),N=Ht(n,o);return{...n,color:$,proportion:N,parentName:l,children:n.children?Ut(n.children,$,n.name,o):void 0}})}const Ne=m(()=>{const e=st.value.map(a=>Number(a.value)||0).reduce((a,l)=>a+l,0)||1;return ya(st.value.map(a=>{const l=a.children?a.children.reduce((o,n)=>o+(Number(n.value)||0),0):a.value;return{value:a.value,id:a.id||Qe(),proportion:(Number(a.value)||0)/e,children:a.children?Ut(a.children.sort((o,n)=>(n.value||0)-(o.value||0)),a.color,a.name,l||1):void 0,color:a.color,name:a.name}}),{x0:L.value.left,y0:L.value.top,x1:L.value.left+L.value.width,y1:L.value.top+L.value.height})});function $e({y0:e,y1:a}){return a-e<=0?1e-4:a-e}function Ce({x0:e,x1:a}){return a-e<=0?1e-4:a-e}function _e(e){const a=t.value.style.chart.layout.labels;console.log(a);const l=a.fontSize,o=a.minFontSize,n=a.fontSize*2,d=.5,$=.6,N=1,ce=.9;let ae=e.proportion;if(!(typeof ae=="number"&&isFinite(ae))){const Ue=Math.max(1e-6,Ce(e)*$e(e)),ve=Math.max(1e-6,L.value.width*L.value.height);ae=Ue/ve}const He=Math.pow(Math.min(1,Math.max(0,ae)),d),oe=$+(N-$)*He;let ne=l*oe;const ht=Math.max(1e-4,Math.min(Ce(e),$e(e)));return ne=Math.min(ne,ht*ce),ne=Math.max(o,Math.min(n,ne)),ne}function Wt(e){ie.value=e,Ot.value+=1}const Oe=m(()=>({startX:0,startY:0,width:L.value.vbWidth,height:L.value.vbHeight}));function le(e,a=B.value){for(const l of a){if(l.id===e)return l;if(l.children){const o=le(e,l.children);if(o)return o}}return null}const Te=m(()=>F.value.length>0);function ze(e,a){var o;if(!e){ee.value=B.value.slice(),O("selectDatapoint",void 0),F.value=[];return}t.value.events.datapointClick&&t.value.events.datapointClick({datapoint:e,seriesIndex:a});const l=le(e.id);if(l&&((o=l.children)!=null&&o.length))F.value.push(l.id),ee.value=l.children.slice(),O("selectDatapoint",e);else if(e.parentId){F.value.push(e.parentId);const n=le(e.parentId);ee.value=n.children.slice(),O("selectDatapoint",e)}else if(F.value.length>0){F.value.pop();const n=F.value[F.value.length-1];if(n){const d=le(n);ee.value=d.children.slice()}else ee.value=B.value.slice(),F.value=[],O("selectDatapoint",void 0)}}function wl(e){var a,l;return!!((l=(a=le(e.id))==null?void 0:a.children)!=null&&l.length||e.parentId)}const q=m(()=>{const e=[{id:null,label:"All"}];if(F.value.length>0){let a=le(F.value[F.value.length-1]);const l=[];for(;a;)l.unshift(a),a=a.parentId?le(a.parentId):null;for(const o of l)e.push({id:o.id,label:o.name,node:o})}return e}),j=Z(null),it=m(()=>B.value.map((e,a)=>({...e,color:Ee(e.color)||Ve.value[a]||P[a]||P[a%P.length],shape:"square"})).sort((e,a)=>a.value-e.value).map((e,a)=>{const l=e.value/B.value.map(o=>o.value).reduce((o,n)=>o+n,0);return{...e,proportion:l,opacity:U.value.includes(e.id)?.5:1,display:"".concat(e.name).concat(t.value.style.chart.legend.showPercentage||t.value.style.chart.legend.showValue?": ":"").concat(t.value.style.chart.legend.showValue?Je(t.value.style.chart.layout.labels.formatter,e.value,De({p:t.value.style.chart.layout.labels.prefix,v:e.value,s:t.value.style.chart.layout.labels.suffix,r:t.value.style.chart.legend.roundingValue}),{datapoint:e}):"").concat(t.value.style.chart.legend.showPercentage?U.value.includes(e.id)?"".concat(t.value.style.chart.legend.showValue?" (":"","- %").concat(t.value.style.chart.legend.showValue?")":""):"".concat(t.value.style.chart.legend.showValue?" (":"").concat(isNaN(e.value/we.value)?"-":(e.value/we.value*100).toFixed(t.value.style.chart.legend.roundingPercentage),"%").concat(t.value.style.chart.legend.showValue?")":""):"")}})),$l=m(()=>({cy:"treemap-div-legend",backgroundColor:t.value.style.chart.legend.backgroundColor,color:t.value.style.chart.legend.color,fontSize:t.value.style.chart.legend.fontSize,paddingBottom:12,fontWeight:t.value.style.chart.legend.bold?"bold":""}));function jt(e){j.value=null,U.value.includes(e.id)?U.value=U.value.filter(a=>a!==e.id):U.value.length<w.dataset.length-1&&U.value.push(e.id),O("selectLegend",st.value)}function Cl({datapoint:e,seriesIndex:a}){j.value=null,R.value=!1,t.value.events.datapointLeave&&t.value.events.datapointLeave({datapoint:e,seriesIndex:a})}const ct=y(null);function _l({datapoint:e,seriesIndex:a}){t.value.events.datapointEnter&&t.value.events.datapointEnter({datapoint:e,seriesIndex:a}),j.value=e,ct.value={datapoint:e,seriesIndex:a,config:t.value,series:Se.value};const l=t.value.style.chart.tooltip.customFormat;if(sl(l)&&la(()=>l({seriesIndex:a,datapoint:e,series:Se.value,config:t.value})))Ze.value=l({seriesIndex:a,datapoint:e,series:Se.value,config:t.value});else{let o="";o+='<div style="width:100%;text-align:center;border-bottom:1px solid '.concat(t.value.style.chart.tooltip.borderColor,';padding-bottom:6px;margin-bottom:3px;">').concat(e.name,"</div>"),o+='<div style="display:flex;flex-direction:row;gap:6px;align-items:center;"><svg viewBox="0 0 12 12" height="14" width="14"><rect x="0" y="0" height="12" width="12" stroke="none" fill="'.concat(e.color,'"/></svg>'),o+="<b>".concat(Je(t.value.style.chart.layout.labels.formatter,e.value,De({p:t.value.style.chart.layout.labels.prefix,v:e.value,s:t.value.style.chart.layout.labels.suffix,r:t.value.style.chart.tooltip.roundingValue}),{datapoint:e,seriesIndex:a}),"</b>"),Ze.value="<div>".concat(o,"</div>")}R.value=!0}const Q=m(()=>{const e=Ne.value.map(l=>({name:l.name,color:l.color})),a=Ne.value.map(l=>l.value);return{head:e,body:a}});function vt(e=null){Yl(()=>{const a=Q.value.head.map((n,d)=>[[n.name],[Q.value.body[d]],[isNaN(Q.value.body[d]/we.value)?"-":Q.value.body[d]/we.value*100]]),l=[[t.value.style.chart.title.text],[t.value.style.chart.title.subtitle.text],[[""],["val"],["%"]]].concat(a),o=ea(l);e?e(o):ta({csvContent:o,title:t.value.style.chart.title.text||"vue-ui-treemap"})})}const Re=m(()=>{const e=[t.value.table.columnNames.series,t.value.table.columnNames.value,t.value.table.columnNames.percentage],a=Q.value.head.map((o,n)=>{const d=Je(t.value.style.chart.layout.labels.formatter,Q.value.body[n],De({p:t.value.style.chart.layout.labels.prefix,v:Q.value.body[n],s:t.value.style.chart.layout.labels.suffix,r:t.value.table.td.roundingValue}));return[{color:o.color,name:o.name,shape:"square"},d,isNaN(Q.value.body[n]/we.value)?"-":De({v:Q.value.body[n]/we.value*100,s:"%",r:t.value.table.td.roundingPercentage})]}),l={th:{backgroundColor:t.value.table.th.backgroundColor,color:t.value.table.th.color,outline:t.value.table.th.outline},td:{backgroundColor:t.value.table.td.backgroundColor,color:t.value.table.td.color,outline:t.value.table.td.outline},breakpoint:t.value.table.responsiveBreakpoint};return{colNames:[t.value.table.columnNames.series,t.value.table.columnNames.value],head:e,body:a,config:l}});function Ol(){return Ne.value}function Gt(){D.value.showTable=!D.value.showTable}function Kt(){D.value.showTooltip=!D.value.showTooltip}const Le=y(!1);function dt(){Le.value=!Le.value}const Be=y(null);function Yt(e){Be.value=e}function qt(){Be.value=null}async function Tl({scale:e=2}={}){if(!W.value)return;const{width:a,height:l}=W.value.getBoundingClientRect(),o=a/l,{imageUri:n,base64:d}=await va({domElement:W.value,base64:!0,img:!0,scale:e});return{imageUri:n,base64:d,title:t.value.style.chart.title.text,width:a,height:l,aspectRatio:o}}const Pe=m(()=>{const e=t.value.table.useDialog&&!t.value.table.show,a=D.value.showTable;return{component:e?z:v,title:"".concat(t.value.style.chart.title.text).concat(t.value.style.chart.title.subtitle.text?": ".concat(t.value.style.chart.title.subtitle.text):""),props:e?{backgroundColor:t.value.table.th.backgroundColor,color:t.value.table.th.color,headerColor:t.value.table.th.color,headerBg:t.value.table.th.backgroundColor,isFullscreen:ie.value,fullscreenParent:W.value,forcedWidth:Math.min(800,window.innerWidth*.8)}:{hideDetails:!0,config:{open:a,maxHeight:1e4,body:{backgroundColor:t.value.style.chart.backgroundColor,color:t.value.style.chart.color},head:{backgroundColor:t.value.style.chart.backgroundColor,color:t.value.style.chart.color}}}}});je(()=>D.value.showTable,e=>{t.value.table.show||(e&&t.value.table.useDialog&&Fe.value?Fe.value.open():"close"in Fe.value&&Fe.value.close())});function Qt(){D.value.showTable=!1,at.value&&at.value.setTableIconState(!1)}const Il=m(()=>it.value.map(e=>({...e,name:e.display}))),Al=m(()=>t.value.style.chart.backgroundColor),Fl=m(()=>t.value.style.chart.legend),Ml=m(()=>t.value.style.chart.title),{exportSvg:Sl,getSvg:Nl}=ga({svg:ut,title:Ml,legend:Fl,legendItems:Il,backgroundColor:Al});async function Jt({isCb:e}){if(e){const{blob:a,url:l,text:o,dataUrl:n}=await Nl();t.value.userOptions.callbacks.svg({blob:a,url:l,text:o,dataUrl:n})}else Sl()}function Pl({rect:e,seriesIndex:a}){var Zt;const l=t.value.style.chart.layout.labels.name.show,o=t.value.style.chart.layout.labels.value.show;if(!l&&!o)return"";const n=Math.max(2,_e(e)/3),d=Math.max(8,_e(e)),$=d*1.2,N=Math.max(0,Ce(e)-n*2),ce=Math.max(0,$e(e)-n*2);if(N<=2||ce<=d*.8)return"";const ae=t.value.style.fontFamily,He=t.value.style.chart.layout.labels.name.bold?"600":"400",oe=t.value.style.chart.layout.labels.value.bold?"600":"400",ne=rl(e.color),ht=l?String((Zt=e.name)!=null?Zt:""):"",Ue=o?Je(t.value.style.chart.layout.labels.formatter,e.value,De({p:t.value.style.chart.layout.labels.prefix,v:e.value,s:t.value.style.chart.layout.labels.suffix,r:t.value.style.chart.layout.labels.rounding}),{datapoint:e,seriesIndex:a}):"";function ve(he,pe=d,Ae="400"){const G=document.createElementNS($t,"svg");G.setAttribute("width","0"),G.setAttribute("height","0"),G.style.position="absolute",G.style.visibility="hidden",G.style.pointerEvents="none";const K=document.createElementNS($t,"text");K.setAttribute("font-size",String(pe)),K.setAttribute("font-family",ae),K.setAttribute("font-weight",String(Ae)),K.textContent=he||"",G.appendChild(K),document.body.appendChild(G);const el=K.getComputedTextLength();return document.body.removeChild(G),el}function Dl(he,pe,Ae,G,K,el){const Rl=String(he).split(/\s+/).filter(Boolean),I=[];let ue="";function ge(C){return ve(C,Ae,G)<=pe}function Ll(C){if(ge(C))return[C];const X=[];let x=0;for(;x<C.length;){let ft=1,mt=C.length-x,yt=1;for(;ft<=mt;){const We=ft+mt>>1,Hl=C.slice(x,x+We);ge(Hl)?(yt=We,ft=We+1):mt=We-1}X.push(C.slice(x,x+yt)),x+=yt}return X}const Bl=Rl.flatMap(C=>Ll(C));for(const C of Bl){const X=ue?ue+" "+C:C;if(ge(X))ue=X;else if(ue&&I.push(ue),ue=C,I.length===K-1)break}if(ue&&I.length<K&&I.push(ue),I.length===K){const C=I[I.length-1];if(!ge(C)){let x=C;for(;x.length&&!ge(x);)x=x.slice(0,-1);I[I.length-1]=x}let X=I[I.length-1]+"…";if(!ge(X)){let x=I[I.length-1];for(;x.length&&!ge(x+"…");)x=x.slice(0,-1);X=x+"…"}I[I.length-1]=X}return I}const Vl=o?1:0,Xt=Math.max(0,Math.floor(ce/$)-Vl);if(Xt<=0){if(!o)return"";const he=e.x0+n,pe=e.y0+n+d,Ae=Ct(Ue);return ve(Ae,d,oe)<=N?'\n        <text \n            x="'.concat(he,'" \n            y="').concat(pe,'" \n            font-size="').concat(d,'" \n            font-family="').concat(Xe(ae),'" \n            font-weight="').concat(oe,'" \n            fill="').concat(Xe(ne),'"\n        >\n            ').concat(Ae,"\n        </text>"):""}const de=l?Dl(ht,N,d,He,Xt):[];let Ie=d,J=String(Ue);if(o){for(;ve(J,Ie,oe)>N&&Ie>Math.max(8,d*.75);)Ie-=1;if(ve(J,Ie,oe)>N){for(;J.length&&ve(J+"…",Ie,oe)>N;)J=J.slice(0,-1);if(J+="…",!J.length)return""}}if(de.length*$+(o?$:0)>ce){for(;de.length&&de.length*$+(o?$:0)>ce;)de.pop();if(!de.length&&(!o||$>ce))return""}const pt=e.x0+n,zl=e.y0+n+d,gt=[];return l&&de.forEach((he,pe)=>{gt.push('\n            <tspan \n                x="'.concat(pt,'" \n                dy="').concat(pe===0?0:$,'" \n                font-weight="').concat(He,'"\n            >\n                ').concat(Ct(he),"\n            </tspan>"))}),o&&gt.push('\n        <tspan \n            x="'.concat(pt,'" \n            dy="').concat(de.length?$:0,'"\n            font-weight="').concat(oe,'" \n            font-size="').concat(Ie,'"\n        >\n            ').concat(Ct(J),"\n        </tspan>")),'<text \n        x="'.concat(pt,'" \n        y="').concat(zl,'" \n        font-size="').concat(d,'" \n        font-family="').concat(Xe(ae),'" \n        fill="').concat(Xe(ne),'" \n        paint-order="stroke" \n        stroke="transparent" \n        stroke-width="0"\n        style="transition: all 0.2s ease-in-out;"\n    >\n        ').concat(gt.join(""),"\n    </text>")}function El(e){const a=t.value.style.chart.layout.rects.borderRadius,l=Ce(e),o=$e(e);return Math.min(a,Math.min(l,o)/6)}return s({getData:Ol,getImage:Tl,generateCsv:vt,generateImage:zt,generateSvg:Jt,generatePdf:Vt,toggleTable:Gt,toggleTooltip:Kt,toggleAnnotator:dt,toggleFullscreen:Wt}),(e,a)=>(p(),b("div",{ref_key:"treemapChart",ref:W,class:wt("vue-data-ui-component vue-ui-treemap ".concat(ie.value?"vue-data-ui-wrapper-fullscreen":""," ").concat(t.value.useCssAnimation?"":"vue-ui-dna")),style:se("font-family:".concat(t.value.style.fontFamily,";width:100%; ").concat(t.value.responsive?"height: 100%;":""," text-align:center;background:").concat(t.value.style.chart.backgroundColor)),id:"treemap_".concat(S.value),onMouseenter:a[2]||(a[2]=()=>g(Nt)(!0)),onMouseleave:a[3]||(a[3]=()=>g(Nt)(!1))},[t.value.userOptions.buttons.annotator?(p(),re(g(c),{key:0,svgRef:g(ut),backgroundColor:t.value.style.chart.backgroundColor,color:t.value.style.chart.color,active:Le.value,onClose:dt},null,8,["svgRef","backgroundColor","color","active"])):M("",!0),gl.value?(p(),b("div",{key:1,ref_key:"noTitle",ref:Ft,class:"vue-data-ui-no-title-space",style:"height:36px; width: 100%;background:transparent"},null,512)):M("",!0),t.value.style.chart.title.text?(p(),b("div",{key:2,ref_key:"chartTitle",ref:Tt,style:se("width:100%;background:".concat(t.value.style.chart.backgroundColor,";padding-bottom:6px"))},[(p(),re(da,{key:"title_".concat(Mt.value),config:{title:{cy:"treemap-div-title",...t.value.style.chart.title},subtitle:{cy:"treemap-div-subtitle",...t.value.style.chart.title.subtitle}}},null,8,["config"]))],4)):M("",!0),V("div",{id:"legend-top-".concat(S.value)},null,8,_a),t.value.userOptions.show&&E.value&&(g(Pt)||g(nt))?(p(),re(g(f),{ref_key:"userOptionsRef",ref:at,key:"user_option_".concat(Ot.value),backgroundColor:t.value.style.chart.backgroundColor,color:t.value.style.chart.color,isPrinting:g(Et),isImaging:g(Dt),uid:S.value,hasTooltip:t.value.userOptions.buttons.tooltip&&t.value.style.chart.tooltip.show,hasPdf:t.value.userOptions.buttons.pdf,hasXls:t.value.userOptions.buttons.csv,hasImg:t.value.userOptions.buttons.img,hasSvg:t.value.userOptions.buttons.svg,hasTable:t.value.userOptions.buttons.table,hasFullscreen:t.value.userOptions.buttons.fullscreen,isFullscreen:ie.value,isTooltip:D.value.showTooltip,titles:{...t.value.userOptions.buttonTitles},chartElement:W.value,position:t.value.userOptions.position,hasAnnotator:t.value.userOptions.buttons.annotator,isAnnotation:Le.value,callbacks:t.value.userOptions.callbacks,printScale:t.value.userOptions.print.scale,tableDialog:t.value.table.useDialog,onToggleFullscreen:Wt,onGeneratePdf:g(Vt),onGenerateCsv:vt,onGenerateImage:g(zt),onGenerateSvg:Jt,onToggleTable:Gt,onToggleTooltip:Kt,onToggleAnnotator:dt,style:se({visibility:g(Pt)?g(nt)?"visible":"hidden":"visible"})},ll({_:2},[e.$slots.menuIcon?{name:"menuIcon",fn:A(({isOpen:l,color:o})=>[_(e.$slots,"menuIcon",me(ye({isOpen:l,color:o})),void 0,!0)]),key:"0"}:void 0,e.$slots.optionTooltip?{name:"optionTooltip",fn:A(()=>[_(e.$slots,"optionTooltip",{},void 0,!0)]),key:"1"}:void 0,e.$slots.optionPdf?{name:"optionPdf",fn:A(()=>[_(e.$slots,"optionPdf",{},void 0,!0)]),key:"2"}:void 0,e.$slots.optionCsv?{name:"optionCsv",fn:A(()=>[_(e.$slots,"optionCsv",{},void 0,!0)]),key:"3"}:void 0,e.$slots.optionImg?{name:"optionImg",fn:A(()=>[_(e.$slots,"optionImg",{},void 0,!0)]),key:"4"}:void 0,e.$slots.optionTable?{name:"optionTable",fn:A(()=>[_(e.$slots,"optionTable",{},void 0,!0)]),key:"5"}:void 0,e.$slots.optionFullscreen?{name:"optionFullscreen",fn:A(({toggleFullscreen:l,isFullscreen:o})=>[_(e.$slots,"optionFullscreen",me(ye({toggleFullscreen:l,isFullscreen:o})),void 0,!0)]),key:"6"}:void 0,e.$slots.optionAnnotator?{name:"optionAnnotator",fn:A(({toggleAnnotator:l,isAnnotator:o})=>[_(e.$slots,"optionAnnotator",me(ye({toggleAnnotator:l,isAnnotator:o})),void 0,!0)]),key:"7"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasTooltip","hasPdf","hasXls","hasImg","hasSvg","hasTable","hasFullscreen","isFullscreen","isTooltip","titles","chartElement","position","hasAnnotator","isAnnotation","callbacks","printScale","tableDialog","onGeneratePdf","onGenerateImage","style"])):M("",!0),q.value.length>1?(p(),b("nav",{key:4,class:"vue-ui-treemap-breadcrumbs","data-dom-to-png-ignore":"",ref_key:"breadcrumbsNav",ref:lt},[(p(!0),b(Ke,null,bt(q.value,(l,o)=>(p(),b("span",{role:"button",tabindex:o<q.value.length-1?0:void 0,key:l.id||"root",onClick:n=>o===q.value.length-1?()=>{}:ze(l.node),onKeydown:[al(kt(n=>o===q.value.length-1?void 0:ze(l.node),["prevent"]),["enter"]),al(kt(n=>o===q.value.length-1?void 0:ze(l.node),["prevent"]),["space"])],class:"vue-ui-treemap-crumb","data-last-crumb":o===q.value.length-1,style:se({color:t.value.style.chart.color}),onMouseenter:n=>Yt(o),onMouseleave:qt,onFocus:n=>Yt(o),onBlur:qt},[V("span",Ta,[V("span",Ia,[_(e.$slots,"breadcrumb-label",xt({ref_for:!0},{crumb:l,isRoot:o===0,isFocus:Be.value===o}),()=>[o===0?(p(),b("div",Aa,[Ge(nl,{name:Be.value===0?"homeFilled":"home",stroke:t.value.style.chart.color},null,8,["name","stroke"])])):(p(),b(Ke,{key:1},[Ye(qe(l.label),1)],64))],!0)]),o<q.value.length-1?(p(),b("span",Fa,[_(e.$slots,"breadcrumb-arrow",{},()=>[a[4]||(a[4]=Ye(" › ",-1))],!0)])):M("",!0)])],44,Oa))),128))],512)):M("",!0),(p(),b("svg",{ref_key:"svgRef",ref:ut,xmlns:g($t),class:wt({"vue-data-ui-fullscreen--on":ie.value,"vue-data-ui-fulscreen--off":!ie.value,"vue-data-ui-zoom-plus":!Te.value,"vue-data-ui-zoom-minus":Te.value,loading:g(ke)}),viewBox:"".concat(Oe.value.startX," ").concat(Oe.value.startY," ").concat(Oe.value.width<=0?10:Oe.value.width," ").concat(Oe.value.height<=0?10:Oe.value.height),style:se("max-width:100%; overflow: hidden; background:transparent;color:".concat(t.value.style.chart.color))},[Ge(g(k)),(p(!0),b(Ke,null,bt(Ne.value,(l,o)=>(p(),b("g",{key:"tgrad_".concat(l.id)},[t.value.style.chart.layout.rects.gradient.show?(p(),b("defs",Sa,[V("radialGradient",{id:"tgrad_".concat(l.id),gradientTransform:"translate(-1, -1.000001) scale(2, 2)"},[V("stop",{offset:"18%","stop-color":l.color},null,8,Pa),V("stop",{offset:"100%","stop-color":g(ul)(l.color,t.value.style.chart.layout.rects.gradient.intensity/100)},null,8,Ea)],8,Na)])):M("",!0)]))),128)),(p(!0),b(Ke,null,bt(Ne.value,(l,o)=>(p(),b("g",{key:"k_".concat(l.id)},[V("rect",{x:l.x0,y:l.y0,height:$e(l),width:Ce(l),fill:Y.value?l.color:t.value.style.chart.layout.rects.gradient.show?"url(#tgrad_".concat(l.id,")"):l.color,rx:El(l),stroke:j.value&&j.value.id===l.id?t.value.style.chart.layout.rects.selected.stroke:t.value.style.chart.layout.rects.stroke,"stroke-width":j.value&&j.value.id===l.id?t.value.style.chart.layout.rects.selected.strokeWidth:t.value.style.chart.layout.rects.strokeWidth,onClick:kt(n=>ze(l,o),["stop"]),onMouseenter:()=>_l({datapoint:l,seriesIndex:o}),onMouseleave:n=>Cl({datapoint:l,seriesIndex:o}),style:se("opacity:".concat(j.value?j.value.id===l.id?1:t.value.style.chart.layout.rects.selected.unselectedOpacity:1)),class:wt(["vue-ui-treemap-rect",wl(l)?"vue-data-ui-zoom-plus":Te.value?"vue-data-ui-zoom-minus":""])},null,46,Da),!e.$slots.rect&&!g(ke)&&t.value.style.chart.layout.labels.showDefaultLabels?(p(),b("g",{key:0,style:{"pointer-events":"none"},innerHTML:Pl({rect:l,seriesIndex:o})},null,8,Va)):M("",!0),(p(),b("foreignObject",{x:l.x0,y:l.y0,height:$e(l),width:Ce(l),class:"vue-ui-treemap-cell-foreignObject"},[V("div",{style:se({width:"calc(100% - ".concat(_e(l)/1.5,"px)"),height:"calc(100% - ".concat(_e(l)/1.5,"px)"),padding:"".concat(_e(l)/3,"px")}),class:"vue-ui-treemap-cell"},[g(ke)?M("",!0):_(e.$slots,"rect",xt({key:0,ref_for:!0},{rect:l,shouldShow:l.proportion>t.value.style.chart.layout.labels.hideUnderProportion||Te.value,fontSize:_e(l),isZoom:Te.value,textColor:g(rl)(l.color)}),void 0,!0)],4)],8,za))]))),128)),_(e.$slots,"svg",me(ye({svg:L.value,isZoom:Te.value,rect:j.value,config:t.value})),void 0,!0)],14,Ma)),e.$slots.watermark?(p(),b("div",Ra,[_(e.$slots,"watermark",me(ye({isPrinting:g(Et)||g(Dt)})),void 0,!0)])):M("",!0),V("div",{id:"legend-bottom-".concat(S.value)},null,8,La),St.value?(p(),re(Gl,{key:6,to:t.value.style.chart.legend.position==="top"?"#legend-top-".concat(S.value):"#legend-bottom-".concat(S.value)},[V("div",{ref_key:"chartLegend",ref:It},[t.value.style.chart.legend.show?(p(),re(pa,{key:"legend_".concat(tt.value),legendSet:it.value,config:$l.value,id:"treemap_legend_".concat(S.value),onClickMarker:a[0]||(a[0]=({legend:l})=>jt(l))},{item:A(({legend:l,index:o})=>[g(ke)?M("",!0):(p(),b("div",{key:0,onClick:n=>jt(l),style:se("opacity:".concat(U.value.includes(l.id)?.5:1))},qe(l.display),13,Ba))]),_:1},8,["legendSet","config","id"])):_(e.$slots,"legend",{key:1,legend:it.value},void 0,!0)],512)],8,["to"])):M("",!0),e.$slots.source?(p(),b("div",{key:7,ref_key:"source",ref:At,dir:"auto"},[_(e.$slots,"source",{},void 0,!0)],512)):M("",!0),Ge(g(h),{show:D.value.showTooltip&&R.value,backgroundColor:t.value.style.chart.tooltip.backgroundColor,color:t.value.style.chart.tooltip.color,fontSize:t.value.style.chart.tooltip.fontSize,borderRadius:t.value.style.chart.tooltip.borderRadius,borderColor:t.value.style.chart.tooltip.borderColor,borderWidth:t.value.style.chart.tooltip.borderWidth,backgroundOpacity:t.value.style.chart.tooltip.backgroundOpacity,position:t.value.style.chart.tooltip.position,offsetY:t.value.style.chart.tooltip.offsetY,parent:W.value,content:Ze.value,isFullscreen:ie.value,isCustom:g(sl)(t.value.style.chart.tooltip.customFormat),smooth:t.value.style.chart.tooltip.smooth,backdropFilter:t.value.style.chart.tooltip.backdropFilter,smoothForce:t.value.style.chart.tooltip.smoothForce,smoothSnapThreshold:t.value.style.chart.tooltip.smoothSnapThreshold},{"tooltip-before":A(()=>[_(e.$slots,"tooltip-before",me(ye({...ct.value})),void 0,!0)]),"tooltip-after":A(()=>[_(e.$slots,"tooltip-after",me(ye({...ct.value})),void 0,!0)]),_:3},8,["show","backgroundColor","color","fontSize","borderRadius","borderColor","borderWidth","backgroundOpacity","position","offsetY","parent","content","isFullscreen","isCustom","smooth","backdropFilter","smoothForce","smoothSnapThreshold"]),E.value&&t.value.userOptions.buttons.table?(p(),re(Kl(Pe.value.component),xt({key:8},Pe.value.props,{ref_key:"tableUnit",ref:Fe,onClose:Qt}),ll({content:A(()=>[(p(),re(g(i),{key:"table_".concat(et.value),colNames:Re.value.colNames,head:Re.value.head,body:Re.value.body,config:Re.value.config,title:t.value.table.useDialog?"":Pe.value.title,withCloseButton:!t.value.table.useDialog,onClose:Qt},{th:A(({th:l})=>[V("div",{innerHTML:l,style:{display:"flex","align-items":"center"}},null,8,Ha)]),td:A(({td:l})=>[Ye(qe(l.name||l),1)]),_:1},8,["colNames","head","body","config","title","withCloseButton"]))]),_:2},[t.value.table.useDialog?{name:"title",fn:A(()=>[Ye(qe(Pe.value.title),1)]),key:"0"}:void 0,t.value.table.useDialog?{name:"actions",fn:A(()=>[V("button",{tabindex:"0",class:"vue-ui-user-options-button",onClick:a[1]||(a[1]=l=>vt(t.value.userOptions.callbacks.csv))},[Ge(nl,{name:"excel",stroke:Pe.value.props.color},null,8,["stroke"])])]),key:"1"}:void 0]),1040)):M("",!0),g(ke)?(p(),re(ra,{key:9})):M("",!0)],46,Ca))}},uo=ql(Ua,[["__scopeId","data-v-9e0d065c"]]);export{uo as default};
