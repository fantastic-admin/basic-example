
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Tooltip-68Yi_FFl-CRPaJsgv.js","./vue-data-ui-BN9YfUec.js","./index-DXZKKOp8.js","./index-B7kifsnL.css","./alert-l5XlVwCh.js","./vue-data-ui-D1HaM8UR.css","./DataTable-BT7VF2ua-Cw2NNXsE.js","./Shape-CNXKB8O0-BJGuTKHC.js","./vue-ui-accordion-UpZ765hd-DndPzmcD.js","./useNestedProp-dJX_8vvZ-BzBW50KN.js","./UserOptions-1OZ3jcm6-BbpzMig3.js","./vClickOutside-C6WiFswA-B2BXHGcD.js","./img-BecE5qXd-CsL1o-EN.js","./dom-to-png--BNgrTZV-DTUrW_sQ.js","./PenAndPaper-DSvu9dwa-B6YjX2xm.js","./ColorPicker-J5wOPCeB-sgb_Bfch.js","./PackageVersion-TgflyMpU-q2MkeeNq.js","./BaseDraggableDialog-ymf2sfB8-Deu3K0kd.js"])))=>i.map(i=>d[i]);
import{ab as El,J as c,e as i,a7 as Dl,K as J,au as Ze,E as Ml,av as Rl,b_ as L,c as v,o as r,z as V,A as m,f as x,g as ae,u as h,c0 as xe,h as g,r as f,j as W,k as j,O as oe,n as el,F as _,R as B,m as ke,t as ue,bn as Gl,l as ll,N as Ul,c1 as z,a9 as Wl}from"./index-DXZKKOp8.js";import{s as jl,Q as ql,A as Hl,v as Yl,m as M,g as tl,p as $e,b as Xl,C as Kl,I as Q,f as P,y as Jl,O as Ql,G as Zl,K as et,a as lt,e as tt,r as at,a4 as ot,F as ut,h as st}from"./vue-data-ui-BN9YfUec.js";import{E as rt,M as nt}from"./useResponsive-DfdjqQps-DzVAt69W.js";import{t as it,o as al}from"./useNestedProp-dJX_8vvZ-BzBW50KN.js";import{S as vt,T as ct}from"./BaseScanner-BgWxam9d-B19ueoDW.js";import{m as dt}from"./usePrinter-DTzqpYKF-D5mkxXp9.js";import{O as ht}from"./useSvgExport-DrjCWun4-CbW14PXm.js";import{a as pt}from"./useUserOptionState-BIvW1Kz7-D6llU1BK.js";import{o as yt}from"./useChartAccessibility-9icAAmYg-BcUQIUvr.js";import gt from"./img-BecE5qXd-CsL1o-EN.js";import{w as ft}from"./Shape-CNXKB8O0-BJGuTKHC.js";import bt from"./Title-BWp-37K_-BMUMQpSO.js";import{J as mt}from"./themes-AUNCOb2G-RAhReTPj.js";import wt from"./Legend-G6GMcdAc-7HaGLNN7.js";import"./alert-l5XlVwCh.js";import"./dom-to-png--BNgrTZV-DTUrW_sQ.js";const xt=["id"],kt=["id"],$t=["xmlns","viewBox"],_t=["id"],Ct=["stop-color"],It=["stop-color"],Tt=["id"],At=["x","y","height","width"],Ot=["height","width"],Ft={key:0},Pt=["rx","x","y","height","width","stroke","stroke-width","filter"],St=["rx","x","y","height","width","fill","stroke","stroke-width","filter"],Lt={key:1},Vt=["rx","x","y","height","width","fill","filter"],Bt=["textContent","x","y","font-size","fill","filter"],zt=["x","y","height","width","onMouseover","onMouseleave","onClick"],Nt={key:4,class:"vue-data-ui-watermark"},Et=["id"],Dt=["onClick"],Mt=["innerHTML"],Rt={__name:"vue-ui-waffle",props:{config:{type:Object,default(){return{}}},dataset:{type:Array,default(){return[]}}},emits:["selectLegend"],setup(ol,{expose:ul,emit:sl}){const rl=L(()=>z(()=>import("./Tooltip-68Yi_FFl-CRPaJsgv.js"),__vite__mapDeps([0,1,2,3,4,5]),import.meta.url)),nl=L(()=>z(()=>import("./vue-data-ui-BN9YfUec.js").then(l=>l.aw),__vite__mapDeps([1,2,3,4,5]),import.meta.url)),il=L(()=>z(()=>import("./DataTable-BT7VF2ua-Cw2NNXsE.js"),__vite__mapDeps([6,2,3,7,1,4,5]),import.meta.url)),vl=L(()=>z(()=>import("./vue-ui-accordion-UpZ765hd-DndPzmcD.js"),__vite__mapDeps([8,2,3,1,4,5,9]),import.meta.url)),cl=L(()=>z(()=>import("./UserOptions-1OZ3jcm6-BbpzMig3.js"),__vite__mapDeps([10,2,3,11,1,4,5,12,13]),import.meta.url)),dl=L(()=>z(()=>import("./PenAndPaper-DSvu9dwa-B6YjX2xm.js"),__vite__mapDeps([14,2,3,1,4,5,15,11]),import.meta.url)),hl=L(()=>z(()=>import("./PackageVersion-TgflyMpU-q2MkeeNq.js"),__vite__mapDeps([16,2,3]),import.meta.url)),pl=L(()=>z(()=>import("./BaseDraggableDialog-ymf2sfB8-Deu3K0kd.js"),__vite__mapDeps([17,2,3,1,4,5]),import.meta.url)),{vue_ui_waffle:yl}=it(),w=ol,gl=El(),se=c(()=>!!w.dataset&&w.dataset.length),b=i(ql()),re=i(!1),ne=i(""),R=i(null),_e=i(0),C=i(null),Ce=i(null),Ie=i(null),Te=i(null),Ae=i(null),Oe=i(0),Fe=i(0),Pe=i(0),Se=i(!1),q=i(null),ie=i(null),e=i(he()),{loading:Le,FINAL_DATASET:Z,manualLoading:ve}=vt({...Dl(w),FINAL_CONFIG:e,prepareConfig:he,callback:()=>{Promise.resolve().then(async()=>{p.value=pe()})},skeletonDataset:[{name:"",values:[1],color:"#AAAAAA"},{name:"",values:[1],color:"#BABABA"},{name:"",values:[1],color:"#CACACA"}],skeletonConfig:Hl({defaultConfig:e.value,userConfig:{useCustomCells:!1,userOptions:{show:!1},table:{show:!1},style:{chart:{backgroundColor:"#99999930",layout:{labels:{captions:{show:!1}},rect:{stroke:"#999999"}},legend:{backgroundColor:"transparent",showValue:!1,showPercentage:!1}}}}})}),{userOptionsVisible:ce,setUserOptionsVisibility:Ve,keepUserOptionState:Be}=pt({config:e.value}),{svgRef:de}=yt({config:e.value.style.chart.title});function he(){const l=al({userConfig:w.config,defaultConfig:yl});return l.theme?{...al({userConfig:mt.vue_ui_waffle[l.theme]||w.config,defaultConfig:l}),customPalette:Yl[l.theme]||M}:l}J(()=>w.config,l=>{Le.value||(e.value=he()),ce.value=!e.value.userOptions.showOnChartHover,Ne(),Oe.value+=1,Fe.value+=1,Pe.value+=1,k.value.showTable=e.value.table.show,k.value.showTooltip=e.value.style.chart.tooltip.show},{deep:!0});const S=Ze(null),G=Ze(null),ze=c(()=>!!e.value.debug);function Ne(){if(tl(w.dataset)?($e({componentName:"VueUiWaffle",type:"dataset",debug:ze.value}),se.value=!1,ve.value=!0):w.dataset.forEach((l,t)=>{Xl({datasetObject:l,requiredAttributes:["name","values"]}).forEach(a=>{$e({componentName:"VueUiWaffle",type:"datasetSerieAttribute",property:a,index:t,debug:ze.value})})}),tl(w.dataset)||(ve.value=e.value.loading),e.value.responsive){const l=rt(()=>{const{width:t,height:a}=nt({chart:C.value,title:e.value.style.chart.title.text?Ce.value:null,legend:e.value.style.chart.legend.show?Ie.value:null,source:Te.value,noTitle:Ae.value});requestAnimationFrame(()=>{N.value.width=t,N.value.height=a,I.value.width=t,I.value.height=a})});S.value&&(G.value&&S.value.unobserve(G.value),S.value.disconnect()),S.value=new ResizeObserver(l),G.value=C.value.parentNode,S.value.observe(G.value)}}Ml(()=>{Se.value=!0,Ne()}),Rl(()=>{S.value&&(G.value&&S.value.unobserve(G.value),S.value.disconnect())});const{isPrinting:Ee,isImaging:De,generatePdf:Me,generateImage:Re}=dt({elementId:"vue-ui-waffle_".concat(b.value),fileName:e.value.style.chart.title.text||"vue-ui-waffle",options:e.value.userOptions.print}),fl=c(()=>e.value.userOptions.show&&!e.value.style.chart.title.text),Ge=c(()=>Kl(e.value.customPalette)),k=i({showTable:e.value.table.show,showTooltip:e.value.style.chart.tooltip.show});J(e,()=>{k.value={showTable:e.value.table.show,showTooltip:e.value.style.chart.tooltip.show}},{immediate:!0});const N=i({height:512,width:512}),I=i({top:0,left:0,height:512,width:512}),T=c(()=>(I.value.width-e.value.style.chart.layout.grid.size*e.value.style.chart.layout.grid.spaceBetween)/e.value.style.chart.layout.grid.size),A=c(()=>(I.value.height-e.value.style.chart.layout.grid.size*e.value.style.chart.layout.grid.spaceBetween)/e.value.style.chart.layout.grid.size),bl=c(()=>Math.max(1e-4,I.value.width/e.value.style.chart.layout.grid.size)),Ue=c(()=>Math.max(1e-4,I.value.height/e.value.style.chart.layout.grid.size));function We(l){const t=e.value.style.chart.layout.grid.size*e.value.style.chart.layout.grid.size,a=l.reduce(($,we)=>$+we,0),o=l.map($=>$/a*t),u=o.map(Math.floor),s=o.map($=>$%1);let d=t-u.reduce(($,we)=>$+we,0);for(;d>0;){let $=s.indexOf(Math.max(...s));u[$]+=1,s[$]=0,d-=1}return u}const H=i(!1);function pe(){return H.value=Z.value.flatMap(l=>l.values.reduce((t,a)=>t+a,0)).reduce((l,t)=>l+t,0)===0,Z.value.map((l,t)=>({...l,color:lt(l.color)||Ge.value[t]||M[t]||M[t%M.length],uid:"serie_".concat(t),absoluteIndex:t}))}const ye=c(()=>pe()),p=i(ye.value);J(()=>w.dataset,l=>{Array.isArray(l)&&l.length>0&&(ve.value=!1)},{immediate:!0}),J(()=>w.dataset,l=>{p.value=pe()},{deep:!0});const ml=c(()=>{const l=p.value.filter((t,a)=>!y.value.includes(t.uid)).map((t,a)=>H.value?1:(t.values||[]).reduce((o,u)=>o+u,0));return We(l)}),wl=c(()=>{const l=p.value.map((t,a)=>H.value?1:(t.values||[]).reduce((o,u)=>o+u));return We(l)}),Y=c(()=>(Z.value.forEach((l,t)=>{[null,void 0].includes(l.values)&&$e({componentName:"VueUiWaffle",type:"datasetSerieAttribute",property:"values (number[])",index:t})}),p.value.filter((l,t)=>!y.value.includes(l.uid)).map((l,t)=>({absoluteIndex:l.absoluteIndex,uid:l.uid,name:l.name,color:l.color,value:(l.values||[]).reduce((a,o)=>a+o,0),absoluteValues:l.values||[],proportion:ml.value[t]})))),xl=c(()=>p.value.map((l,t)=>({absoluteIndex:l.absoluteIndex,uid:l.uid,name:l.name,color:l.color,value:(l.values||[]).reduce((a,o)=>a+o,0),absoluteValues:l.values||[],proportion:wl.value[t]})));function kl(){return xl.value.map(l=>({name:l.name,color:l.color,value:l.value,proportion:l.proportion}))}const $l=c(()=>{let l=0;return Y.value.map((t,a)=>{const o=l,u=o+t.proportion,s=[];for(let d=Math.floor(o);d<Math.floor(u);d+=1)s.push(d);return l=u,{...t,start:o,rects:s}})}),n=c(()=>$l.value.flatMap((l,t)=>l.rects.map((a,o)=>({isFirst:o===0,isLongEnough:a.length>2,name:l.name,color:l.color,value:l.value,serieIndex:t,absoluteStartIndex:o<3,serieId:l.uid,...l}))).map((l,t)=>({...l,isAbsoluteFirst:t%e.value.style.chart.layout.grid.size===0}))),U=c(()=>{const l=[];for(let t=0;t<e.value.style.chart.layout.grid.size;t+=1)for(let a=0;a<e.value.style.chart.layout.grid.size;a+=1)l.push({isStartOfLine:a===0,position:e.value.style.chart.layout.grid.vertical?t:a,x:(e.value.style.chart.layout.grid.vertical?t:a)*(T.value+e.value.style.chart.layout.grid.spaceBetween),y:(e.value.style.chart.layout.grid.vertical?a:t)*(A.value+e.value.style.chart.layout.grid.spaceBetween)+I.value.top});return l}),y=i([]),X=i(!1),je=i(null),qe=i(null);function He(l){if(H.value)return;if(!e.value.useAnimation){y.value.includes(l)?y.value=y.value.filter(u=>u!==l):y.value.length<E.value.length-1&&E.value.length>1&&y.value.push(l);return}const t=ye.value.find(u=>u.uid===l).values.reduce((u,s)=>u+s,0),a=p.value.find(u=>u.uid===l).values.reduce((u,s)=>u+s,0);let o=a;if(!(a===0&&t===0)){if(y.value.includes(l)){let u=function(){o>s?(cancelAnimationFrame(je.value),p.value=p.value.map((d,$)=>d.uid===l?{...d,values:[s]}:d),X.value=!1):(X.value=!0,o+=s*.025,p.value=p.value.map((d,$)=>d.uid===l?{...d,values:[o]}:d),je.value=requestAnimationFrame(u))};y.value=y.value.filter(d=>d!==l);const s=t;u()}else if(y.value.length<E.value.length-1&&E.value.length>1){let u=function(){o<a/100?(cancelAnimationFrame(qe.value),y.value.push(l),p.value=p.value.map((s,d)=>s.uid===l?{...s,values:[0]}:s),X.value=!1):(X.value=!0,o/=1.15,p.value=p.value.map(s=>s.uid===l?{...s,values:[o]}:s),qe.value=requestAnimationFrame(u))};u()}Al("selectLegend",Y.value.map(u=>({name:u.name,color:u.color,value:u.value,proportion:u.proportion/Math.pow(e.value.style.chart.layout.grid.size,2)})))}}const E=c(()=>p.value.map((l,t)=>{const a=(l.values||[]).reduce((u,s)=>u+s,0),o=a/p.value.map(u=>(u.values||[]).reduce((s,d)=>s+d,0)).reduce((u,s)=>u+s,0);return{name:l.name,color:l.color||Ge[t]||M[t]||M[t%M.length],value:a,proportion:o,uid:l.uid,shape:"square"}}).map((l,t)=>({...l,opacity:y.value.includes(l.uid)?.5:1,segregate:()=>He(l.uid),isSegregated:y.value.includes(l.uid),display:"".concat(l.name).concat(e.value.style.chart.legend.showPercentage||e.value.style.chart.legend.showValue?": ":"").concat(e.value.style.chart.legend.showValue?Q(e.value.style.chart.layout.labels.dataLabels.formatter,l.value,P({p:e.value.style.chart.layout.labels.dataLabels.prefix,v:l.value,s:e.value.style.chart.layout.labels.dataLabels.suffix,r:e.value.style.chart.legend.roundingValue}),{datapoint:l,index:t}):"").concat(e.value.style.chart.legend.showPercentage?y.value.includes(l.uid)?"".concat(e.value.style.chart.legend.showValue?" (":"","- %").concat(e.value.style.chart.legend.showValue?")":""):"".concat(e.value.style.chart.legend.showValue?" (":"").concat(isNaN(l.value/O.value)?"-":P({v:l.value/O.value*100,s:"%",r:e.value.style.chart.legend.roundingPercentage})).concat(e.value.style.chart.legend.showValue?")":""):"")}))),_l=c(()=>({cy:"waffle-div-legend",backgroundColor:e.value.style.chart.legend.backgroundColor,color:e.value.style.chart.legend.color,fontSize:e.value.style.chart.legend.fontSize,paddingBottom:12,fontWeight:e.value.style.chart.legend.bold?"bold":""})),O=c(()=>Y.value.map(l=>l.value).reduce((l,t)=>l+t,0)),ge=i(null),fe=i(null);function Cl(l){const t=n.value[l];e.value.events.datapointClick&&e.value.events.datapointClick({datapoint:t,seriesIndex:t.serieIndex})}function Il(l){const t=n.value[l];e.value.events.datapointLeave&&e.value.events.datapointLeave({datapoint:t,seriesIndex:t.serieIndex}),fe.value=null,re.value=!1,R.value=null}function Tl(l){if(y.value.length===w.dataset.length)return;const t=n.value[l];ge.value={datapoint:t,seriesIndex:t.absoluteIndex,series:p.value,config:e.value},e.value.events.datapointEnter&&fe.value!==t.serieIndex&&e.value.events.datapointEnter({datapoint:t,seriesIndex:t.serieIndex}),fe.value=t.serieIndex,re.value=!0,R.value=n.value[l].serieIndex;const a=e.value.style.chart.tooltip.customFormat;if(ut(a)&&st(()=>a({seriesIndex:n.value[l].absoluteIndex,datapoint:t,series:p.value,config:e.value})))ne.value=a({seriesIndex:n.value[l].absoluteIndex,datapoint:t,series:p.value,config:e.value});else{let o="";if(o+='<div style="width:100%;text-align:center;border-bottom:1px solid '.concat(e.value.style.chart.tooltip.borderColor,';padding-bottom:6px;margin-bottom:3px;">').concat(t.name,"</div>"),o+='<div style="display:flex;flex-direction:row;gap:6px;align-items:center;"><svg viewBox="0 0 60 60" height="14" width="14"><rect x="0" y="0" height="60" width="60" stroke="none" rx="1" fill="'.concat(t.color,'" />').concat(gl.pattern?'<rect x="0" y="0" height="60" width="60" stroke="none" rx="1" stroke="none" fill="url(#pattern_'.concat(b.value,"_").concat(t.absoluteIndex,')"/>'):"","</svg>"),e.value.style.chart.tooltip.showValue&&(o+="<b>".concat(Q(e.value.style.chart.layout.labels.dataLabels.formatter,t.value,P({p:e.value.style.chart.layout.labels.dataLabels.prefix,v:t.value,s:e.value.style.chart.layout.labels.dataLabels.suffix,r:e.value.style.chart.tooltip.roundingValue}),{datapoint:t,seriesIndex:n.value[l].absoluteIndex,series:p.value}),"</b>")),e.value.style.chart.tooltip.showPercentage){const u=P({v:H.value?1/Z.value.length*100:t.value/O.value*100,s:"%",r:e.value.style.chart.tooltip.roundingPercentage});e.value.style.chart.tooltip.showValue?o+="<span>(".concat(u,")</span></div>"):o+="<b>".concat(u,"%</b></div>")}ne.value=o}}const Al=sl,F=c(()=>{const l=Y.value.map(a=>({name:a.name,color:a.color})),t=Y.value.map(a=>a.value);return{head:l,body:t}});function ee(l){return e.value.useBlurOnHover&&![null,void 0].includes(R.value)&&R.value!==l?"url(#blur_".concat(b.value,")"):""}function Ol(l,t){return e.value.style.chart.layout.labels.captions.show?n.value.length&&!X.value&&!e.value.style.chart.layout.grid.vertical&&(n.value[l].isFirst&&t.position<e.value.style.chart.layout.grid.size-2||n.value[l].isAbsoluteFirst&&l%e.value.style.chart.layout.grid.size===0&&n.value[l].absoluteStartIndex):!1}function Fl(l,t=null){const a=Q(e.value.style.chart.layout.labels.dataLabels.formatter,n.value[l].value,P({p:e.value.style.chart.layout.labels.dataLabels.prefix,v:n.value[l].value,s:e.value.style.chart.layout.labels.dataLabels.suffix,r:e.value.style.chart.layout.labels.captions.roundingValue}),{datapoint:n.value[l],position:t}),o=P({v:n.value[l].proportion,s:"%",r:e.value.style.chart.layout.labels.captions.roundingPercentage}),u=(e.value.style.chart.layout.labels.captions.serieNameAbbreviation?ot({source:n.value[l].name,length:e.value.style.chart.layout.labels.captions.serieNameMaxAbbreviationSize}):n.value[l].name)+(e.value.style.chart.layout.labels.captions.showPercentage||e.value.style.chart.layout.labels.captions.showValue?":":""),s=e.value.style.chart.layout.labels.captions.showSerieName?u:"";let d="";return e.value.style.chart.layout.labels.captions.showPercentage&&e.value.style.chart.layout.labels.captions.showValue?d="".concat(o," (").concat(a,")"):e.value.style.chart.layout.labels.captions.showPercentage&&!e.value.style.chart.layout.labels.captions.showValue?d=o:!e.value.style.chart.layout.labels.captions.showPercentage&&e.value.style.chart.layout.labels.captions.showValue&&(d=a),"".concat(s).concat(d)}function be(l=null){Wl(()=>{const t=F.value.head.map((u,s)=>[[u.name],[F.value.body[s]],[isNaN(F.value.body[s]/O.value)?"-":F.value.body[s]/O.value*100]]),a=[[e.value.style.chart.title.text],[e.value.style.chart.title.subtitle.text],[[""],["val"],["%"]]].concat(t),o=tt(a);l?l(o):at({csvContent:o,title:e.value.style.chart.title.text||"vue-ui-waffle"})})}const le=c(()=>{const l=[' <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 16v2a1 1 0 0 1 -1 1h-11l6 -7l-6 -7h11a1 1 0 0 1 1 1v2" /></svg>',Q(e.value.style.chart.layout.labels.dataLabels.formatter,O.value,P({p:e.value.style.chart.layout.labels.dataLabels.prefix,v:O.value,s:e.value.style.chart.layout.labels.dataLabels.suffix,r:e.value.table.td.roundingValue})),"100%"],t=F.value.head.map((u,s)=>[{color:u.color,name:u.name},Q(e.value.style.chart.layout.labels.dataLabels.formatter,F.value.body[s],P({p:e.value.style.chart.layout.labels.dataLabels.prefix,v:F.value.body[s],s:e.value.style.chart.layout.labels.dataLabels.suffix,r:e.value.table.td.roundingValue})),isNaN(F.value.body[s]/O.value)?"-":P({v:F.value.body[s]/O.value*100,s:"%",r:e.value.table.td.roundingPercentage})]),a={th:{backgroundColor:e.value.table.th.backgroundColor,color:e.value.table.th.color,outline:e.value.table.th.outline},td:{backgroundColor:e.value.table.td.backgroundColor,color:e.value.table.td.color,outline:e.value.table.td.outline},shape:"square",breakpoint:e.value.table.responsiveBreakpoint},o=[e.value.table.columnNames.series,e.value.table.columnNames.value,e.value.table.columnNames.percentage];return{head:l,body:t,config:a,colNames:o}}),D=i(!1);function Ye(l){D.value=l,_e.value+=1}function Xe(){k.value.showTable=!k.value.showTable}function Ke(){k.value.showTooltip=!k.value.showTooltip}const te=i(!1);function me(){te.value=!te.value}async function Pl({scale:l=2}={}){if(!C.value)return;const{width:t,height:a}=C.value.getBoundingClientRect(),o=t/a,{imageUri:u,base64:s}=await gt({domElement:C.value,base64:!0,img:!0,scale:l});return{imageUri:u,base64:s,title:e.value.style.chart.title.text,width:t,height:a,aspectRatio:o}}const K=c(()=>{const l=e.value.table.useDialog&&!e.value.table.show,t=k.value.showTable;return{component:l?pl:vl,title:"".concat(e.value.style.chart.title.text).concat(e.value.style.chart.title.subtitle.text?": ".concat(e.value.style.chart.title.subtitle.text):""),props:l?{backgroundColor:e.value.table.th.backgroundColor,color:e.value.table.th.color,headerColor:e.value.table.th.color,headerBg:e.value.table.th.backgroundColor,isFullscreen:D.value,fullscreenParent:C.value,forcedWidth:Math.min(500,window.innerWidth*.8)}:{hideDetails:!0,config:{open:t,maxHeight:1e4,body:{backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color},head:{backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color}}}}});J(()=>k.value.showTable,l=>{e.value.table.show||(l&&e.value.table.useDialog&&q.value?q.value.open():"close"in q.value&&q.value.close())});function Je(){k.value.showTable=!1,ie.value&&ie.value.setTableIconState(!1)}const Sl=c(()=>E.value.map(l=>({...l,name:l.display}))),Ll=c(()=>e.value.style.chart.backgroundColor),Vl=c(()=>e.value.style.chart.legend),Bl=c(()=>e.value.style.chart.title),{exportSvg:zl,getSvg:Nl}=ht({svg:de,title:Bl,legend:Vl,legendItems:Sl,backgroundColor:Ll});async function Qe({isCb:l}){if(l){const{blob:t,url:a,text:o,dataUrl:u}=await Nl();e.value.userOptions.callbacks.svg({blob:t,url:a,text:o,dataUrl:u})}else zl()}return ul({getData:kl,getImage:Pl,generatePdf:Me,generateCsv:be,generateImage:Re,generateSvg:Qe,toggleTable:Xe,toggleTooltip:Ke,toggleAnnotator:me,toggleFullscreen:Ye}),(l,t)=>(r(),v("div",{class:el("vue-data-ui-component vue-ui-waffle ".concat(D.value?"vue-data-ui-wrapper-fullscreen":"")),ref_key:"waffleChart",ref:C,id:"vue-ui-waffle_".concat(b.value),style:oe("font-family:".concat(e.value.style.fontFamily,";width:100%; text-align:center;background:").concat(e.value.style.chart.backgroundColor,";").concat(e.value.responsive?"height: 100%":"")),onMouseenter:t[2]||(t[2]=()=>h(Ve)(!0)),onMouseleave:t[3]||(t[3]=()=>h(Ve)(!1))},[e.value.userOptions.buttons.annotator?(r(),V(h(dl),{key:0,svgRef:h(de),backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,active:te.value,onClose:me},null,8,["svgRef","backgroundColor","color","active"])):m("",!0),fl.value?(r(),v("div",{key:1,ref_key:"noTitle",ref:Ae,class:"vue-data-ui-no-title-space",style:"height:36px; width: 100%;background:transparent"},null,512)):m("",!0),e.value.style.chart.title.text?(r(),v("div",{key:2,ref_key:"chartTitle",ref:Ce,style:"width:100%;background:transparent;padding-bottom:12px"},[(r(),V(bt,{key:"title_".concat(Oe.value),config:{title:{cy:"waffle-title",...e.value.style.chart.title},subtitle:{cy:"waffle-subtitle",...e.value.style.chart.title.subtitle}}},null,8,["config"]))],512)):m("",!0),x("div",{id:"legend-top-".concat(b.value)},null,8,kt),e.value.userOptions.show&&se.value&&(h(Be)||h(ce))?(r(),V(h(cl),{ref_key:"userOptionsRef",ref:ie,key:"user_options_".concat(_e.value),backgroundColor:e.value.style.chart.backgroundColor,color:e.value.style.chart.color,isPrinting:h(Ee),isImaging:h(De),uid:b.value,hasTooltip:e.value.userOptions.buttons.tooltip&&e.value.style.chart.tooltip.show,hasPdf:e.value.userOptions.buttons.pdf,hasImg:e.value.userOptions.buttons.img,hasSvg:e.value.userOptions.buttons.svg,hasXls:e.value.userOptions.buttons.csv,hasTable:e.value.userOptions.buttons.table,hasFullscreen:e.value.userOptions.buttons.fullscreen,isFullscreen:D.value,isTooltip:k.value.showTooltip,titles:{...e.value.userOptions.buttonTitles},chartElement:C.value,position:e.value.userOptions.position,hasAnnotator:e.value.userOptions.buttons.annotator,isAnnotation:te.value,callbacks:e.value.userOptions.callbacks,printScale:e.value.userOptions.print.scale,tableDialog:e.value.table.useDialog,onToggleFullscreen:Ye,onGeneratePdf:h(Me),onGenerateCsv:be,onGenerateImage:h(Re),onGenerateSvg:Qe,onToggleTable:Xe,onToggleTooltip:Ke,onToggleAnnotator:me,style:oe({visibility:h(Be)?h(ce)?"visible":"hidden":"visible"})},xe({_:2},[l.$slots.menuIcon?{name:"menuIcon",fn:g(({isOpen:a,color:o})=>[f(l.$slots,"menuIcon",W(j({isOpen:a,color:o})),void 0,!0)]),key:"0"}:void 0,l.$slots.optionTooltip?{name:"optionTooltip",fn:g(()=>[f(l.$slots,"optionTooltip",{},void 0,!0)]),key:"1"}:void 0,l.$slots.optionPdf?{name:"optionPdf",fn:g(()=>[f(l.$slots,"optionPdf",{},void 0,!0)]),key:"2"}:void 0,l.$slots.optionCsv?{name:"optionCsv",fn:g(()=>[f(l.$slots,"optionCsv",{},void 0,!0)]),key:"3"}:void 0,l.$slots.optionImg?{name:"optionImg",fn:g(()=>[f(l.$slots,"optionImg",{},void 0,!0)]),key:"4"}:void 0,l.$slots.optionTable?{name:"optionTable",fn:g(()=>[f(l.$slots,"optionTable",{},void 0,!0)]),key:"5"}:void 0,l.$slots.optionFullscreen?{name:"optionFullscreen",fn:g(({toggleFullscreen:a,isFullscreen:o})=>[f(l.$slots,"optionFullscreen",W(j({toggleFullscreen:a,isFullscreen:o})),void 0,!0)]),key:"6"}:void 0,l.$slots.optionAnnotator?{name:"optionAnnotator",fn:g(({toggleAnnotator:a,isAnnotator:o})=>[f(l.$slots,"optionAnnotator",W(j({toggleAnnotator:a,isAnnotator:o})),void 0,!0)]),key:"7"}:void 0]),1032,["backgroundColor","color","isPrinting","isImaging","uid","hasTooltip","hasPdf","hasImg","hasSvg","hasXls","hasTable","hasFullscreen","isFullscreen","isTooltip","titles","chartElement","position","hasAnnotator","isAnnotation","callbacks","printScale","tableDialog","onGeneratePdf","onGenerateImage","style"])):m("",!0),(r(),v("svg",{ref_key:"svgRef",ref:de,xmlns:h(Jl),class:el({"vue-data-ui-fullscreen--on":D.value,"vue-data-ui-fulscreen--off":!D.value}),viewBox:"0 0 ".concat(N.value.width<=0?10:N.value.width," ").concat(N.value.height<=0?10:N.value.height),style:oe("max-width:100%;overflow:visible;background:transparent;color:".concat(e.value.style.chart.color))},[ae(h(hl)),x("defs",null,[(r(!0),v(_,null,B(n.value,(a,o)=>(r(),v("radialGradient",{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%",id:"gradient_".concat(b.value,"_").concat(o)},[x("stop",{offset:"0%","stop-color":h(Ql)(h(Zl)(a.color,.05),100-e.value.style.chart.layout.rect.gradientIntensity)},null,8,Ct),x("stop",{offset:"100%","stop-color":a.color},null,8,It)],8,_t))),256))]),x("defs",null,[x("filter",{id:"blur_".concat(b.value),x:"-50%",y:"-50%",width:"200%",height:"200%"},[...t[4]||(t[4]=[x("feGaussianBlur",{in:"SourceGraphic",stdDeviation:2},null,-1),x("feColorMatrix",{type:"saturate",values:"0"},null,-1)])],8,Tt)]),e.value.useCustomCells&&n.value.length?(r(!0),v(_,{key:0},B(U.value,(a,o)=>(r(),v("foreignObject",{x:a.x,y:a.y,height:A.value<=0?1e-4:A.value,width:T.value<=0?1e-4:T.value,class:"vue-ui-waffle-custom-cell-foreignObject"},[f(l.$slots,"cell",ke({ref_for:!0},{cell:{...a,color:n.value[o].color,...n.value[o]},isSelected:[null,void 0].includes(R.value)?!0:n.value[o].serieIndex===R.value}),void 0,!0)],8,At))),256)):m("",!0),!n.value.length&&!e.value.useCustomCells?(r(),v("rect",{key:1,x:12,y:12,height:I.value.height-24,width:I.value.width-24,rx:3,fill:"none",stroke:"black"},null,8,Ot)):n.value.length&&!e.value.useCustomCells?(r(),v(_,{key:2},[l.$slots.pattern?(r(),v("g",Ft,[(r(!0),v(_,null,B(ye.value,a=>(r(),v("defs",null,[f(l.$slots,"pattern",ke({ref_for:!0},{seriesIndex:a.absoluteIndex,patternId:"pattern_".concat(b.value,"_").concat(a.absoluteIndex)}),void 0,!0)]))),256))])):m("",!0),(r(!0),v(_,null,B(U.value,(a,o)=>(r(),v("rect",{rx:e.value.style.chart.layout.rect.rounded?e.value.style.chart.layout.rect.rounding:0,x:a.x+e.value.style.chart.layout.grid.spaceBetween/2,y:a.y+e.value.style.chart.layout.grid.spaceBetween/2,height:A.value<=0?1e-4:A.value,width:T.value<=0?1e-4:T.value,fill:"white",stroke:e.value.style.chart.layout.rect.stroke,"stroke-width":e.value.style.chart.layout.rect.strokeWidth,filter:ee(n.value[o].serieIndex)},null,8,Pt))),256)),(r(!0),v(_,null,B(U.value,(a,o)=>(r(),v("rect",{rx:e.value.style.chart.layout.rect.rounded?e.value.style.chart.layout.rect.rounding:0,x:a.x+e.value.style.chart.layout.grid.spaceBetween/2,y:a.y+e.value.style.chart.layout.grid.spaceBetween/2,height:A.value<=0?1e-4:A.value,width:T.value<=0?1e-4:T.value,fill:e.value.style.chart.layout.rect.useGradient&&e.value.style.chart.layout.rect.gradientIntensity>0?"url(#gradient_".concat(b.value,"_").concat(o,")"):n.value[o].color,stroke:e.value.style.chart.layout.rect.stroke,"stroke-width":e.value.style.chart.layout.rect.strokeWidth,filter:ee(n.value[o].serieIndex)},null,8,St))),256)),l.$slots.pattern?(r(),v("g",Lt,[(r(!0),v(_,null,B(U.value,(a,o)=>(r(),v("rect",{rx:e.value.style.chart.layout.rect.rounded?e.value.style.chart.layout.rect.rounding:0,x:a.x+e.value.style.chart.layout.grid.spaceBetween/2,y:a.y+e.value.style.chart.layout.grid.spaceBetween/2,height:A.value<=0?1e-4:A.value,width:T.value<=0?1e-4:T.value,fill:"url(#pattern_".concat(b.value,"_").concat(n.value[o].absoluteIndex,")"),stroke:"none",filter:ee(n.value[o].serieIndex)},null,8,Vt))),256))])):m("",!0)],64)):m("",!0),(r(!0),v(_,null,B(U.value,(a,o)=>(r(),v(_,null,[Ol(o,a)?(r(),v("text",{key:"datalabel_".concat(o),textContent:ue(Fl(o,a)),x:a.x+e.value.style.chart.layout.labels.captions.offsetX+e.value.style.chart.layout.grid.spaceBetween/2+6,y:a.y+e.value.style.chart.layout.labels.captions.offsetY+e.value.style.chart.layout.grid.spaceBetween/2+Ue.value/2+e.value.style.chart.layout.labels.captions.fontSize/3,"font-size":e.value.style.chart.layout.labels.captions.fontSize,fill:h(et)(n.value[o].color),filter:ee(n.value[o].serieIndex)},null,8,Bt)):m("",!0)],64))),256)),(r(!0),v(_,null,B(U.value,(a,o)=>(r(),v("rect",{x:a.x+e.value.style.chart.layout.grid.spaceBetween/2,y:a.y+e.value.style.chart.layout.grid.spaceBetween/2,height:Ue.value,width:bl.value,fill:"transparent",stroke:"none",onMouseover:u=>Tl(o),onMouseleave:u=>Il(o),onClick:u=>Cl(o)},null,40,zt))),256)),f(l.$slots,"svg",{svg:N.value},void 0,!0)],14,$t)),l.$slots.watermark?(r(),v("div",Nt,[f(l.$slots,"watermark",W(j({isPrinting:h(Ee)||h(De)})),void 0,!0)])):m("",!0),x("div",{id:"legend-bottom-".concat(b.value)},null,8,Et),Se.value?(r(),V(Gl,{key:5,to:e.value.style.chart.legend.position==="top"?"#legend-top-".concat(b.value):"#legend-bottom-".concat(b.value)},[x("div",{ref_key:"chartLegend",ref:Ie},[e.value.style.chart.legend.show?(r(),V(wt,{key:"legend_".concat(Pe.value),legendSet:E.value,config:_l.value,onClickMarker:t[0]||(t[0]=({legend:a})=>He(a.uid))},xe({item:g(({legend:a})=>[x("div",{onClick:o=>a.segregate(),style:oe("opacity:".concat(y.value.includes(a.uid)?.5:1))},ue(a.display),13,Dt)]),_:2},[l.$slots.pattern?{name:"legend-pattern",fn:g(({legend:a,index:o})=>[ae(ft,{shape:a.shape,radius:30,stroke:"none",plot:{x:30,y:30},fill:"url(#pattern_".concat(b.value,"_").concat(o,")")},null,8,["shape","fill"])]),key:"0"}:void 0]),1032,["legendSet","config"])):f(l.$slots,"legend",{key:1,legend:E.value},void 0,!0)],512)],8,["to"])):m("",!0),l.$slots.source?(r(),v("div",{key:6,ref_key:"source",ref:Te,dir:"auto"},[f(l.$slots,"source",{},void 0,!0)],512)):m("",!0),ae(h(rl),{show:k.value.showTooltip&&re.value&&y.value.length<w.dataset.length,backgroundColor:e.value.style.chart.tooltip.backgroundColor,color:e.value.style.chart.tooltip.color,borderRadius:e.value.style.chart.tooltip.borderRadius,borderColor:e.value.style.chart.tooltip.borderColor,borderWidth:e.value.style.chart.tooltip.borderWidth,backgroundOpacity:e.value.style.chart.tooltip.backgroundOpacity,position:e.value.style.chart.tooltip.position,offsetY:e.value.style.chart.tooltip.offsetY,parent:C.value,content:ne.value,isCustom:e.value.style.chart.tooltip.customFormat&&typeof e.value.style.chart.tooltip.customFormat=="function",fontSize:e.value.style.chart.tooltip.fontSize,isFullscreen:D.value,smooth:e.value.style.chart.tooltip.smooth,backdropFilter:e.value.style.chart.tooltip.backdropFilter,smoothForce:e.value.style.chart.tooltip.smoothForce,smoothSnapThreshold:e.value.style.chart.tooltip.smoothSnapThreshold},{"tooltip-before":g(()=>[f(l.$slots,"tooltip-before",W(j({...ge.value})),void 0,!0)]),"tooltip-after":g(()=>[f(l.$slots,"tooltip-after",W(j({...ge.value})),void 0,!0)]),_:3},8,["show","backgroundColor","color","borderRadius","borderColor","borderWidth","backgroundOpacity","position","offsetY","parent","content","isCustom","fontSize","isFullscreen","smooth","backdropFilter","smoothForce","smoothSnapThreshold"]),se.value&&e.value.userOptions.buttons.table?(r(),V(Ul(K.value.component),ke({key:7},K.value.props,{ref_key:"tableUnit",ref:q,onClose:Je}),xe({content:g(()=>[(r(),V(h(il),{key:"table_".concat(Fe.value),colNames:le.value.colNames,head:le.value.head,body:le.value.body,config:le.value.config,title:e.value.table.useDialog?"":K.value.title,withCloseButton:!e.value.table.useDialog,onClose:Je},{th:g(({th:a})=>[x("div",{innerHTML:a,style:{display:"flex","align-items":"center"}},null,8,Mt)]),td:g(({td:a})=>[ll(ue(a.name||a),1)]),_:1},8,["colNames","head","body","config","title","withCloseButton"]))]),_:2},[e.value.table.useDialog?{name:"title",fn:g(()=>[ll(ue(K.value.title),1)]),key:"0"}:void 0,e.value.table.useDialog?{name:"actions",fn:g(()=>[x("button",{tabindex:"0",class:"vue-ui-user-options-button",onClick:t[1]||(t[1]=a=>be(e.value.userOptions.callbacks.csv))},[ae(h(nl),{name:"excel",stroke:K.value.props.color},null,8,["stroke"])])]),key:"1"}:void 0]),1040)):m("",!0),h(Le)?(r(),V(ct,{key:8})):m("",!0)],46,xt))}},oa=jl(Rt,[["__scopeId","data-v-78e01575"]]);export{oa as default};
